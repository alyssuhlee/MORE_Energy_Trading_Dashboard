# NECESSARY IMPORTS
from datetime import datetime, timedelta
from ftplib import FTP, error_perm, all_errors
from mysql.connector import Error
from openpyxl import load_workbook
# from selenium import webdriver
# from selenium.common.exceptions import TimeoutException
# from selenium.webdriver.common.by import By
# from selenium.webdriver.chrome.options import Options  # Import Options for headless mode
# from selenium.webdriver.support.ui import WebDriverWait
# from webdriver_manager.chrome import ChromeDriverManager
# from selenium.webdriver.chrome.service import Service
# from selenium.webdriver.support import expected_conditions as EC
# from webdriver_manager.core.os_manager import ChromeType
from sqlalchemy import create_engine
import calendar
import csv
import glob
import mysql.connector
import openpyxl
import os
import pandas as pd
import plotly.express as px
import plotly.io as pio
import plotly.graph_objs as go
import streamlit as st
import threading
import time
# Authenticator Imports
import pickle
from pathlib import Path
import streamlit_authenticator as stauth

# Refresh Interval Value (900 seconds/15 minutes)
REFRESH_INTERVAL = 900

# ------ from current_interval.py file ------
# MySQL connection details
# db_config = {
#     'user': 'cesra_dbm',
#     'password': 'ibIDN0NcnGYo71qDZuHw',
#     'host': 'cesra-db.cxkuksua06qz.ap-southeast-1.rds.amazonaws.com',
#     'database': 'myDb',
#     'port': 3309  # Default MySQL port
# }

# List of functions

# Function to save chart as JSON
def save_chart(chart, file_path):
    chart_json = pio.to_json(chart)

    with open(file_path, 'w') as f:
        f.write(chart_json)

# Function to load saved chart from JSON
def load_chart(file_path):
    with open(file_path, 'r') as f:
        return f.read()

# Function to determine the time interval
def get_time_interval(current_time):
    # Get the current hour
    hour = current_time.hour
    # Get the current minute
    minute = current_time.minute
    
    # If the time is exactly 12:00 AM
    if hour == 0 and minute == 0:
        return '2400 H'
    # If the time is between 12:01 AM and 12:59 AM
    elif hour == 0:
        return '0100 H'
    elif hour == 23 and minute > 0:
        return '2400 H'
    # If the time is exactly on the hour (e.g., 1:00 AM, 2:00 AM)
    elif minute == 0:
        return f'{hour:02}00 H'
    # For all other times, return the next hour followed by "00 H"
    else:
        return f'{(hour + 1) % 24:02}00 H'
    
# Function to insert the time interval into the database
def insert_time_interval(time_interval):
    try:
        # conn = mysql.connector.connect(**db_config)

        conn = mysql.connector.connect(
            host='cesra-db.cxkuksua06qz.ap-southeast-1.rds.amazonaws.com',
            port=3309,
            database='myDb',
            user='cesra_dbm',
            password='ibIDN0NcnGYo71qDZuHw'
        )
    
        # Create MySQL table if it doesn't exist
        cursor = conn.cursor()
        
        # Create table if not exists
        cursor.execute("""
        CREATE TABLE IF NOT EXISTS TimeIntervals (
            id INT AUTO_INCREMENT PRIMARY KEY,
            time_interval VARCHAR(10) NOT NULL,
            timestamp DATETIME DEFAULT CURRENT_TIMESTAMP
        )
        """)
        
        # Insert the time interval
        cursor.execute("INSERT INTO TimeIntervals (time_interval) VALUES (%s)", (time_interval,))
        
        # Commit the transaction
        conn.commit()
        
        print("Time interval inserted:", time_interval)
        
    except mysql.connector.Error as err:
        print("Error:", err)
    finally:
        cursor.close()
        conn.close()

def current_interval_file():
    # # Main loop to update the database every minute
    # while True:
    # Get the current time
    now = datetime.now()
    
    # Determine the time interval
    time_interval = get_time_interval(now)
    
    # Insert the time interval into the database
    insert_time_interval(time_interval)
    
    # # Wait for 800 seconds before checking again
    # time.sleep(800)

# ------ from forecasted_energy.py file ------
# Function to copy values from source range to destination range
def copy_values_fe(source_sheet, dest_sheet, source_range, dest_range):
    source_start, source_end = source_range
    dest_start, dest_end = dest_range
    
    # Copy values from source to destination
    source_values = []
    for row in source_sheet[source_start:source_end]:
        for cell in row:
            source_values.append(cell.value)
    
    dest_index = 0
    for row in dest_sheet[dest_start:dest_end]:
        for cell in row:
            if dest_index < len(source_values):
                cell.value = source_values[dest_index]
                dest_index += 1
            else:
                break

def forecasted_energy():
    # base_directory = r'01_Energy Sourcing Files\03_Daily Reports\01_Day Ahead Projections'
    base_directory = os.path.join('01_Energy Sourcing Files', '03_Daily Reports', '01_Day Ahead Projections')
    # base_directory = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\01_Energy Sourcing Files\03_Daily Reports\01_Day Ahead Projections"
    # base_directory = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\01_Energy Sourcing Files\03_Daily Reports\01_Day Ahead Projections"
    current_date = datetime.now()
    current_month_numeric = current_date.strftime("%m")
    current_month_name = current_date.strftime("%B")
    current_day = int(current_date.strftime("%d"))
    current_year = current_date.strftime("%Y")
    current_day_not_int = current_date.strftime("%d")

    check_current_month = current_date.strftime("%B")
    # If the current month is December, increment the year
    if check_current_month == "December" and current_day > 25:
        year_to_be_used = str(int(current_year) + 1)
    # Otherwise, use the current year
    else: 
        year_to_be_used = current_date.strftime("%Y")

    folder_path = os.path.join(base_directory, year_to_be_used)
    
    #List of all month names
    months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]
    #Find index of current month
    current_month_index = months.index(current_month_name)

    # if (current_day>'25') and (current_date.strftime("%m") == current_month_numeric):
    #     #Increment current month by converting to integer, adding 1, and formatting back to zero-padded string
    #     current_month_numeric_increment = '{:02d}'.format((int(current_month_numeric) % 12) + 1)
    #     # Calculate index of next month
    #     next_month_index = (current_month_index + 1) % 12
    #     current_month_name = months[next_month_index]
    # elif(current_day<='25') and (current_date.strftime("%m")==current_month_numeric):
    #     current_month_numeric_increment = current_month_numeric

    # Check if the day is past the 25th of the current month
    if current_day > 25 :
        # If it's past the 25th, increment the month
        next_month_index = (current_month_index + 1) % 12 # This handles the rollover from December to January
        current_month_name = months[next_month_index]
        # Set the numeric month increment (for the next month), ensuring 3-digit format 
        current_month_numeric_increment = f'{(int(current_month_numeric) % 12) + 1:03d}'
    else:
        # If it's before or on the 25th, don't change the month
        current_month_numeric_increment = f'{int(current_month_numeric):03d}'

    # Construct the folder name
    folder_name = f"{current_month_numeric_increment}. {current_month_name} {year_to_be_used}"

    # Constructing the directory path
    folder_path_2 = os.path.join(folder_path, folder_name)

    # Additional needed variables for the folder name
    drs = "Daily Rate Simulation_"
    extension = ".xlsx"

    # Folder Name (Example: Daily Rate Simulation_06252024) 

    folder_name_2 = f"{drs}{current_month_numeric}{current_day_not_int}{current_year}{extension}"
    folder_path_3 = os.path.join(folder_path_2, folder_name_2)

    # For creating a new Excel file with the HOUR and NET columns 
    workbook = openpyxl.Workbook()
    sheet = workbook.active
    sheet['A1'] = 'HOUR'
    sheet['B1'] = 'NET'
    workbook.save('forecasted_energy.xlsx')
    workbook.close()
    print("Excel file 'forecasted_energy.xlsx' created successfully.")
    
    # File path for destination Excel file
    # destination_file_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\forecasted_energy.xlsx'
    destination_file_path = 'forecasted_energy.xlsx'
    # destination_file_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\forecasted_energy.xlsx'
    # Load source workbook
    source_wb = load_workbook(folder_path_3, data_only=True)  # Use data_only=True to get values instead of formulas
    # Sheet name of the source workbook
    source_sheet = source_wb['6. DAP Report']

    # Load destination workbook
    dest_wb = load_workbook(destination_file_path)

    # Sheet name of the destination workbook
    dest_sheet = dest_wb['Sheet']

    # Define source and destination ranges
    source_ranges = [('C11', 'C34'), ('F11', 'F34')]
    dest_ranges = [('A2', 'A25'), ('B2', 'B25')]

    # Copy data from source to destination based on specified ranges
    for i in range(len(source_ranges)):
        copy_values_fe(source_sheet, dest_sheet, source_ranges[i], dest_ranges[i])

    # Save the destination workbook
    dest_wb.save(destination_file_path)

    # Close workbooks
    source_wb.close()
    dest_wb.close()
    print("Data transfer completed.")

# Function to retrieve the current hour in 24-hour format
def get_current_hour_fe():
    now = datetime.now()
    current_hour = now.hour
    if current_hour == 0:
        return 24
    return current_hour

# Function to get net value for the current hour (1 to 24) from Excel
def get_net_for_current_hour(excel_file, current_hour):
    try:
        # Read Excel file into a Pandas DataFrame, assuming 'HOUR' column has numbers 1 to 24
        df = pd.read_excel(excel_file, header=None, names=['HOUR', 'NET'], skiprows=1)
        
        # Filter the row where 'HOUR' matches the current_hour
        net_value = df.loc[df['HOUR'] == current_hour, 'NET'].values[0]
        return float(net_value) if pd.notnull(net_value) else None
    except Exception as e:
        print(f"Error retrieving net value from Excel: {e}")
        return None
    
# Function to insert value into MySQL database
def insert_into_mysql_fe(conn, net_value):
    try:
        cursor = conn.cursor()
        sql = "INSERT INTO forecasted_energy (net) VALUES (%s)"
        cursor.execute(sql, (net_value,))
        conn.commit()  # Commit the transaction
        cursor.close()
        print(f"Value {net_value} inserted successfully into MySQL.")
    except mysql.connector.Error as e:
        print(f"Error inserting into MySQL: {e}")
    except Exception as e:
        print(f"Error: {e}")

# Main function to run the script
def main_fe(excel_file, conn):
    # while True:
    forecasted_energy()
    current_hour = get_current_hour_fe()
    net_value = get_net_for_current_hour(excel_file, current_hour)

    if net_value is not None:
        insert_into_mysql_fe(conn, net_value)
    else:
        print(f"Invalid net_value: {net_value}")

            # Delay for 800 seconds before checking again
            #time.sleep(800)
        
def forecasted_energy_file():
    # while True:
    excel_file = 'forecasted_energy.xlsx'

    conn = mysql.connector.connect(
        host='cesra-db.cxkuksua06qz.ap-southeast-1.rds.amazonaws.com',
        database='myDb',
        user='cesra_dbm',
        password='ibIDN0NcnGYo71qDZuHw',
        port=3309
    )
    
    # Create MySQL table if it doesn't exist
    cursor = conn.cursor()
    cursor.execute("""
        CREATE TABLE IF NOT EXISTS forecasted_energy (
            id INT AUTO_INCREMENT PRIMARY KEY,
            net FLOAT(10, 2) NOT NULL,
            insert_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        )
    """)
    cursor.close()

    # Run main function to continuously check and update database
    main_fe(excel_file, conn)

# ------ from total_bcq_nomination.py file ------
# Function to copy values from source range to destination range
def copy_values_bcq(source_sheet, dest_sheet, source_range, dest_range):
    source_start, source_end = source_range
    dest_start, dest_end = dest_range
    
    # Copy values from source to destination
    source_values = []
    for row in source_sheet[source_start:source_end]:
        for cell in row:
            source_values.append(cell.value)
    
    dest_index = 0
    for row in dest_sheet[dest_start:dest_end]:
        for cell in row:
            if dest_index < len(source_values):
                cell.value = source_values[dest_index]
                dest_index += 1
            else:
                break

def total_bcq_nomination():
    # base_directory = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\01_Energy Sourcing Files\03_Daily Reports\01_Day Ahead Projections"
    # base_directory = r'01_Energy Sourcing Files\03_Daily Reports\01_Day Ahead Projections'
    base_directory = os.path.join('01_Energy Sourcing Files', '03_Daily Reports', '01_Day Ahead Projections')
    # base_directory = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\01_Energy Sourcing Files\03_Daily Reports\01_Day Ahead Projections"
    current_date = datetime.now()
    current_month_numeric = current_date.strftime("%m")
    current_month_name = current_date.strftime("%B")
    current_day = int(current_date.strftime("%d"))
    current_year = current_date.strftime("%Y")
    current_day_not_int = current_date.strftime("%d")

    check_current_month = current_date.strftime("%B")
    # If the current month is December, increment the year
    if check_current_month == "December" and current_day > 25:
        year_to_be_used = str(int(current_year) + 1)
    # Otherwise, use the current year
    else: 
        year_to_be_used = current_date.strftime("%Y")

    folder_path = os.path.join(base_directory, year_to_be_used)
    
    #List of all month names
    months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]
    #Find index of current month
    current_month_index = months.index(current_month_name)

    # if (current_day>'25') and (current_date.strftime("%m") == current_month_numeric):
    #     #Increment current month by converting to integer, adding 1, and formatting back to zero-padded string
    #     current_month_numeric_increment = '{:02d}'.format((int(current_month_numeric) % 12) + 1)
    #     # Calculate index of next month
    #     next_month_index = (current_month_index + 1) % 12
    #     current_month_name = months[next_month_index]
    # elif(current_day<='25') and (current_date.strftime("%m")==current_month_numeric):
    #     current_month_numeric_increment = current_month_numeric

    # Check if the day is past the 25th of the current month
    if current_day > 25 :
        # If it's past the 25th, increment the month
        next_month_index = (current_month_index + 1) % 12 # This handles the rollover from December to January
        current_month_name = months[next_month_index]
        # Set the numeric month increment (for the next month), ensuring 3-digit format 
        current_month_numeric_increment = f'{(int(current_month_numeric) % 12) + 1:03d}'
    else:
        # If it's before or on the 25th, don't change the month
        current_month_numeric_increment = f'{int(current_month_numeric):03d}'

    # Construct the folder name
    folder_name = f"{current_month_numeric_increment}. {current_month_name} {year_to_be_used}"

    # Constructing the directory path
    folder_path_2 = os.path.join(folder_path, folder_name)

    # Additional needed variables for the folder name
    drs = "Daily Rate Simulation_"
    extension = ".xlsx"

    # Folder Name (Example: Daily Rate Simulation_06252024) 

    folder_name_2 = f"{drs}{current_month_numeric}{current_day_not_int}{current_year}{extension}"
    folder_path_3 = os.path.join(folder_path_2, folder_name_2)

    # For creating a new Excel file with the HOUR and TOTAL BCQ NOMINATION columns 
    workbook = openpyxl.Workbook()
    sheet = workbook.active
    sheet['A1'] = 'HOUR'
    sheet['B1'] = 'SCPC'
    sheet['C1'] = 'KSPC'
    sheet['D1'] = 'EDC'
    sheet['E1'] = 'PEDC'
    sheet['F1'] = 'TOTAL_BCQ'

    workbook.save('total_bcq_nomination.xlsx')
    workbook.close()
    print("Excel file 'total_bcq_nomination.xlsx' created successfully.")

    # File path for destination Excel file
    # destination_file_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\total_bcq_nomination.xlsx'
    destination_file_path = 'total_bcq_nomination.xlsx'
    # destination_file_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\total_bcq_nomination.xlsx'
    # Load source workbook
    source_wb = load_workbook(folder_path_3, data_only=True)  # Use data_only=True to get values instead of formulas
    # Sheet name of the source workbook
    source_sheet = source_wb['6. DAP Report']

    # Load destination workbook
    dest_wb = load_workbook(destination_file_path)

    # Sheet name of the destination workbook
    dest_sheet = dest_wb['Sheet']

    # Define source and destination ranges
    source_ranges = [('C11', 'C34'), ('G11', 'G34'), ('H11', 'H34'), ('I11', 'I34'), ('J11', 'J34')]
    dest_ranges = [('A2', 'A25'), ('B2', 'B25'), ('C2', 'C25'), ('D2', 'D25'), ('E2', 'E25')]

    # Copy data from source to destination based on specified ranges
    for i in range(len(source_ranges)):
        copy_values_bcq(source_sheet, dest_sheet, source_ranges[i], dest_ranges[i])

    # Save the destination workbook
    dest_wb.save(destination_file_path)

    # Close workbooks
    source_wb.close()
    dest_wb.close()
    print("Data transfer completed.")

    # Total BCQ of 1st Hour
    value_B2 = dest_sheet['B2'].value
    value_C2 = dest_sheet['C2'].value
    value_D2 = dest_sheet['D2'].value
    value_E2 = dest_sheet['E2'].value

    result2 = value_B2 + value_C2 + value_D2 + value_E2
    dest_sheet['F2'] = result2

    # Total BCQ of 2nd Hour
    value_B3 = dest_sheet['B3'].value
    value_C3 = dest_sheet['C3'].value
    value_D3 = dest_sheet['D3'].value
    value_E3 = dest_sheet['E3'].value

    result3 = value_B3 + value_C3 + value_D3 + value_E3
    dest_sheet['F3'] = result3

    # Total BCQ of 3rd Hour
    value_B4 = dest_sheet['B4'].value
    value_C4 = dest_sheet['C4'].value
    value_D4 = dest_sheet['D4'].value
    value_E4 = dest_sheet['E4'].value

    result4 = value_B4 + value_C4 + value_D4 + value_E4
    dest_sheet['F4'] = result4

    # Total BCQ of 4th Hour
    value_B5 = dest_sheet['B5'].value
    value_C5 = dest_sheet['C5'].value
    value_D5 = dest_sheet['D5'].value
    value_E5 = dest_sheet['E5'].value

    result5 = value_B5 + value_C5 + value_D5 + value_E5
    dest_sheet['F5'] = result5

    # Total BCQ of 5th Hour
    value_B6 = dest_sheet['B6'].value
    value_C6 = dest_sheet['C6'].value
    value_D6 = dest_sheet['D6'].value
    value_E6 = dest_sheet['E6'].value

    result6 = value_B6 + value_C6 + value_D6 + value_E6
    dest_sheet['F6'] = result6

    # Total BCQ of 6th Hour
    value_B7 = dest_sheet['B7'].value
    value_C7 = dest_sheet['C7'].value
    value_D7 = dest_sheet['D7'].value
    value_E7 = dest_sheet['E7'].value

    result7 = value_B7 + value_C7 + value_D7 + value_E7
    dest_sheet['F7'] = result7

    # Total BCQ of 7th Hour
    value_B8 = dest_sheet['B8'].value
    value_C8 = dest_sheet['C8'].value
    value_D8 = dest_sheet['D8'].value
    value_E8 = dest_sheet['E8'].value

    result8 = value_B8 + value_C8 + value_D8 + value_E8
    dest_sheet['F8'] = result8

    # Total BCQ of 8th Hour
    value_B9 = dest_sheet['B9'].value
    value_C9 = dest_sheet['C9'].value
    value_D9 = dest_sheet['D9'].value
    value_E9 = dest_sheet['E9'].value

    result9 = value_B9 + value_C9 + value_D9 + value_E9
    dest_sheet['F9'] = result9

    # Total BCQ of 9th Hour
    value_B10 = dest_sheet['B10'].value
    value_C10 = dest_sheet['C10'].value
    value_D10 = dest_sheet['D10'].value
    value_E10 = dest_sheet['E10'].value

    result10 = value_B10 + value_C10 + value_D10 + value_E10
    dest_sheet['F10'] = result10

    # Total BCQ of 10th Hour
    value_B11 = dest_sheet['B11'].value
    value_C11 = dest_sheet['C11'].value
    value_D11 = dest_sheet['D11'].value
    value_E11 = dest_sheet['E11'].value

    result11 = value_B11 + value_C11 + value_D11 + value_E11
    dest_sheet['F11'] = result11

    # Total BCQ of 11th Hour
    value_B12 = dest_sheet['B12'].value
    value_C12 = dest_sheet['C12'].value
    value_D12 = dest_sheet['D12'].value
    value_E12 = dest_sheet['E12'].value

    result12 = value_B12 + value_C12 + value_D12 + value_E12
    dest_sheet['F12'] = result12

    # Total BCQ of 12th Hour
    value_B13 = dest_sheet['B13'].value
    value_C13 = dest_sheet['C13'].value
    value_D13 = dest_sheet['D13'].value
    value_E13 = dest_sheet['E13'].value

    result13 = value_B13 + value_C13 + value_D13 + value_E13
    dest_sheet['F13'] = result13

    # Total BCQ of 13th Hour
    value_B14 = dest_sheet['B14'].value
    value_C14 = dest_sheet['C14'].value
    value_D14 = dest_sheet['D14'].value
    value_E14 = dest_sheet['E14'].value

    result14 = value_B14 + value_C14 + value_D14 + value_E14
    dest_sheet['F14'] = result14

    # Total BCQ of 14th Hour
    value_B15 = dest_sheet['B15'].value
    value_C15 = dest_sheet['C15'].value
    value_D15 = dest_sheet['D15'].value
    value_E15 = dest_sheet['E15'].value

    result15 = value_B15 + value_C15 + value_D15 + value_E15
    dest_sheet['F15'] = result15

    # Total BCQ of 15th Hour
    value_B16 = dest_sheet['B16'].value
    value_C16 = dest_sheet['C16'].value
    value_D16 = dest_sheet['D16'].value
    value_E16 = dest_sheet['E16'].value

    result16 = value_B16 + value_C16 + value_D16 + value_E16
    dest_sheet['F16'] = result16

    # Total BCQ of 16th Hour
    value_B17 = dest_sheet['B17'].value
    value_C17 = dest_sheet['C17'].value
    value_D17 = dest_sheet['D17'].value
    value_E17 = dest_sheet['E17'].value

    result17 = value_B17 + value_C17 + value_D17 + value_E17
    dest_sheet['F17'] = result17

    # Total BCQ of 17th Hour
    value_B18 = dest_sheet['B18'].value
    value_C18 = dest_sheet['C18'].value
    value_D18 = dest_sheet['D18'].value
    value_E18 = dest_sheet['E18'].value

    result18 = value_B18 + value_C18 + value_D18 + value_E18
    dest_sheet['F18'] = result18

    # Total BCQ of 18th Hour
    value_B19 = dest_sheet['B19'].value
    value_C19 = dest_sheet['C19'].value
    value_D19 = dest_sheet['D19'].value
    value_E19 = dest_sheet['E19'].value

    result19 = value_B19 + value_C19 + value_D19 + value_E19
    dest_sheet['F19'] = result19

    # Total BCQ of 19th Hour
    value_B20 = dest_sheet['B20'].value
    value_C20 = dest_sheet['C20'].value
    value_D20 = dest_sheet['D20'].value
    value_E20 = dest_sheet['E20'].value

    result20 = value_B20 + value_C20 + value_D20 + value_E20
    dest_sheet['F20'] = result20

    # Total BCQ of 20th Hour
    value_B21 = dest_sheet['B21'].value
    value_C21 = dest_sheet['C21'].value
    value_D21 = dest_sheet['D21'].value
    value_E21 = dest_sheet['E21'].value

    result21 = value_B21 + value_C21 + value_D21 + value_E21
    dest_sheet['F21'] = result21

    # Total BCQ of 21st Hour
    value_B22 = dest_sheet['B22'].value
    value_C22 = dest_sheet['C22'].value
    value_D22 = dest_sheet['D22'].value
    value_E22 = dest_sheet['E22'].value

    result22 = value_B22 + value_C22 + value_D22 + value_E22
    dest_sheet['F22'] = result22

    # Total BCQ of 22nd Hour
    value_B23 = dest_sheet['B23'].value
    value_C23 = dest_sheet['C23'].value
    value_D23 = dest_sheet['D23'].value
    value_E23 = dest_sheet['E23'].value

    result23 = value_B23 + value_C23 + value_D23 + value_E23
    dest_sheet['F23'] = result23

    # Total BCQ of 23rd Hour
    value_B24 = dest_sheet['B24'].value
    value_C24 = dest_sheet['C24'].value
    value_D24 = dest_sheet['D24'].value
    value_E24 = dest_sheet['E24'].value

    result24 = value_B24 + value_C24 + value_D24 + value_E24
    dest_sheet['F24'] = result24

    # Total BCQ of 24th Hour
    value_B25 = dest_sheet['B25'].value
    value_C25 = dest_sheet['C25'].value
    value_D25 = dest_sheet['D25'].value
    value_E25 = dest_sheet['E25'].value

    result25 = value_B25 + value_C25 + value_D25 + value_E25
    dest_sheet['F25'] = result25

    # Save the workbook back to file
    dest_wb.save(destination_file_path)

# Function to retrieve the current hour in 24-hour format
def get_current_hour_bcq():
    now = datetime.now()
    current_hour = now.hour
    if current_hour == 0:
        return 24
    return current_hour

def get_total_bcq_for_current_hour(excel_file, current_hour):
    try:
        df = pd.read_excel(excel_file, header=None, names=['HOUR', 'SCPC', 'KSPC', 'EDC', 'PEDC', 'TOTAL_BCQ'], skiprows=1)
        total_bcq_value = df.loc[df['HOUR'] == current_hour, 'TOTAL_BCQ'].values[0]
        return float(total_bcq_value) if pd.notnull(total_bcq_value) else None
    except Exception as e:
        print(f"Error retrieving total bcq value from Excel: {e}")
        return None
    
def insert_into_mysql_bcq(conn, total_bcq_value):
    try:
        cursor = conn.cursor()
        sql = "INSERT INTO total_bcq_nomination (total_bcq) VALUES (%s)"
        cursor.execute(sql, (total_bcq_value,))
        conn.commit()
        cursor.close()
        print(f"Value {total_bcq_value} inserted successfully into MySQL.")
    except mysql.connector.Error as e:
        print(f"Error inserting into MySQL: {e}")
    except Exception as e:
        print(f"Error: {e}")

def main_bcq(excel_file, conn):
    # while True:
    total_bcq_nomination()
    current_hour = get_current_hour_bcq()
    total_bcq_value = get_total_bcq_for_current_hour(excel_file, current_hour)

    if total_bcq_value is not None:
        insert_into_mysql_bcq(conn, total_bcq_value)
    else:
        print(f"Invalid total_bcq_value: {total_bcq_value}")

        # time.sleep(800)

def total_bcq_nomination_file():
    # while True:
    excel_file = 'total_bcq_nomination.xlsx'

    conn = mysql.connector.connect(
        host='cesra-db.cxkuksua06qz.ap-southeast-1.rds.amazonaws.com',
        database='myDb',
        user='cesra_dbm',
        password='ibIDN0NcnGYo71qDZuHw',
        port=3309
    )

    # Create MySQL table if it doesn't exist
    cursor = conn.cursor()
    cursor.execute("""
        CREATE TABLE IF NOT EXISTS total_bcq_nomination (
            id INT AUTO_INCREMENT PRIMARY KEY,
            total_bcq FLOAT(10, 2) NOT NULL,
            insert_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        )
    """)
    cursor.close()

    main_bcq(excel_file, conn)


# ------ from contestable_energy.py file ------
# Function to copy values from source range to destination range
def copy_values_ce(source_sheet, dest_sheet, source_range, dest_range):
    source_start, source_end = source_range
    dest_start, dest_end = dest_range
    
    # Copy values from source to destination
    source_values = []
    for row in source_sheet[source_start:source_end]:
        for cell in row:
            source_values.append(cell.value)
    
    dest_index = 0
    for row in dest_sheet[dest_start:dest_end]:
        for cell in row:
            if dest_index < len(source_values):
                cell.value = source_values[dest_index]
                dest_index += 1
            else:
                break

def contestable_energy_ce():
    # base_directory = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\01_Energy Sourcing Files\03_Daily Reports\01_Day Ahead Projections"
    # base_directory = r'01_Energy Sourcing Files\03_Daily Reports\01_Day Ahead Projections'
    base_directory = os.path.join('01_Energy Sourcing Files', '03_Daily Reports', '01_Day Ahead Projections')
    # base_directory = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\01_Energy Sourcing Files\03_Daily Reports\01_Day Ahead Projections"
    current_date = datetime.now()
    current_month_numeric = current_date.strftime("%m")
    current_month_name = current_date.strftime("%B")
    current_day = int(current_date.strftime("%d"))
    current_year = current_date.strftime("%Y")
    current_day_not_int = current_date.strftime("%d")

    check_current_month = current_date.strftime("%B")
    # If the current month is December, increment the year
    if check_current_month == "December" and current_day > 25:
        year_to_be_used = str(int(current_year) + 1)
    # Otherwise, use the current year
    else: 
        year_to_be_used = current_date.strftime("%Y")

    folder_path = os.path.join(base_directory, year_to_be_used)
    
    #List of all month names
    months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]
    #Find index of current month
    current_month_index = months.index(current_month_name)

    # if (current_day>'25') and (current_date.strftime("%m") == current_month_numeric):
    #     #Increment current month by converting to integer, adding 1, and formatting back to zero-padded string
    #     current_month_numeric_increment = '{:02d}'.format((int(current_month_numeric) % 12) + 1)
    #     # Calculate index of next month
    #     next_month_index = (current_month_index + 1) % 12
    #     current_month_name = months[next_month_index]
    # elif(current_day<='25') and (current_date.strftime("%m")==current_month_numeric):
    #     current_month_numeric_increment = current_month_numeric

    # Check if the day is past the 25th of the current month
    if current_day > 25 :
        # If it's past the 25th, increment the month
        next_month_index = (current_month_index + 1) % 12 # This handles the rollover from December to January
        current_month_name = months[next_month_index]
        # Set the numeric month increment (for the next month), ensuring 3-digit format 
        current_month_numeric_increment = f'{(int(current_month_numeric) % 12) + 1:03d}'
    else:
        # If it's before or on the 25th, don't change the month
        current_month_numeric_increment = f'{int(current_month_numeric):03d}'

    # Construct the folder name
    folder_name = f"{current_month_numeric_increment}. {current_month_name} {year_to_be_used}"

    # Constructing the directory path
    folder_path_2 = os.path.join(folder_path, folder_name)

    # Additional needed variables for the folder name
    drs = "Daily Rate Simulation_"
    extension = ".xlsx"

    # Folder Name (Example: Daily Rate Simulation_06252024) 

    folder_name_2 = f"{drs}{current_month_numeric}{current_day_not_int}{current_year}{extension}"
    folder_path_3 = os.path.join(folder_path_2, folder_name_2)

    # For creating a new Excel file with the HOUR and CC columns 
    workbook = openpyxl.Workbook()
    sheet = workbook.active
    sheet['A1'] = 'HOUR'
    sheet['B1'] = 'CC'
    workbook.save('contestable_energy.xlsx')
    workbook.close()
    print("Excel file 'contestable_energy.xlsx' created successfully.")

    # File path for destination Excel file
    # destination_file_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\contestable_energy.xlsx'
    destination_file_path = 'contestable_energy.xlsx'
    # destination_file_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\contestable_energy.xlsx'
    # Load source workbook
    source_wb = load_workbook(folder_path_3, data_only=True)  # Use data_only=True to get values instead of formulas
    # Sheet name of the source workbook
    source_sheet = source_wb['6. DAP Report']

    # Load destination workbook
    dest_wb = load_workbook(destination_file_path)

    # Sheet name of the destination workbook
    dest_sheet = dest_wb['Sheet']

    # Define source and destination ranges
    source_ranges = [('C11', 'C34'), ('E11', 'E34')]
    dest_ranges = [('A2', 'A25'), ('B2', 'B25')]

    # Copy data from source to destination based on specified ranges
    for i in range(len(source_ranges)):
        copy_values_ce(source_sheet, dest_sheet, source_ranges[i], dest_ranges[i])

    # Save the destination workbook
    dest_wb.save(destination_file_path)

    # Close workbooks
    source_wb.close()
    dest_wb.close()
    print("Data transfer completed.")

# Function to retrieve the current hour in 24-hour format
def get_current_hour_ce():
    now = datetime.now()
    current_hour = now.hour
    if current_hour == 0:
        return 24
    return current_hour

# Function to get cc value for the current hour (1 to 24) from Excel
def get_cc_for_current_hour(excel_file, current_hour):
    try:
        # Read Excel file into a Pandas DataFrame, assuming 'HOUR' column has numbers 1 to 24
        df = pd.read_excel(excel_file, header=None, names=['HOUR', 'CC'], skiprows=1)
        
        # Filter the row where 'HOUR' matches the current_hour
        cc_value = df.loc[df['HOUR'] == current_hour, 'CC'].values[0]
        return float(cc_value) if pd.notnull(cc_value) else None
    except Exception as e:
        print(f"Error retrieving cc value from Excel: {e}")
        return None
    
# Function to insert value into MySQL database
def insert_into_mysql_ce(conn, cc_value):
    try:
        cursor = conn.cursor()
        sql = "INSERT INTO contestable_energy (cc) VALUES (%s)"
        cursor.execute(sql, (cc_value,))
        conn.commit()  # Commit the transaction
        cursor.close()
        print(f"Value {cc_value} inserted successfully into MySQL.")
    except mysql.connector.Error as e:
        print(f"Error inserting into MySQL: {e}")
    except Exception as e:
        print(f"Error: {e}")

# Main function to run the script
def main_ce(excel_file, conn):
    # while True:
    contestable_energy_ce()
    current_hour = get_current_hour_ce()
    cc_value = get_cc_for_current_hour(excel_file, current_hour)

    if cc_value is not None:
        insert_into_mysql_ce(conn, cc_value)
    else:
        print(f"Invalid cc_value: {cc_value}")

    # Delay for 800 seconds before checking again
    # time.sleep(800)
        
def contestable_energy_file():
    # while True:
    excel_file = 'contestable_energy.xlsx'

    conn = mysql.connector.connect(
        host='cesra-db.cxkuksua06qz.ap-southeast-1.rds.amazonaws.com',
        database='myDb',
        user='cesra_dbm',
        password='ibIDN0NcnGYo71qDZuHw',
        port=3309
    )

    # Create MySQL table if it doesn't exist
    cursor = conn.cursor()
    cursor.execute("""
        CREATE TABLE IF NOT EXISTS contestable_energy (
            id INT AUTO_INCREMENT PRIMARY KEY,
            cc FLOAT(10, 2) NOT NULL,
            insert_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        )
    """)
    cursor.close()

    # Run main function to continuously check and update database
    main_ce(excel_file, conn)


# ------ from more_trading_node.py file ------
# FTP server details
FTP_SERVER = "120.28.19.206"
FTP_USER = "MORE_01"
FTP_PASSWD = "ar@pNkRW4v"
FTP_DIRECTORY = "/LMP/DIPC/"
# LOCAL_DIRECTORY = "C:\\Users\\aslee\\OneDrive - MORE ELECTRIC AND POWER CORPORATION\\Desktop\\DASHBOARD_FINAL\\MORE Trading Node\\"
LOCAL_DIRECTORY = r'MORE Trading Node'
# LOCAL_DIRECTORY = "E:\\OneDrive - MORE ELECTRIC AND POWER CORPORATION\\Desktop\\DASHBOARD_FINAL\\MORE Trading Node\\"
CHECK_INTERVAL = 300  # In seconds

# Function to connect to the FTP server
def connect_ftp():
    ftp = FTP(FTP_SERVER)
    ftp.login(user=FTP_USER, passwd=FTP_PASSWD)
    ftp.cwd(FTP_DIRECTORY)
    return ftp

# Function to download files from the FTP server
def download_files():
    now = datetime.now()  
    date_today = now.strftime("%Y%m%d")

    # Connect to FTP server
    ftp = connect_ftp()

    # List the files in the FTP directory
    files = ftp.nlst()

    for addtl_folder in files:
        # If the folder name matches today's date
        if addtl_folder == date_today:
            ftp_folder_file = f"/LMP/DIPC/{addtl_folder}"
            local_folder_file = os.path.join(LOCAL_DIRECTORY, addtl_folder)

            print(f"Checking FTP folder path: {ftp_folder_file}")
            print(f"Checking local folder path: {local_folder_file}")

            try:
                # Check if the folder exists on the FTP server
                ftp.cwd(ftp_folder_file)
                folder_exists = True
            except error_perm:
                folder_exists = False
                print(f"FTP folder does not exist: {ftp_folder_file}")

            if folder_exists:
                # Ensure the destination folder exists
                if not os.path.exists(local_folder_file):
                    os.makedirs(local_folder_file)

                # Download the files from the FTP server to the local folder
                filenames = ftp.nlst()
                for filename in filenames:
                    local_file_path = os.path.join(local_folder_file, filename)

                    # Check if the file already exists locally
                    if not os.path.exists(local_file_path):
                        try:
                            with open(local_file_path, 'wb') as local_file:
                                ftp.retrbinary('RETR ' + filename, local_file.write)
                            print(f"Copied {filename} to {local_file_path}")
                        except error_perm as e:
                            print(f"Could not copy {filename}: {e}")
                        except all_errors as e:
                            print(f"An FTP error occurred: {e}")
                    else:
                        print(f"{filename} already exists locally, skipping download.")

    ftp.quit()

def more_trading_node_file():
    # Main loop to check for new files every CHECK_INTERVAL seconds
    # while True:
    try:
        download_files()
    except all_errors as e:
        print(f"An error occurred: {e}")
    #time.sleep(CHECK_INTERVAL)

# ------ from more_trading_node_2nd_part.py file ------
def find_total_mtn():
    # directory = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\MORE Trading Node'
    directory = r'MORE Trading Node'
    # directory = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\MORE Trading Node'
    now = datetime.now()
    # Example folder name: 20240711
    date_today = now.strftime("%Y%m%d")
    contents = os.listdir(directory)
    for item in contents:
        if item == date_today:
            folder_path = os.path.join(directory, item) 
            if os.path.isdir(folder_path):
                files_in_folder = os.listdir(folder_path) # MPI_LMP_DIPC_202407110000, etc.
                current_hour = now.strftime("%H")

                if current_hour == '01':

                    try: 
                        first_file_path = os.path.join(folder_path, files_in_folder[1])
                        second_file_path = os.path.join(folder_path, files_in_folder[2])
                        third_file_path = os.path.join(folder_path, files_in_folder[3])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[4])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[5])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[6])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[7])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[8])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[9])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[10])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[11])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[12])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                    except:
                        final_total = 0
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '02':

                    try:

                        first_file_path = os.path.join(folder_path, files_in_folder[13])
                        second_file_path = os.path.join(folder_path, files_in_folder[14])
                        third_file_path = os.path.join(folder_path, files_in_folder[15])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[16])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[17])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[18])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[19])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[20])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[21])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[22])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[23])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[24])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                        
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                            
                        first_file_path = os.path.join(folder_path, files_in_folder[1])
                        second_file_path = os.path.join(folder_path, files_in_folder[2])
                        third_file_path = os.path.join(folder_path, files_in_folder[3])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[4])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[5])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[6])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[7])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[8])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[9])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[10])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[11])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[12])
                        
                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '03':
                    try: 
                        first_file_path = os.path.join(folder_path, files_in_folder[25])
                        second_file_path = os.path.join(folder_path, files_in_folder[26])
                        third_file_path = os.path.join(folder_path, files_in_folder[27])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[28])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[29])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[30])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[31])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[32])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[33])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[34])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[35])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[36])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                        
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[13])
                        second_file_path = os.path.join(folder_path, files_in_folder[14])
                        third_file_path = os.path.join(folder_path, files_in_folder[15])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[16])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[17])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[18])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[19])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[20])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[21])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[22])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[23])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[24])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_1 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_1 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_1 + file_08STBAR_T1L1_1)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                        
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '04':
                    try: 
                        first_file_path = os.path.join(folder_path, files_in_folder[37])
                        second_file_path = os.path.join(folder_path, files_in_folder[38])
                        third_file_path = os.path.join(folder_path, files_in_folder[39])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[40])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[41])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[42])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[43])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[44])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[45])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[46])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[47])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[48])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:

                        first_file_path = os.path.join(folder_path, files_in_folder[25])
                        second_file_path = os.path.join(folder_path, files_in_folder[26])
                        third_file_path = os.path.join(folder_path, files_in_folder[27])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[28])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[29])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[30])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[31])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[32])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[33])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[34])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[35])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[36])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                        
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '05':

                    try: 
                        first_file_path = os.path.join(folder_path, files_in_folder[49])
                        second_file_path = os.path.join(folder_path, files_in_folder[50])
                        third_file_path = os.path.join(folder_path, files_in_folder[51])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[52])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[53])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[54])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[55])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[56])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[57])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[58])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[59])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[60])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                    except:

                        first_file_path = os.path.join(folder_path, files_in_folder[37])
                        second_file_path = os.path.join(folder_path, files_in_folder[38])
                        third_file_path = os.path.join(folder_path, files_in_folder[39])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[40])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[41])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[42])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[43])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[44])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[45])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[46])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[47])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[48])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '06':

                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[61])
                        second_file_path = os.path.join(folder_path, files_in_folder[62])
                        third_file_path = os.path.join(folder_path, files_in_folder[63])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[64])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[65])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[66])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[67])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[68])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[69])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[70])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[71])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[72])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[49])
                        second_file_path = os.path.join(folder_path, files_in_folder[50])
                        third_file_path = os.path.join(folder_path, files_in_folder[51])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[52])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[53])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[54])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[55])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[56])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[57])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[58])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[59])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[60])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '07':

                    try: 

                        first_file_path = os.path.join(folder_path, files_in_folder[73])
                        second_file_path = os.path.join(folder_path, files_in_folder[74])
                        third_file_path = os.path.join(folder_path, files_in_folder[75])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[76])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[77])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[78])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[79])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[80])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[81])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[82])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[83])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[84])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[61])
                        second_file_path = os.path.join(folder_path, files_in_folder[62])
                        third_file_path = os.path.join(folder_path, files_in_folder[63])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[64])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[65])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[66])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[67])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[68])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[69])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[70])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[71])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[72])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '08':

                    try: 

                        first_file_path = os.path.join(folder_path, files_in_folder[85])
                        second_file_path = os.path.join(folder_path, files_in_folder[86])
                        third_file_path = os.path.join(folder_path, files_in_folder[87])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[88])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[89])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[90])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[91])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[92])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[93])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[94])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[95])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[96])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_1 + file_08STBAR_T1L1_1)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:

                        first_file_path = os.path.join(folder_path, files_in_folder[73])
                        second_file_path = os.path.join(folder_path, files_in_folder[74])
                        third_file_path = os.path.join(folder_path, files_in_folder[75])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[76])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[77])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[78])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[79])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[80])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[81])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[82])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[83])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[84])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '09':

                    try: 
                        first_file_path = os.path.join(folder_path, files_in_folder[97])
                        second_file_path = os.path.join(folder_path, files_in_folder[98])
                        third_file_path = os.path.join(folder_path, files_in_folder[99])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[100])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[101])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[102])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[103])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[104])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[105])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[106])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[107])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[108])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:

                        first_file_path = os.path.join(folder_path, files_in_folder[85])
                        second_file_path = os.path.join(folder_path, files_in_folder[86])
                        third_file_path = os.path.join(folder_path, files_in_folder[87])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[88])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[89])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[90])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[91])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[92])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[93])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[94])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[95])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[96])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '10':

                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[109])
                        second_file_path = os.path.join(folder_path, files_in_folder[110])
                        third_file_path = os.path.join(folder_path, files_in_folder[111])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[112])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[113])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[114])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[115])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[116])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[117])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[118])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[119])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[120])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                    
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_file_path = os.path.join(folder_path, files_in_folder[114])
                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[97])
                        second_file_path = os.path.join(folder_path, files_in_folder[98])
                        third_file_path = os.path.join(folder_path, files_in_folder[99])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[100])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[101])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[102])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[103])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[104])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[105])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[106])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[107])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[108])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                elif current_hour == '11':
                    try: 
                        first_file_path = os.path.join(folder_path, files_in_folder[121])
                        second_file_path = os.path.join(folder_path, files_in_folder[122])
                        third_file_path = os.path.join(folder_path, files_in_folder[123])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[124])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[125])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[126])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[127])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[128])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[129])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[130])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[131])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[132])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3
                        
                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[109])
                        second_file_path = os.path.join(folder_path, files_in_folder[110])
                        third_file_path = os.path.join(folder_path, files_in_folder[111])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[112])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[113])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[114])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[115])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[116])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[117])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[118])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[119])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[120])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                    
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3
                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_file_path = os.path.join(folder_path, files_in_folder[114])
                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '12':
                    try: 
                        first_file_path = os.path.join(folder_path, files_in_folder[133])
                        second_file_path = os.path.join(folder_path, files_in_folder[134])
                        third_file_path = os.path.join(folder_path, files_in_folder[135])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[136])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[137])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[138])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[139])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[140])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[141])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[142])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[143])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[144])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[121])
                        second_file_path = os.path.join(folder_path, files_in_folder[122])
                        third_file_path = os.path.join(folder_path, files_in_folder[123])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[124])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[125])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[126])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[127])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[128])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[129])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[130])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[131])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[132])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '13':

                    try: 

                        first_file_path = os.path.join(folder_path, files_in_folder[145])
                        second_file_path = os.path.join(folder_path, files_in_folder[146])
                        third_file_path = os.path.join(folder_path, files_in_folder[147])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[148])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[149])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[150])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[151])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[152])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[153])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[154])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[155])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[156])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                    
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[133])
                        second_file_path = os.path.join(folder_path, files_in_folder[134])
                        third_file_path = os.path.join(folder_path, files_in_folder[135])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[136])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[137])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[138])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[139])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[140])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[141])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[142])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[143])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[144])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '14':
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[157])
                        second_file_path = os.path.join(folder_path, files_in_folder[158])
                        third_file_path = os.path.join(folder_path, files_in_folder[159])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[160])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[161])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[162])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[163])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[164])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[165])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[166])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[167])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[168])
                    
                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_file_path = os.path.join(folder_path, files_in_folder[168])
                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[145])
                        second_file_path = os.path.join(folder_path, files_in_folder[146])
                        third_file_path = os.path.join(folder_path, files_in_folder[147])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[148])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[149])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[150])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[151])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[152])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[153])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[154])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[155])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[156])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                    
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '15':

                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[169])
                        second_file_path = os.path.join(folder_path, files_in_folder[170])
                        third_file_path = os.path.join(folder_path, files_in_folder[171])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[172])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[173])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[174])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[175])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[176])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[177])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[178])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[179])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[180])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                    
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:

                        first_file_path = os.path.join(folder_path, files_in_folder[157])
                        second_file_path = os.path.join(folder_path, files_in_folder[158])
                        third_file_path = os.path.join(folder_path, files_in_folder[159])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[160])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[161])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[162])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[163])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[164])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[165])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[166])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[167])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[168])
                    
                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_file_path = os.path.join(folder_path, files_in_folder[168])
                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
            
                elif current_hour == '16':
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[181])
                        second_file_path = os.path.join(folder_path, files_in_folder[182])
                        third_file_path = os.path.join(folder_path, files_in_folder[183])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[184])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[185])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[186])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[187])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[188])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[189])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[190])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[191])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[192])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[169])
                        second_file_path = os.path.join(folder_path, files_in_folder[170])
                        third_file_path = os.path.join(folder_path, files_in_folder[171])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[172])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[173])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[174])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[175])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[176])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[177])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[178])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[179])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[180])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                    
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '17':
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[193])
                        second_file_path = os.path.join(folder_path, files_in_folder[194])
                        third_file_path = os.path.join(folder_path, files_in_folder[195])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[196])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[197])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[198])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[199])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[200])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[201])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[202])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[203])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[204])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[181])
                        second_file_path = os.path.join(folder_path, files_in_folder[182])
                        third_file_path = os.path.join(folder_path, files_in_folder[183])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[184])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[185])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[186])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[187])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[188])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[189])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[190])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[191])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[192])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                
                elif current_hour == '18':
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[205])
                        second_file_path = os.path.join(folder_path, files_in_folder[206])
                        third_file_path = os.path.join(folder_path, files_in_folder[207])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[208])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[209])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[210])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[211])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[212])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[213])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[214])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[215])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[216])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                    
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                    
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[193])
                        second_file_path = os.path.join(folder_path, files_in_folder[194])
                        third_file_path = os.path.join(folder_path, files_in_folder[195])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[196])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[197])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[198])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[199])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[200])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[201])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[202])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[203])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[204])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '19':
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[217])
                        second_file_path = os.path.join(folder_path, files_in_folder[218])
                        third_file_path = os.path.join(folder_path, files_in_folder[219])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[220])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[221])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[222])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[223])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[224])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[225])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[226])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[227])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[228])
                    
                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:

                        first_file_path = os.path.join(folder_path, files_in_folder[205])
                        second_file_path = os.path.join(folder_path, files_in_folder[206])
                        third_file_path = os.path.join(folder_path, files_in_folder[207])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[208])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[209])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[210])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[211])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[212])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[213])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[214])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[215])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[216])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                    
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                    
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '20':

                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[229])
                        second_file_path = os.path.join(folder_path, files_in_folder[230])
                        third_file_path = os.path.join(folder_path, files_in_folder[231])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[232])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[233])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[234])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[235])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[236])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[237])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[238])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[239])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[240])
                    
                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[217])
                        second_file_path = os.path.join(folder_path, files_in_folder[218])
                        third_file_path = os.path.join(folder_path, files_in_folder[219])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[220])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[221])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[222])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[223])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[224])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[225])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[226])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[227])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[228])
                    
                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '21': 
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[241])
                        second_file_path = os.path.join(folder_path, files_in_folder[242])
                        third_file_path = os.path.join(folder_path, files_in_folder[243])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[244])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[245])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[246])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[247])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[248])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[249])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[250])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[251])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[252])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[229])
                        second_file_path = os.path.join(folder_path, files_in_folder[230])
                        third_file_path = os.path.join(folder_path, files_in_folder[231])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[232])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[233])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[234])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[235])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[236])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[237])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[238])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[239])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[240])
                    
                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                elif current_hour == '22':
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[253])
                        second_file_path = os.path.join(folder_path, files_in_folder[254])
                        third_file_path = os.path.join(folder_path, files_in_folder[255])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[256])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[257])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[258])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[259])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[260])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[261])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[262])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[263])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[264])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:

                        first_file_path = os.path.join(folder_path, files_in_folder[241])
                        second_file_path = os.path.join(folder_path, files_in_folder[242])
                        third_file_path = os.path.join(folder_path, files_in_folder[243])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[244])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[245])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[246])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[247])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[248])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[249])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[250])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[251])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[252])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '23':
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[265])
                        second_file_path = os.path.join(folder_path, files_in_folder[266])
                        third_file_path = os.path.join(folder_path, files_in_folder[267])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[268])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[269])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[270])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[271])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[272])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[273])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[274])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[275])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[276])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[253])
                        second_file_path = os.path.join(folder_path, files_in_folder[254])
                        third_file_path = os.path.join(folder_path, files_in_folder[255])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[256])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[257])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[258])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[259])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[260])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[261])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[262])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[263])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[264])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '00':
                        final_total = 0
                        float_final_total = float(final_total)
                        return float_final_total
                
def insert_into_mysql_mtn(conn, float_final_total):
    try:
        cursor = conn.cursor()
        sql = "INSERT INTO more_trading_node (float_final_total) VALUES (%s)"
        cursor.execute(sql, (float_final_total,))
        conn.commit()  # Commit the transaction
        print(f"Value {float_final_total} inserted successfully into MySQL.")
    except mysql.connector.Error as err:
        print(f"Error: {err}")
        conn.rollback()
    finally:
        if cursor:
            cursor.close()

def retrieve_and_insert_last_value_mtn(conn):
    try:
        cursor = conn.cursor()
        
        # SQL Query to get the last value
        sql_retrieve = "SELECT float_final_total FROM more_trading_node ORDER BY id DESC LIMIT 1"
        cursor.execute(sql_retrieve)
        result = cursor.fetchone()
        
        # Check if a result was found
        if result:
            last_value = result[0]
            print(f"Last value retrieved from the database: {last_value}")
            
            # SQL Insert Statement to insert the last value back into the database
            sql_insert = "INSERT INTO more_trading_node (float_final_total) VALUES (%s)"
            cursor.execute(sql_insert, (last_value,))
            conn.commit()
            print(f"Last value {last_value} inserted successfully into MySQL.")
        else:
            print("No previous value found in the database.")
    except mysql.connector.Error as err:
        print(f"Error: {err}")
        conn.rollback()
    finally:
        if cursor:
            cursor.close()

def run_continuously(conn):
    # while True:
    try:
        float_final_total = find_total_mtn()
        insert_into_mysql_mtn(conn, float_final_total)
    except pd.errors.EmptyDataError:
        retrieve_and_insert_last_value_mtn(conn)
    # except Exception as e:
    #     print(f"Unexpected error: {e}")
        #time.sleep(800) # Wait for 800 seconds before next update

def more_trading_node_2nd_part_file():
    conn = None
    try:
        conn = mysql.connector.connect(
            host='cesra-db.cxkuksua06qz.ap-southeast-1.rds.amazonaws.com',
            database='myDb',
            user='cesra_dbm',
            password='ibIDN0NcnGYo71qDZuHw',
            port=3309
        )
        cursor = conn.cursor()
        cursor.execute("""
            CREATE TABLE IF NOT EXISTS more_trading_node (
                id INT AUTO_INCREMENT PRIMARY KEY,
                float_final_total FLOAT(10, 4) NOT NULL,
                insert_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        """)
        cursor.close()
        
        # Run this function to continuously check and update database
        run_continuously(conn)
    finally:
        if conn and conn.is_connected():
            conn.close()

# ------ from total_substation_load_final.py file ------
# File locations
# file_loc = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\\'
# file_loc = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\\'
current_day = datetime.today()

# def query_substation_data():
#     try:
#         # Create SQLAlchemy engine
#         engine = create_engine('mysql+mysqlconnector://mepcadmi_guest:hJER8pBv8WyS@192.185.52.175/mepcadmi_empower')

#         query = (
#             "SELECT substation, feeder_no, date_entered, time_entered, load_kw, meter_reading, main_meter "
#             "FROM mepcadmi_empower.substation_load WHERE date_entered = '{}' "
#         ).format(current_day.strftime('%Y-%m-%d'))

#         substation_load_df = pd.read_sql(query, engine, parse_dates={"date_entered": {"format": "%d/%m/%y"}})
#         substation_load_df = substation_load_df.sort_values(by=['date_entered', 'time_entered'])

#         substation_load_df = pd.pivot_table(substation_load_df, values='load_kw',
#                                             index=['date_entered', 'time_entered'], columns='substation',
#                                             aggfunc='sum')
#         substation_load_df['10 MVA Mobile SS - MS1'] = 0
#         # substation_load_df['MOLO SUBSTATION'] = 0
#         substation_load_df = substation_load_df[
#             ['LAPAZ SUBSTATION', 'JARO SUBSTATION', 'MANDURRIAO SUBSTATION', 'MOLO SUBSTATION',
#              'DIVERSION SUBSTATION', '10 MVA Mobile SS - MS1', '36 MVA Mobile SS - MS2', '36 MVA Megaworld SS - MGW']]
#         substation_load_df = substation_load_df.reset_index()
#         substation_load_df.columns = ['Date', 'Hour', 'S1', 'S2', 'S3', 'S4', 'S5', 'S6', 'S7', 'S8']
#         substation_load_df.fillna(0, inplace=True)
#         substation_load_df['Total'] = substation_load_df['S1'] + substation_load_df['S2'] + substation_load_df['S3'] + \
#                                       substation_load_df['S4'] + substation_load_df['S5'] + substation_load_df['S6'] + \
#                                       substation_load_df['S7'] + substation_load_df['S8']
#         substation_load_df['eS1'] = substation_load_df['S1'] * 1.0001
#         substation_load_df['eS2'] = substation_load_df['S2'] * 1.0001
#         substation_load_df['eS3'] = substation_load_df['S3'] * 1.0001
#         substation_load_df['eS4'] = substation_load_df['S4'] * 1.0001
#         substation_load_df['eS5'] = substation_load_df['S5'] * 1.0001
#         substation_load_df['eS6'] = substation_load_df['S6'] * 1.0001
#         substation_load_df['eS7'] = substation_load_df['S7'] * 1.0001
#         substation_load_df['eS8'] = substation_load_df['S8'] * 1.0001
#         substation_load_df = substation_load_df[substation_load_df['Hour'] != 0]
#         substation_load_df = substation_load_df.fillna(0)
#         substation_load_df['eTotal'] = substation_load_df['eS1'] + substation_load_df['eS2'] + substation_load_df[
#             'eS3'] + substation_load_df['eS4'] + substation_load_df['eS5'] + substation_load_df['eS6'] + \
#                                        substation_load_df['eS7'] + substation_load_df['eS8']

#         substation_load_df.to_csv(file_loc + 'station_load.csv', index=False)
#         print("Substation data queried and saved to CSV.")

#     except Exception as e:
#         print(e)

def query_substation_data():
    try:
        # Create SQLAlchemy engine
        engine = create_engine('mysql+mysqlconnector://alyssa:rMuG%23H781Hi~@122.55.198.213/mepcadmi_empower')

        query = (
            "SELECT substation, feeder_no, date_entered, time_entered, load_kw, meter_reading, main_meter "
            "FROM mepcadmi_empower.substation_load WHERE date_entered = '{}' "
        ).format(current_day.strftime('%Y-%m-%d'))

        # Querying the substation load data
        substation_load_df = pd.read_sql(query, engine, parse_dates={"date_entered": {"format": "%d/%m/%y"}})
        substation_load_df = substation_load_df.sort_values(by=['date_entered', 'time_entered'])

        # Pivot the data to get each substation's load_kw in separate columns
        substation_load_df = pd.pivot_table(substation_load_df, values='load_kw',
                                            index=['date_entered', 'time_entered'], columns='substation',
                                            aggfunc='sum')

        # Ensuring that missing substations are added with a default value of 0
        substations = ['LAPAZ SUBSTATION', 'JARO SUBSTATION', 'MANDURRIAO SUBSTATION', 'MOLO SUBSTATION',
                       'DIVERSION SUBSTATION', '10 MVA Mobile SS - MS1', '36 MVA Mobile SS - MS2',
                       '36 MVA Megaworld SS - MGW']
        
        # Add any missing substation columns with 0 values
        for substation in substations:
            if substation not in substation_load_df.columns:
                substation_load_df[substation] = 0

        # Reordering columns to match the order specified
        substation_load_df = substation_load_df[[
            'LAPAZ SUBSTATION', 'JARO SUBSTATION', 'MANDURRIAO SUBSTATION', 'MOLO SUBSTATION',
            'DIVERSION SUBSTATION', '10 MVA Mobile SS - MS1', '36 MVA Mobile SS - MS2', '36 MVA Megaworld SS - MGW']]

        # Reset index to have 'Date' and 'Hour' as columns
        substation_load_df = substation_load_df.reset_index()

        # Rename columns for consistency
        substation_load_df.columns = ['Date', 'Hour', 'S1', 'S2', 'S3', 'S4', 'S5', 'S6', 'S7', 'S8']
        
        # Fill any remaining NaN values with 0
        substation_load_df.fillna(0, inplace=True)

        # Calculate total load and adjusted load for each substation
        substation_load_df['Total'] = substation_load_df['S1'] + substation_load_df['S2'] + substation_load_df['S3'] + \
                                      substation_load_df['S4'] + substation_load_df['S5'] + substation_load_df['S6'] + \
                                      substation_load_df['S7'] + substation_load_df['S8']
        substation_load_df['eS1'] = substation_load_df['S1'] * 1.0001
        substation_load_df['eS2'] = substation_load_df['S2'] * 1.0001
        substation_load_df['eS3'] = substation_load_df['S3'] * 1.0001
        substation_load_df['eS4'] = substation_load_df['S4'] * 1.0001
        substation_load_df['eS5'] = substation_load_df['S5'] * 1.0001
        substation_load_df['eS6'] = substation_load_df['S6'] * 1.0001
        substation_load_df['eS7'] = substation_load_df['S7'] * 1.0001
        substation_load_df['eS8'] = substation_load_df['S8'] * 1.0001

        # Exclude rows where Hour is 0
        substation_load_df = substation_load_df[substation_load_df['Hour'] != 0]
        
        # Refill any remaining NaN values (if any) with 0
        substation_load_df = substation_load_df.fillna(0)

        # Calculate total adjusted load
        substation_load_df['eTotal'] = substation_load_df['eS1'] + substation_load_df['eS2'] + substation_load_df[
            'eS3'] + substation_load_df['eS4'] + substation_load_df['eS5'] + substation_load_df['eS6'] + \
                                       substation_load_df['eS7'] + substation_load_df['eS8']

        # Save the result to a CSV file
        substation_load_df.to_csv('station_load.csv', index=False)
        print("Substation data queried and saved to CSV.")

    except Exception as e:
        print(f"Error: {e}")

def get_current_hour_tsl():
    now = datetime.now()
    current_hour = now.hour
    if current_hour == 0:
        return 24
    return current_hour

def get_total_for_current_hour(excel_file, current_hour):
    try:
        df = pd.read_excel(excel_file, header=None, names=['Date', 'Hour', 'S1', 'S2', 'S3', 'S4', 'S5', 'S6', 'S7', 'S8', 'Total', 'eS1', 'eS2', 'eS3', 'eS4', 'eS5', 'eS6', 'eS7', 'eS8', 'eTotal'], skiprows=1)
        
        if df.empty:
            print("Excel file is empty.")
            return None

        if current_hour not in df['Hour'].values:
            print(f"No data for the current hour: {current_hour}")
            return None

        total_substation_load_value = df.loc[df['Hour'] == current_hour, 'Total'].values[0]
        return float(total_substation_load_value) if pd.notnull(total_substation_load_value) else None
    except Exception as e:
        print(f"Error retrieving total substation load value from Excel: {e}")
        return None
    
def insert_into_mysql_tsl(conn, total_substation_load_value):
    try:
        cursor = conn.cursor()
        sql = "INSERT INTO total_substation_load (substation_load) VALUES (%s)"
        cursor.execute(sql, (total_substation_load_value,))
        conn.commit()
        cursor.close()
        print(f"Value {total_substation_load_value} inserted successfully into MySQL.")
    except mysql.connector.Error as e:
        print(f"Error inserting into MySQL: {e}")
    except Exception as e:
        print(f"Error: {e}")

def main_tsl(excel_file, conn):
    current_hour = get_current_hour_tsl()
    total_substation_load_value = get_total_for_current_hour(excel_file, current_hour)
    if total_substation_load_value is not None:
        insert_into_mysql_tsl(conn, total_substation_load_value)
    else:
        print(f"Invalid total_substation_load_value: {total_substation_load_value}")

def query_run():
    query_substation_data()
    read_file = pd.read_csv('station_load.csv')
    read_file.to_excel('station_load.xlsx', index=False, header=True)
    print("station_load.xlsx updated from station_load.csv.")

def total_substation_load_final_file():
    query_thread = threading.Thread(target=query_run, daemon=True)
    query_thread.start()

    excel_file = 'station_load.xlsx'

    try:
        conn = mysql.connector.connect(
            host='cesra-db.cxkuksua06qz.ap-southeast-1.rds.amazonaws.com',
            database='myDb',
            user='cesra_dbm',
            password='ibIDN0NcnGYo71qDZuHw',
            port=3309
        )

        cursor = conn.cursor()
        cursor.execute("""
            CREATE TABLE IF NOT EXISTS total_substation_load (
                id INT AUTO_INCREMENT PRIMARY KEY,
                substation_load FLOAT(10, 2) NOT NULL,
                insert_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        """)
        cursor.close()

        main_tsl(excel_file, conn)

    except mysql.connector.Error as e:
        print(f"Error connecting to MySQL: {e}")
    except Exception as e:
        print(f"Unexpected error: {e}")
    finally:
        if 'conn' in locals() and conn.is_connected():
            conn.close()
            print("MySQL connection closed.")

# ------ from python actual_energy.py file ------
# File path for destination Excel file
# destination_file_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\actual_energy.xlsx'
destination_file_path = 'actual_energy.xlsx'
# destination_file_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\actual_energy.xlsx'
# Load source workbooks
def load_source_workbooks():
    source_wb = load_workbook('station_load.xlsx')
    source_sheet = source_wb['Sheet1']
    source_wb2 = load_workbook('contestable_energy.xlsx')
    source_sheet2 = source_wb2['Sheet']
    return source_wb, source_sheet, source_wb2, source_sheet2

# Load destination workbook
def load_destination_workbook():
    dest_wb = load_workbook(destination_file_path)
    dest_sheet = dest_wb['Sheet']
    return dest_wb, dest_sheet

# Function to copy values from source to destination
def copy_values_ae(source_sheet, dest_sheet, source_range, dest_range):
    source_start, source_end = source_range
    dest_start, dest_end = dest_range
    source_values = [cell.value for row in source_sheet[source_start:source_end] for cell in row]
    dest_index = 0
    for row in dest_sheet[dest_start:dest_end]:
        for cell in row:
            if dest_index < len(source_values):
                cell.value = source_values[dest_index]
                dest_index += 1
            else:
                break

# Function to copy values from source to destination (for contestable energy)
def copy_values2_ae(source_sheet2, dest_sheet, source_range2, dest_range2):
    source_start2, source_end2 = source_range2
    dest_start2, dest_end2 = dest_range2
    source_values2 = [cell2.value for row2 in source_sheet2[source_start2:source_end2] for cell2 in row2]
    dest_index2 = 0
    for row2 in dest_sheet[dest_start2:dest_end2]:
        for cell2 in row2:
            if dest_index2 < len(source_values2):
                cell2.value = source_values2[dest_index2]
                dest_index2 += 1
            else:
                break

# Retrieve the previous Actual Energy value
def get_previous_ae_value(dest_sheet, current_hour):
    for row in dest_sheet.iter_rows(min_row=2, max_row=25, min_col=1, max_col=4):
        if row[0].value == current_hour:
            return row[3].value
    return None

# Calculate Actual Energy and update the destination sheet
def calculate_actual_energy(dest_sheet):
    for row in dest_sheet.iter_rows(min_row=2, max_row=25, min_col=2, max_col=4):
        total_substation_load = row[0].value
        contestable_energy = row[1].value
        previous_actual_energy = row[2].value  # This was the previous Actual Energy

        if total_substation_load is not None and contestable_energy is not None:
            actual_energy = total_substation_load - contestable_energy 
            if actual_energy < 0:
                actual_energy = 0
        else:
            actual_energy = previous_actual_energy  # Use the previous Actual Energy if no new data

        dest_sheet.cell(row=row[0].row, column=4).value = actual_energy

# Function to retrieve the current hour in 24-hour format
def get_current_hour_ae():
    now = datetime.now()
    current_hour = now.hour
    if current_hour == 0:
        return 24
    return current_hour

def get_tsl_for_current_hour(excel_file, current_hour):
    try:
        df = pd.read_excel(excel_file, header=None, names=['HOUR', 'TOTAL_SUBSTATION_LOAD', 'CONTESTABLE_ENERGY', 'ACTUAL_ENERGY'], skiprows=1)
        tsl_value = df.loc[df['HOUR'] == current_hour, 'TOTAL_SUBSTATION_LOAD'].values[0]
        return float(tsl_value) if pd.notnull(tsl_value) else None
    except Exception as e:
        print(f"Error retrieving tsl value from Excel: {e}")
        return None

def get_ce_for_current_hour(excel_file, current_hour):
    try:
        df = pd.read_excel(excel_file, header=None, names=['HOUR', 'TOTAL_SUBSTATION_LOAD', 'CONTESTABLE_ENERGY', 'ACTUAL_ENERGY'], skiprows=1)
        ce_value = df.loc[df['HOUR'] == current_hour, 'CONTESTABLE_ENERGY'].values[0]
        return float(ce_value) if pd.notnull(ce_value) else None
    except Exception as e:
        print(f"Error retrieving ce value from Excel: {e}")
        return None
    
def get_ae_for_current_hour(excel_file, current_hour):
    try:
        tsl_value = get_tsl_for_current_hour(excel_file, current_hour)
        ce_value = get_ce_for_current_hour(excel_file, current_hour)
        if tsl_value is not None and ce_value is not None:
            ae_value = tsl_value - ce_value 
            if ae_value < 0:
                ae_value = 0
            return ae_value
        else:
            return None
    except Exception as e:
        print(f"Error calculating ae value: {e}")
        return None
    
# Function to insert value into MySQL database
def insert_into_mysql_ae(conn, ae_value):
    try:
        cursor = conn.cursor()
        sql = "INSERT INTO actual_energy (actual_energy) VALUES (%s)"
        cursor.execute(sql, (ae_value,))
        conn.commit()
        cursor.close()
        print(f"Value {ae_value} inserted successfully into MySQL.")
    except mysql.connector.Error as e:
        print(f"Error inserting into MySQL: {e}")
    except Exception as e:
        print(f"Error: {e}")

# Main function to run the script
def main_ae(excel_file, conn):
    previous_ae_value = None
    
    # Load workbooks and sheets
    source_wb, source_sheet, source_wb2, source_sheet2 = load_source_workbooks()
    dest_wb, dest_sheet = load_destination_workbook()

    # Define ranges and copy data
    source_ranges = [('K2', 'K25')]
    dest_ranges = [('B2', 'B25')]
    source_ranges2 = [('A2', 'A25'), ('B2', 'B25')]
    dest_ranges2 = [('A2', 'A25'), ('C2', 'C25')]

    for i in range(len(source_ranges)):
        copy_values_ae(source_sheet, dest_sheet, source_ranges[i], dest_ranges[i])

    for i in range(len(source_ranges2)):
        copy_values2_ae(source_sheet2, dest_sheet, source_ranges2[i], dest_ranges2[i])

    # Calculate Actual Energy
    calculate_actual_energy(dest_sheet)

    # Save the updated destination workbook
    dest_wb.save(destination_file_path)

    # Retrieve and insert the current hour's data into MySQL
    current_hour = get_current_hour_ae()
    ae_value = get_ae_for_current_hour(destination_file_path, current_hour)
    if ae_value is not None:
        insert_into_mysql_ae(conn, ae_value)
        previous_ae_value = ae_value
    else:
        # Insert previous value if current AE value is None
        if previous_ae_value is not None:
            insert_into_mysql_ae(conn, previous_ae_value)

    # Close workbooks
    source_wb.close()
    dest_wb.close()
    source_wb2.close()

def actual_energy_file():
    # while True:
    excel_file = destination_file_path

    conn = mysql.connector.connect(
        host='cesra-db.cxkuksua06qz.ap-southeast-1.rds.amazonaws.com',
        database='myDb',
        user='cesra_dbm',
        password='ibIDN0NcnGYo71qDZuHw',
        port=3309
    )

    # Create MySQL table if it doesn't exist
    cursor = conn.cursor()
    cursor.execute("""
        CREATE TABLE IF NOT EXISTS actual_energy (
            id INT AUTO_INCREMENT PRIMARY KEY,
            actual_energy FLOAT(10, 2) NOT NULL,
            insert_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        )
    """)
    cursor.close()

    # Run main function to continuously check and update database
    main_ae(excel_file, conn)

# ------ from wesm_exposure.py file ------
# Function to copy values from source range to destination range
def copy_values_we(source_sheet, dest_sheet, source_range, dest_range):
    source_start, source_end = source_range
    dest_start, dest_end = dest_range

    # Copy values from source to destination
    source_values = []
    for row in source_sheet[source_start:source_end]:
        for cell in row:
            source_values.append(cell.value)
    dest_index = 0
    for row in dest_sheet[dest_start:dest_end]:
        for cell in row:
            if dest_index < len(source_values):
                cell.value = source_values[dest_index]
                dest_index += 1
            else:
                break

# Function to copy values from source range to destination range (for contestable energy)
def copy_values2_we(source_sheet2, dest_sheet, source_range2, dest_range2):
    source_start2, source_end2 = source_range2
    dest_start2, dest_end2 = dest_range2

    # Copy values from source to destination
    source_values2 = []
    for row2 in source_sheet2[source_start2:source_end2]:
        for cell2 in row2:
            source_values2.append(cell2.value)
    dest_index2 = 0
    for row2 in dest_sheet[dest_start2:dest_end2]:
        for cell2 in row2:
            if dest_index2 < len(source_values2):
                cell2.value = source_values2[dest_index2]
                dest_index2 += 1
            else:
                break

# Function to copy values from source range to destination range (for contestable energy)
def copy_values3_we(source_sheet3, dest_sheet, source_range3, dest_range3):
    source_start3, source_end3 = source_range3
    dest_start3, dest_end3 = dest_range3

    # Copy values from source to destination
    source_values3 = []
    for row3 in source_sheet3[source_start3:source_end3]:
        for cell3 in row3:
            source_values3.append(cell3.value)
    dest_index3 = 0
    for row3 in dest_sheet[dest_start3:dest_end3]:
        for cell3 in row3:
            if dest_index3 < len(source_values3):
                cell3.value = source_values3[dest_index3]
                dest_index3 += 1
            else:
                break

def wesm_exposure_we():
    # For creating an Excel file 
    workbook = openpyxl.Workbook()
    sheet = workbook.active
    sheet['A1'] = 'HOUR'
    sheet['B1'] = 'ACTUAL_ENERGY'
    # sheet['C1'] = 'CONTESTABLE_ENERGY'
    sheet['C1'] = 'TOTAL_BCQ_NOMINATION'
    sheet['D1'] = 'WESM_EXPOSURE'  
    workbook.save('wesm_exposure.xlsx')
    workbook.close()
    print("Excel file 'wesm_exposure.xlsx' created successfully.")

    # File path for destination Excel file
    # destination_file_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\wesm_exposure.xlsx'
    destination_file_path = 'wesm_exposure.xlsx'
    # destination_file_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\wesm_exposure.xlsx'
    # Load source workbooks
    source_wb = load_workbook('actual_energy.xlsx')
    source_sheet = source_wb['Sheet']
    # source_wb3 = load_workbook('contestable_energy.xlsx')
    # source_sheet3 = source_wb3['Sheet']
    source_wb2 = load_workbook('total_bcq_nomination.xlsx')
    source_sheet2 = source_wb2['Sheet']

    # Load destination workbook
    dest_wb = load_workbook(destination_file_path)
    dest_sheet = dest_wb['Sheet']

    # Define source and destination ranges

    # Hour and Actual Energy
    source_ranges = [('A2', 'A25'), ('D2', 'D25')]
    dest_ranges = [('A2', 'A25'), ('B2', 'B25')]

    # # Contestable Energy
    # source_ranges3 = [('B2', 'B25')]
    # dest_ranges3 = [('C2', 'C25')]
    # Total BCQ Nomination
    source_ranges2 = [('F2', 'F25')]
    dest_ranges2 = [('C2', 'C25')]

    # Copy data from source to destination based on specified ranges
    for i in range(len(source_ranges)):
        copy_values_we(source_sheet, dest_sheet, source_ranges[i], dest_ranges[i])

    for i in range(len(source_ranges2)):
        copy_values2_we(source_sheet2, dest_sheet, source_ranges2[i], dest_ranges2[i])

    # for i in range(len(source_ranges3)):
    #     copy_values3_we(source_sheet3, dest_sheet, source_ranges3[i], dest_ranges3[i])

    for row in dest_sheet.iter_rows(min_row=2, max_row=25, min_col=2, max_col=3):
        actual_energy = row[0].value
        # contestable_energy = row[1].value
        total_bcq_nomination = row[1].value
        wesm_exposure = actual_energy - total_bcq_nomination if actual_energy and total_bcq_nomination else None
        dest_sheet.cell(row=row[0].row, column=4).value = wesm_exposure

    # Save the destination workbook
    dest_wb.save(destination_file_path)
    # Close workbooks
    source_wb.close()
    dest_wb.close()
    # source_wb3.close()
    source_wb2.close()
    print("Data transfer completed.")

# Function to retrieve the current hour in 24-hour format
def get_current_hour_we():
    now = datetime.now()
    current_hour = now.hour
    if current_hour == 0:
        return 24
    return current_hour

def get_actual_energy_for_current_hour(excel_file, current_hour):
    try:
        df = pd.read_excel(excel_file, header=None, names=['HOUR', 'ACTUAL_ENERGY', 'TOTAL_BCQ_NOMINATION', 'WESM_EXPOSURE'], skiprows=1)
        actual_energy_value = df.loc[df['HOUR'] == current_hour, 'ACTUAL_ENERGY'].values[0]
        return float(actual_energy_value) if pd.notnull(actual_energy_value) else None
    except Exception as e:
        print(f"Error retrieving actual energy value from Excel: {e}")
        return None
    
# def get_contestable_energy_for_current_hour(excel_file, current_hour):
#     try:
#         df = pd.read_excel(excel_file, header=None, names=['HOUR', 'ACTUAL_ENERGY', 'TOTAL_BCQ_NOMINATION', 'CONTESTABLE_ENERGY', 'WESM_EXPOSURE'], skiprows=1)
#         contestable_energy_value = df.loc[df['HOUR'] == current_hour, 'CONTESTABLE_ENERGY'].values[0]
#         return float(contestable_energy_value) if pd.notnull(contestable_energy_value) else None
#     except Exception as e:
#         print(f"Error retrieving contestable energy value from Excel: {e}")
#         return None
    
def get_total_bcq_nomination_for_current_hour(excel_file, current_hour):
    try:
        df = pd.read_excel(excel_file, header=None, names=['HOUR', 'ACTUAL_ENERGY', 'TOTAL_BCQ_NOMINATION', 'WESM_EXPOSURE'], skiprows=1)
        total_bcq_nomination_value = df.loc[df['HOUR'] == current_hour, 'TOTAL_BCQ_NOMINATION'].values[0]
        return float(total_bcq_nomination_value) if pd.notnull(total_bcq_nomination_value) else None
    except Exception as e:
        print(f"Error retrieving total bcq nomination value from Excel: {e}")
        return None
    
def get_wesm_exposure_for_current_hour(excel_file, current_hour):
    try:
        actual_energy_value = get_actual_energy_for_current_hour(excel_file, current_hour)
        total_bcq_nomination_value = get_total_bcq_nomination_for_current_hour(excel_file, current_hour)

        wesm_exposure_value = actual_energy_value - total_bcq_nomination_value if actual_energy_value is not None and total_bcq_nomination_value is not None else None
        return wesm_exposure_value
    except Exception as e:
        print(f"Error calculating wesm exposure value: {e}")
        return None

# Function to insert value into MySQL database
def insert_into_mysql_we(conn, wesm_exposure_value):
    try:
        cursor = conn.cursor()
        sql = "INSERT INTO wesm_exposure (wesm_exposure) VALUES (%s)"
        cursor.execute(sql, (wesm_exposure_value,))
        conn.commit()  # Commit the transaction
        cursor.close()
        print(f"Value {wesm_exposure_value} inserted successfully into MySQL.")
    except mysql.connector.Error as e:
        print(f"Error inserting into MySQL: {e}")
    except Exception as e:
        print(f"Error: {e}")

# Main function to run the script
def main_we(excel_file, conn):
    # while True:
        # try:
    wesm_exposure_we()
    current_hour = get_current_hour_we()
    wesm_exposure_value = get_wesm_exposure_for_current_hour(excel_file, current_hour)
    if wesm_exposure_value is not None:
        insert_into_mysql_we(conn, wesm_exposure_value)
    else:
        insert_into_mysql_we(conn, wesm_exposure_value)
    # Delay for 800 seconds before checking again
    #time.sleep(800)
        

def wesm_exposure_file():
    # while True:
    # excel_file = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\wesm_exposure.xlsx'
    excel_file = 'wesm_exposure.xlsx'
    # excel_file = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\wesm_exposure.xlsx'
    conn = mysql.connector.connect(
        host='cesra-db.cxkuksua06qz.ap-southeast-1.rds.amazonaws.com',
        database='myDb',
        user='cesra_dbm',
        password='ibIDN0NcnGYo71qDZuHw',
        port=3309
    )

    # Create MySQL table if it doesn't exist
    cursor = conn.cursor()
    cursor.execute("""
        CREATE TABLE IF NOT EXISTS wesm_exposure (
            id INT AUTO_INCREMENT PRIMARY KEY,
            wesm_exposure FLOAT(10, 2) NOT NULL,
            insert_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        )
    """)
    cursor.close()

    # Run main function to continuously check and update database
    main_we(excel_file, conn)

# ------ from current_rate.py file ------
# Function to copy values from source range to destination range
def copy_values_cr(source_sheet, dest_sheet, source_range, dest_range):
    source_start, source_end = source_range
    dest_start, dest_end = dest_range
    
    # Copy values from source to destination
    source_values = []
    for row in source_sheet[source_start:source_end]:
        for cell in row:
            source_values.append(cell.value)
    
    dest_index = 0
    for row in dest_sheet[dest_start:dest_end]:
        for cell in row:
            if dest_index < len(source_values):
                cell.value = source_values[dest_index]
                dest_index += 1
            else:
                break

def initial_function():
    # # Rates - Supplier Rates for the Month_July 2024
    # # Defining the base directory
    # base_directory_1 = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\MORE Energy Sourcing\013. Rate Analysis\005. 2024 Rate Analysis"

    # # Getting the current month and year
    # current_date = datetime.now()
    # current_month_numeric = current_date.strftime("%m")  # Month in numeric format (e.g., '01' for January)
    # current_month_name = current_date.strftime("%B")   # Full month name (e.g., 'January')
    # current_day = current_date.strftime("%d") # Day in numeric format (e.g., '26')
    # current_year = current_date.strftime("%Y")   # Year in 4-digit format (e.g., '2024')

    # #List of all month names
    # months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]
    # #Find index of current month
    # current_month_index = months.index(current_month_name)

    # # Initialize current_month_numeric_increment
    # current_month_numeric_increment = current_month_numeric # Default to current month if condition not met

    # if (current_day > '25') and (current_date.strftime("%m") == current_month_numeric):
    #     #Increment current month by converting to integer, adding 1, and formatting back to zero-padded string
    #     current_month_numeric_increment = '{:02d}'.format((int(current_month_numeric) % 12) + 1)
    #     #Calculate index of next month
    #     next_month_index = (current_month_index + 1) % 12
    #     current_month_name = months[next_month_index]

    # # Constructing the folder name
    # folder_prefix = current_month_numeric_increment.zfill(3)  # Zero-padded three-digit month number (e.g., '006' for June)
    # folder_name = f"{folder_prefix}. {current_month_name} {current_year}"

    # # Constructing the directory path
    # folder_path = os.path.join(base_directory_1, folder_name)

    # # Additional needed variables for the folder name
    # drs = "Daily Rate Simulation_"
    # extension = ".xlsx"

    # # Folder name (Example: Daily Rate Simulation_06252024) 
    # folder_name_2 = f"{drs}{current_month_numeric}{current_day}{current_year}{extension}"
    # folder_path_2 = os.path.join(folder_path, folder_name_2)

    # base_directory = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\01_Energy Sourcing Files\03_Daily Reports\01_Day Ahead Projections"
    # base_directory = r'01_Energy Sourcing Files\03_Daily Reports\01_Day Ahead Projections'
    base_directory = os.path.join('01_Energy Sourcing Files', '03_Daily Reports', '01_Day Ahead Projections')
    # base_directory = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\01_Energy Sourcing Files\03_Daily Reports\01_Day Ahead Projections"
    current_date = datetime.now()
    current_month_numeric = current_date.strftime("%m")
    current_month_name = current_date.strftime("%B")
    current_day = int(current_date.strftime("%d"))
    current_year = current_date.strftime("%Y")
    current_day_not_int = current_date.strftime("%d")

    check_current_month = current_date.strftime("%B")
    # If the current month is December, increment the year
    if check_current_month == "December" and current_day > 25:
        year_to_be_used = str(int(current_year) + 1)
    # Otherwise, use the current year
    else: 
        year_to_be_used = current_date.strftime("%Y")

    folder_path = os.path.join(base_directory, year_to_be_used)
    
    #List of all month names
    months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]
    #Find index of current month
    current_month_index = months.index(current_month_name)

    # if (current_day>'25') and (current_date.strftime("%m") == current_month_numeric):
    #     #Increment current month by converting to integer, adding 1, and formatting back to zero-padded string
    #     current_month_numeric_increment = '{:02d}'.format((int(current_month_numeric) % 12) + 1)
    #     # Calculate index of next month
    #     next_month_index = (current_month_index + 1) % 12
    #     current_month_name = months[next_month_index]
    # elif(current_day<='25') and (current_date.strftime("%m")==current_month_numeric):
    #     current_month_numeric_increment = current_month_numeric

    # Check if the day is past the 25th of the current month
    if current_day > 25 :
        # If it's past the 25th, increment the month
        next_month_index = (current_month_index + 1) % 12 # This handles the rollover from December to January
        current_month_name = months[next_month_index]
        # Set the numeric month increment (for the next month), ensuring 3-digit format 
        current_month_numeric_increment = f'{(int(current_month_numeric) % 12) + 1:03d}'
    else:
        # If it's before or on the 25th, don't change the month
        current_month_numeric_increment = f'{int(current_month_numeric):03d}'

    # Construct the folder name
    folder_name = f"{current_month_numeric_increment}. {current_month_name} {year_to_be_used}"

    # Constructing the directory path
    folder_path_2 = os.path.join(folder_path, folder_name)

    # Additional needed variables for the folder name
    drs = "Daily Rate Simulation_"
    extension = ".xlsx"

    # Folder Name (Example: Daily Rate Simulation_06252024) 

    folder_name_2 = f"{drs}{current_month_numeric}{current_day_not_int}{current_year}{extension}"
    folder_path_3 = os.path.join(folder_path_2, folder_name_2)
    
    # For creating a new Excel file with the needed columns
    workbook = openpyxl.Workbook()
    sheet = workbook.active
    sheet['A1'] = 'HOUR' 
    sheet['B1'] = 'BCQ_SCPC' 
    sheet['C1'] = 'RATE_SCPC_B1_FIXED_FEE' 
    sheet['D1'] = 'RATE_SCPC_B1_VARIABLE_FEE'
    sheet['E1'] = 'RATE_SCPC_B2_FIXED_FEE' 
    sheet['F1'] = 'RATE_SCPC_B2_VARIABLE_FEE'
    sheet['G1'] = 'RATE_SCPC_AVE_FIXED_FEE' 
    sheet['H1'] = 'RATE_SCPC_AVE_VARIABLE_FEE'
    sheet['I1'] = 'BCQ_KSPC' 
    sheet['J1'] = 'RATE_KSPC_B1_FIXED_FEE' 
    sheet['K1'] = 'RATE_KSPC_B1_VARIABLE_FEE'
    sheet['L1'] = 'RATE_KSPC_B2_FIXED_FEE' 
    sheet['M1'] = 'RATE_KSPC_B2_VARIABLE_FEE'
    sheet['N1'] = 'RATE_KSPC_AVE_FIXED_FEE' 
    sheet['O1'] = 'RATE_KSPC_AVE_VARIABLE_FEE'
    sheet['P1'] = 'BCQ_EDC' 
    sheet['Q1'] = 'RATE_EDC_FIXED_FEE' 
    sheet['R1'] = 'RATE_EDC_VARIABLE_FEE'
    sheet['S1'] = 'TOTAL_SS_LOAD' 
    sheet['T1'] = 'CONTESTABLE_ENERGY'
    sheet['U1'] = 'TOTAL_BCQ' 
    sheet['V1'] = 'WESM_RATE'
    sheet['W1'] = 'CURRENT_RATE'
    sheet['X1'] = 'BCQ_PEDC'
    sheet['Y1'] = 'RATE_PEDC_FIXED_FEE'
    sheet['Z1'] = 'RATE_PEDC_VARIABLE_FEE'

    workbook.save('current_rate.xlsx')
    workbook.close()
    print("Excel file 'current_rate.xlsx' created successfully.")

    # File path for destination Excel file
    # destination_file_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\current_rate.xlsx'
    destination_file_path = 'current_rate.xlsx'
    # destination_file_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\current_rate.xlsx'
    # Load source workbook
    source_wb = load_workbook(folder_path_3, data_only=True)  # Use data_only=True to get values instead of formulas
    # Sheet name of the source workbook
    source_sheet = source_wb['6. DAP Report']

    # Load destination workbook
    dest_wb = load_workbook(destination_file_path)

    # Sheet name of the destination workbook
    dest_sheet = dest_wb['Sheet']

    # Define source and destination ranges
    source_ranges = [('C11', 'C34'), ('G11', 'G34'), ('H11', 'H34'), ('I11', 'I34'), ('J11', 'J34')]
    dest_ranges = [('A2', 'A25'), ('B2', 'B25'), ('I2', 'I25'), ('P2', 'P25'), ('X2', 'X25')]

    # Copy data from source to destination based on specified ranges
    for i in range(len(source_ranges)):
        copy_values_cr(source_sheet, dest_sheet, source_ranges[i], dest_ranges[i])

    # Save the destination workbook
    dest_wb.save(destination_file_path)

    # Close workbooks
    source_wb.close()
    dest_wb.close()
    print("Data transfer completed.")

    # 1st Hour
    value_B2 = dest_sheet['B2'].value
    value_I2 = dest_sheet['I2'].value
    value_P2 = dest_sheet['P2'].value
    value_X2 = dest_sheet['X2'].value

    result2 = value_B2 + value_I2 + value_P2 + value_X2
    dest_sheet['U2'] = result2

    # 2nd Hour
    value_B3 = dest_sheet['B3'].value
    value_I3 = dest_sheet['I3'].value
    value_P3 = dest_sheet['P3'].value
    value_X3 = dest_sheet['X3'].value

    result3 = value_B3 + value_I3 + value_P3 + value_X3
    dest_sheet['U3'] = result3

    # 3rd Hour
    value_B4 = dest_sheet['B4'].value
    value_I4 = dest_sheet['I4'].value
    value_P4 = dest_sheet['P4'].value
    value_X4 = dest_sheet['X4'].value

    result4 = value_B4 + value_I4 + value_P4 + value_X4
    dest_sheet['U4'] = result4

    # 4th Hour
    value_B5 = dest_sheet['B5'].value
    value_I5 = dest_sheet['I5'].value
    value_P5 = dest_sheet['P5'].value
    value_X5 = dest_sheet['X5'].value

    result5 = value_B5 + value_I5 + value_P5 + value_X5
    dest_sheet['U5'] = result5

    # 5th Hour
    value_B6 = dest_sheet['B6'].value
    value_I6 = dest_sheet['I6'].value
    value_P6 = dest_sheet['P6'].value
    value_X6 = dest_sheet['X6'].value

    result6 = value_B6 + value_I6 + value_P6 + value_X6
    dest_sheet['U6'] = result6

    # 6th Hour
    value_B7 = dest_sheet['B7'].value
    value_I7 = dest_sheet['I7'].value
    value_P7 = dest_sheet['P7'].value
    value_X7 = dest_sheet['X7'].value

    result7 = value_B7 + value_I7 + value_P7 + value_X7
    dest_sheet['U7'] = result7

    # 7th Hour
    value_B8 = dest_sheet['B8'].value
    value_I8 = dest_sheet['I8'].value
    value_P8 = dest_sheet['P8'].value
    value_X8 = dest_sheet['X8'].value

    result8 = value_B8 + value_I8 + value_P8 + value_X8
    dest_sheet['U8'] = result8

    # 8th Hour
    value_B9 = dest_sheet['B9'].value
    value_I9 = dest_sheet['I9'].value
    value_P9 = dest_sheet['P9'].value
    value_X9 = dest_sheet['X9'].value

    result9 = value_B9 + value_I9 + value_P9 + value_X9
    dest_sheet['U9'] = result9

    # 9th Hour
    value_B10 = dest_sheet['B10'].value
    value_I10 = dest_sheet['I10'].value
    value_P10 = dest_sheet['P10'].value
    value_X10 = dest_sheet['X10'].value

    result10 = value_B10 + value_I10 + value_P10 + value_X10
    dest_sheet['U10'] = result10

    # 10th Hour
    value_B11 = dest_sheet['B11'].value
    value_I11 = dest_sheet['I11'].value
    value_P11 = dest_sheet['P11'].value
    value_X11 = dest_sheet['X11'].value

    result11 = value_B11 + value_I11 + value_P11 + value_X11
    dest_sheet['U11'] = result11

    # 11th Hour
    value_B12 = dest_sheet['B12'].value
    value_I12 = dest_sheet['I12'].value
    value_P12 = dest_sheet['P12'].value
    value_X12 = dest_sheet['X12'].value

    result12 = value_B12 + value_I12 + value_P12 + value_X12
    dest_sheet['U12'] = result12

    # 12th Hour
    value_B13 = dest_sheet['B13'].value
    value_I13 = dest_sheet['I13'].value
    value_P13 = dest_sheet['P13'].value
    value_X13 = dest_sheet['X13'].value

    result13 = value_B13 + value_I13 + value_P13 + value_X13
    dest_sheet['U13'] = result13

    # 13th Hour
    value_B14 = dest_sheet['B14'].value
    value_I14 = dest_sheet['I14'].value
    value_P14 = dest_sheet['P14'].value
    value_X14 = dest_sheet['X14'].value

    result14 = value_B14 + value_I14 + value_P14 + value_X14
    dest_sheet['U14'] = result14

    # 14th Hour
    value_B15 = dest_sheet['B15'].value
    value_I15 = dest_sheet['I15'].value
    value_P15 = dest_sheet['P15'].value
    value_X15 = dest_sheet['X15'].value

    result15 = value_B15 + value_I15 + value_P15 + value_X15
    dest_sheet['U15'] = result15

    # 15th Hour
    value_B16 = dest_sheet['B16'].value
    value_I16 = dest_sheet['I16'].value
    value_P16 = dest_sheet['P16'].value
    value_X16 = dest_sheet['X16'].value

    result16 = value_B16 + value_I16 + value_P16 + value_X16
    dest_sheet['U16'] = result16

    # 16th Hour
    value_B17 = dest_sheet['B17'].value
    value_I17 = dest_sheet['I17'].value
    value_P17 = dest_sheet['P17'].value
    value_X17 = dest_sheet['X17'].value

    result17 = value_B17 + value_I17 + value_P17 + value_X17
    dest_sheet['U17'] = result17

    # 17th Hour
    value_B18 = dest_sheet['B18'].value
    value_I18 = dest_sheet['I18'].value
    value_P18 = dest_sheet['P18'].value
    value_X18 = dest_sheet['X18'].value

    result18 = value_B18 + value_I18 + value_P18 + value_X18
    dest_sheet['U18'] = result18

    # 18th Hour
    value_B19 = dest_sheet['B19'].value
    value_I19 = dest_sheet['I19'].value
    value_P19 = dest_sheet['P19'].value
    value_X19 = dest_sheet['X19'].value

    result19 = value_B19 + value_I19 + value_P19 + value_X19
    dest_sheet['U19'] = result19

    # 19th Hour
    value_B20 = dest_sheet['B20'].value
    value_I20 = dest_sheet['I20'].value
    value_P20 = dest_sheet['P20'].value
    value_X20 = dest_sheet['X20'].value

    result20 = value_B20 + value_I20 + value_P20 + value_X20
    dest_sheet['U20'] = result20

    # 20th Hour
    value_B21 = dest_sheet['B21'].value
    value_I21 = dest_sheet['I21'].value
    value_P21 = dest_sheet['P21'].value
    value_X21 = dest_sheet['X21'].value

    result21 = value_B21 + value_I21 + value_P21 + value_X21
    dest_sheet['U21'] = result21

    # 21th Hour
    value_B22 = dest_sheet['B22'].value
    value_I22 = dest_sheet['I22'].value
    value_P22 = dest_sheet['P22'].value
    value_X22 = dest_sheet['X22'].value

    result22 = value_B22 + value_I22 + value_P22 + value_X22
    dest_sheet['U22'] = result22

    # 22th Hour
    value_B23 = dest_sheet['B23'].value
    value_I23 = dest_sheet['I23'].value
    value_P23 = dest_sheet['P23'].value
    value_X23 = dest_sheet['X23'].value

    result23 = value_B23 + value_I23 + value_P23 + value_X23
    dest_sheet['U23'] = result23

    # 23rd Hour
    value_B24 = dest_sheet['B24'].value
    value_I24 = dest_sheet['I24'].value
    value_P24 = dest_sheet['P24'].value
    value_X24 = dest_sheet['X24'].value

    result24 = value_B24 + value_I24 + value_P24 + value_X24
    dest_sheet['U24'] = result24

    # 24th Hour
    value_B25 = dest_sheet['B25'].value
    value_I25 = dest_sheet['I25'].value
    value_P25 = dest_sheet['P25'].value
    value_X25 = dest_sheet['X25'].value

    result25 = value_B25 + value_I25 + value_P25 + value_X25
    dest_sheet['U25'] = result25

    # Save the workbook back to file
    dest_wb.save(destination_file_path)

    # Example: Supplier Rates for the Month_August 2024
    srftm = "Supplier Rates for the Month_"
    date_currently = datetime.now()
    day_today = date_currently.strftime("%d")
    if day_today < '26':
        month_var = date_currently.strftime("%B") # Example: "August"
    else:
        next_month_date = date_currently.replace(day=1) + timedelta(days=32)
        month_var = calendar.month_name[next_month_date.month] # Example: "September"
    
    check_current_month = current_date.strftime("%B")
    # If the current month is December, increment the year
    if check_current_month == "December" and current_day > 25:
        year_to_be_used = str(int(current_year) + 1)
    # Otherwise, use the current year
    else: 
        year_to_be_used = current_date.strftime("%Y")

    extension = ".xlsx"
    supplier_rates_folder = f"{srftm}{month_var} {year_to_be_used}{extension}"
    supplier_rates_path = os.path.join(folder_path_2, supplier_rates_folder)

    # File path for destination Excel file
    # destination_file_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\current_rate.xlsx'
    destination_file_path = 'current_rate.xlsx'
    # destination_file_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\current_rate.xlsx'
    # Load source workbook
    source_wb_sup = load_workbook(supplier_rates_path, data_only=True)  # Use data_only=True to get values instead of formulas
    # Sheet name of the source workbook
    source_sheet_sup = source_wb_sup['RATES']

    # Load destination workbook
    dest_wb = load_workbook(destination_file_path)

    # Sheet name of the destination workbook
    dest_sheet = dest_wb['Sheet']

    scpc_b1_fixed_fee = source_sheet_sup['C17'].value
    scpc_b1_variable_fee = source_sheet_sup['C18'].value
    scpc_b2_fixed_fee = source_sheet_sup['D17'].value
    scpc_b2_variable_fee = source_sheet_sup['D18'].value
    kspc_b1_fixed_fee = source_sheet_sup['E17'].value
    kspc_b1_variable_fee = source_sheet_sup['E18'].value
    kspc_b2_fixed_fee = source_sheet_sup['F17'].value
    kspc_b2_variable_fee = source_sheet_sup['F18'].value
    edc_fixed_fee = source_sheet_sup['G17'].value
    edc_variable_fee = source_sheet_sup['G18'].value
    pedc_fixed_fee = source_sheet_sup['H17'].value
    pedc_variable_fee = source_sheet_sup['H18'].value
    
    dest_sheet['C2'].value = scpc_b1_fixed_fee
    dest_sheet['C3'].value = scpc_b1_fixed_fee
    dest_sheet['C4'].value = scpc_b1_fixed_fee
    dest_sheet['C5'].value = scpc_b1_fixed_fee
    dest_sheet['C6'].value = scpc_b1_fixed_fee
    dest_sheet['C7'].value = scpc_b1_fixed_fee
    dest_sheet['C8'].value = scpc_b1_fixed_fee
    dest_sheet['C9'].value = scpc_b1_fixed_fee
    dest_sheet['C10'].value = scpc_b1_fixed_fee
    dest_sheet['C11'].value = scpc_b1_fixed_fee
    dest_sheet['C12'].value = scpc_b1_fixed_fee
    dest_sheet['C13'].value = scpc_b1_fixed_fee
    dest_sheet['C14'].value = scpc_b1_fixed_fee
    dest_sheet['C15'].value = scpc_b1_fixed_fee
    dest_sheet['C16'].value = scpc_b1_fixed_fee
    dest_sheet['C17'].value = scpc_b1_fixed_fee
    dest_sheet['C18'].value = scpc_b1_fixed_fee
    dest_sheet['C19'].value = scpc_b1_fixed_fee
    dest_sheet['C20'].value = scpc_b1_fixed_fee
    dest_sheet['C21'].value = scpc_b1_fixed_fee
    dest_sheet['C22'].value = scpc_b1_fixed_fee
    dest_sheet['C23'].value = scpc_b1_fixed_fee
    dest_sheet['C24'].value = scpc_b1_fixed_fee
    dest_sheet['C25'].value = scpc_b1_fixed_fee

    dest_sheet['D2'].value = scpc_b1_variable_fee
    dest_sheet['D3'].value = scpc_b1_variable_fee
    dest_sheet['D4'].value = scpc_b1_variable_fee
    dest_sheet['D5'].value = scpc_b1_variable_fee
    dest_sheet['D6'].value = scpc_b1_variable_fee
    dest_sheet['D7'].value = scpc_b1_variable_fee
    dest_sheet['D8'].value = scpc_b1_variable_fee
    dest_sheet['D9'].value = scpc_b1_variable_fee
    dest_sheet['D10'].value = scpc_b1_variable_fee
    dest_sheet['D11'].value = scpc_b1_variable_fee
    dest_sheet['D12'].value = scpc_b1_variable_fee
    dest_sheet['D13'].value = scpc_b1_variable_fee
    dest_sheet['D14'].value = scpc_b1_variable_fee
    dest_sheet['D15'].value = scpc_b1_variable_fee
    dest_sheet['D16'].value = scpc_b1_variable_fee
    dest_sheet['D17'].value = scpc_b1_variable_fee
    dest_sheet['D18'].value = scpc_b1_variable_fee
    dest_sheet['D19'].value = scpc_b1_variable_fee
    dest_sheet['D20'].value = scpc_b1_variable_fee
    dest_sheet['D21'].value = scpc_b1_variable_fee
    dest_sheet['D22'].value = scpc_b1_variable_fee
    dest_sheet['D23'].value = scpc_b1_variable_fee
    dest_sheet['D24'].value = scpc_b1_variable_fee
    dest_sheet['D25'].value = scpc_b1_variable_fee

    dest_sheet['E2'].value = scpc_b2_fixed_fee
    dest_sheet['E3'].value = scpc_b2_fixed_fee
    dest_sheet['E4'].value = scpc_b2_fixed_fee
    dest_sheet['E5'].value = scpc_b2_fixed_fee
    dest_sheet['E6'].value = scpc_b2_fixed_fee
    dest_sheet['E7'].value = scpc_b2_fixed_fee
    dest_sheet['E8'].value = scpc_b2_fixed_fee
    dest_sheet['E9'].value = scpc_b2_fixed_fee
    dest_sheet['E10'].value = scpc_b2_fixed_fee
    dest_sheet['E11'].value = scpc_b2_fixed_fee
    dest_sheet['E12'].value = scpc_b2_fixed_fee
    dest_sheet['E13'].value = scpc_b2_fixed_fee
    dest_sheet['E14'].value = scpc_b2_fixed_fee
    dest_sheet['E15'].value = scpc_b2_fixed_fee
    dest_sheet['E16'].value = scpc_b2_fixed_fee
    dest_sheet['E17'].value = scpc_b2_fixed_fee
    dest_sheet['E18'].value = scpc_b2_fixed_fee
    dest_sheet['E19'].value = scpc_b2_fixed_fee
    dest_sheet['E20'].value = scpc_b2_fixed_fee
    dest_sheet['E21'].value = scpc_b2_fixed_fee
    dest_sheet['E22'].value = scpc_b2_fixed_fee
    dest_sheet['E23'].value = scpc_b2_fixed_fee
    dest_sheet['E24'].value = scpc_b2_fixed_fee
    dest_sheet['E25'].value = scpc_b2_fixed_fee

    dest_sheet['F2'].value = scpc_b2_variable_fee
    dest_sheet['F3'].value = scpc_b2_variable_fee
    dest_sheet['F4'].value = scpc_b2_variable_fee
    dest_sheet['F5'].value = scpc_b2_variable_fee
    dest_sheet['F6'].value = scpc_b2_variable_fee
    dest_sheet['F7'].value = scpc_b2_variable_fee
    dest_sheet['F8'].value = scpc_b2_variable_fee
    dest_sheet['F9'].value = scpc_b2_variable_fee
    dest_sheet['F10'].value = scpc_b2_variable_fee
    dest_sheet['F11'].value = scpc_b2_variable_fee
    dest_sheet['F12'].value = scpc_b2_variable_fee
    dest_sheet['F13'].value = scpc_b2_variable_fee
    dest_sheet['F14'].value = scpc_b2_variable_fee
    dest_sheet['F15'].value = scpc_b2_variable_fee
    dest_sheet['F16'].value = scpc_b2_variable_fee
    dest_sheet['F17'].value = scpc_b2_variable_fee
    dest_sheet['F18'].value = scpc_b2_variable_fee
    dest_sheet['F19'].value = scpc_b2_variable_fee
    dest_sheet['F20'].value = scpc_b2_variable_fee
    dest_sheet['F21'].value = scpc_b2_variable_fee
    dest_sheet['F22'].value = scpc_b2_variable_fee
    dest_sheet['F23'].value = scpc_b2_variable_fee
    dest_sheet['F24'].value = scpc_b2_variable_fee
    dest_sheet['F25'].value = scpc_b2_variable_fee

    dest_sheet['G2'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G3'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G4'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G5'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G6'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G7'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G8'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G9'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G10'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G11'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G12'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G13'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G14'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G15'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G16'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G17'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G18'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G19'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G20'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G21'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G22'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G23'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G24'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2
    dest_sheet['G25'].value = (scpc_b1_fixed_fee + scpc_b2_fixed_fee)/2

    dest_sheet['H2'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H3'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H4'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H5'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H6'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H7'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H8'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H9'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H10'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H11'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H12'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H13'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H14'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H15'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H16'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H17'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H18'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H19'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H20'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H21'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H22'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H23'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H24'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2
    dest_sheet['H25'].value = (scpc_b1_variable_fee + scpc_b2_variable_fee)/2

    dest_sheet['J2'].value = kspc_b1_fixed_fee
    dest_sheet['J3'].value = kspc_b1_fixed_fee
    dest_sheet['J4'].value = kspc_b1_fixed_fee
    dest_sheet['J5'].value = kspc_b1_fixed_fee
    dest_sheet['J6'].value = kspc_b1_fixed_fee
    dest_sheet['J7'].value = kspc_b1_fixed_fee
    dest_sheet['J8'].value = kspc_b1_fixed_fee
    dest_sheet['J9'].value = kspc_b1_fixed_fee
    dest_sheet['J10'].value = kspc_b1_fixed_fee
    dest_sheet['J11'].value = kspc_b1_fixed_fee
    dest_sheet['J12'].value = kspc_b1_fixed_fee
    dest_sheet['J13'].value = kspc_b1_fixed_fee
    dest_sheet['J14'].value = kspc_b1_fixed_fee
    dest_sheet['J15'].value = kspc_b1_fixed_fee
    dest_sheet['J16'].value = kspc_b1_fixed_fee
    dest_sheet['J17'].value = kspc_b1_fixed_fee
    dest_sheet['J18'].value = kspc_b1_fixed_fee
    dest_sheet['J19'].value = kspc_b1_fixed_fee
    dest_sheet['J20'].value = kspc_b1_fixed_fee
    dest_sheet['J21'].value = kspc_b1_fixed_fee
    dest_sheet['J22'].value = kspc_b1_fixed_fee
    dest_sheet['J23'].value = kspc_b1_fixed_fee
    dest_sheet['J24'].value = kspc_b1_fixed_fee
    dest_sheet['J25'].value = kspc_b1_fixed_fee

    dest_sheet['K2'].value = kspc_b1_variable_fee
    dest_sheet['K3'].value = kspc_b1_variable_fee
    dest_sheet['K4'].value = kspc_b1_variable_fee
    dest_sheet['K5'].value = kspc_b1_variable_fee
    dest_sheet['K6'].value = kspc_b1_variable_fee
    dest_sheet['K7'].value = kspc_b1_variable_fee
    dest_sheet['K8'].value = kspc_b1_variable_fee
    dest_sheet['K9'].value = kspc_b1_variable_fee
    dest_sheet['K10'].value = kspc_b1_variable_fee
    dest_sheet['K11'].value = kspc_b1_variable_fee
    dest_sheet['K12'].value = kspc_b1_variable_fee
    dest_sheet['K13'].value = kspc_b1_variable_fee
    dest_sheet['K14'].value = kspc_b1_variable_fee
    dest_sheet['K15'].value = kspc_b1_variable_fee
    dest_sheet['K16'].value = kspc_b1_variable_fee
    dest_sheet['K17'].value = kspc_b1_variable_fee
    dest_sheet['K18'].value = kspc_b1_variable_fee
    dest_sheet['K19'].value = kspc_b1_variable_fee
    dest_sheet['K20'].value = kspc_b1_variable_fee
    dest_sheet['K21'].value = kspc_b1_variable_fee
    dest_sheet['K22'].value = kspc_b1_variable_fee
    dest_sheet['K23'].value = kspc_b1_variable_fee
    dest_sheet['K24'].value = kspc_b1_variable_fee
    dest_sheet['K25'].value = kspc_b1_variable_fee

    dest_sheet['L2'].value = kspc_b2_fixed_fee
    dest_sheet['L3'].value = kspc_b2_fixed_fee
    dest_sheet['L4'].value = kspc_b2_fixed_fee
    dest_sheet['L5'].value = kspc_b2_fixed_fee
    dest_sheet['L6'].value = kspc_b2_fixed_fee
    dest_sheet['L7'].value = kspc_b2_fixed_fee
    dest_sheet['L8'].value = kspc_b2_fixed_fee
    dest_sheet['L9'].value = kspc_b2_fixed_fee
    dest_sheet['L10'].value = kspc_b2_fixed_fee
    dest_sheet['L11'].value = kspc_b2_fixed_fee
    dest_sheet['L12'].value = kspc_b2_fixed_fee
    dest_sheet['L13'].value = kspc_b2_fixed_fee
    dest_sheet['L14'].value = kspc_b2_fixed_fee
    dest_sheet['L15'].value = kspc_b2_fixed_fee
    dest_sheet['L16'].value = kspc_b2_fixed_fee
    dest_sheet['L17'].value = kspc_b2_fixed_fee
    dest_sheet['L18'].value = kspc_b2_fixed_fee
    dest_sheet['L19'].value = kspc_b2_fixed_fee
    dest_sheet['L20'].value = kspc_b2_fixed_fee
    dest_sheet['L21'].value = kspc_b2_fixed_fee
    dest_sheet['L22'].value = kspc_b2_fixed_fee
    dest_sheet['L23'].value = kspc_b2_fixed_fee
    dest_sheet['L24'].value = kspc_b2_fixed_fee
    dest_sheet['L25'].value = kspc_b2_fixed_fee

    dest_sheet['M2'].value = kspc_b2_variable_fee
    dest_sheet['M3'].value = kspc_b2_variable_fee
    dest_sheet['M4'].value = kspc_b2_variable_fee
    dest_sheet['M5'].value = kspc_b2_variable_fee
    dest_sheet['M6'].value = kspc_b2_variable_fee
    dest_sheet['M7'].value = kspc_b2_variable_fee
    dest_sheet['M8'].value = kspc_b2_variable_fee
    dest_sheet['M9'].value = kspc_b2_variable_fee
    dest_sheet['M10'].value = kspc_b2_variable_fee
    dest_sheet['M11'].value = kspc_b2_variable_fee
    dest_sheet['M12'].value = kspc_b2_variable_fee
    dest_sheet['M13'].value = kspc_b2_variable_fee
    dest_sheet['M14'].value = kspc_b2_variable_fee
    dest_sheet['M15'].value = kspc_b2_variable_fee
    dest_sheet['M16'].value = kspc_b2_variable_fee
    dest_sheet['M17'].value = kspc_b2_variable_fee
    dest_sheet['M18'].value = kspc_b2_variable_fee
    dest_sheet['M19'].value = kspc_b2_variable_fee
    dest_sheet['M20'].value = kspc_b2_variable_fee
    dest_sheet['M21'].value = kspc_b2_variable_fee
    dest_sheet['M22'].value = kspc_b2_variable_fee
    dest_sheet['M23'].value = kspc_b2_variable_fee
    dest_sheet['M24'].value = kspc_b2_variable_fee
    dest_sheet['M25'].value = kspc_b2_variable_fee

    dest_sheet['N2'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N3'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N4'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N5'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N6'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N7'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N8'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N9'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N10'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N11'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N12'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N13'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N14'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N15'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N16'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N17'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N18'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N19'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N20'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N21'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N22'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N23'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N24'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2
    dest_sheet['N25'].value = (kspc_b1_fixed_fee + kspc_b2_fixed_fee)/2

    dest_sheet['O2'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O3'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O4'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O5'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O6'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O7'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O8'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O9'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O10'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O11'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O12'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O13'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O14'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O15'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O16'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O17'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O18'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O19'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O20'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O21'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O22'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O23'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O24'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2
    dest_sheet['O25'].value = (kspc_b1_variable_fee + kspc_b2_variable_fee)/2

    dest_sheet['Q2'].value = edc_fixed_fee
    dest_sheet['Q3'].value = edc_fixed_fee
    dest_sheet['Q4'].value = edc_fixed_fee
    dest_sheet['Q5'].value = edc_fixed_fee
    dest_sheet['Q6'].value = edc_fixed_fee
    dest_sheet['Q7'].value = edc_fixed_fee
    dest_sheet['Q8'].value = edc_fixed_fee
    dest_sheet['Q9'].value = edc_fixed_fee
    dest_sheet['Q10'].value = edc_fixed_fee
    dest_sheet['Q11'].value = edc_fixed_fee
    dest_sheet['Q12'].value = edc_fixed_fee
    dest_sheet['Q13'].value = edc_fixed_fee
    dest_sheet['Q14'].value = edc_fixed_fee
    dest_sheet['Q15'].value = edc_fixed_fee
    dest_sheet['Q16'].value = edc_fixed_fee
    dest_sheet['Q17'].value = edc_fixed_fee
    dest_sheet['Q18'].value = edc_fixed_fee
    dest_sheet['Q19'].value = edc_fixed_fee
    dest_sheet['Q20'].value = edc_fixed_fee
    dest_sheet['Q21'].value = edc_fixed_fee
    dest_sheet['Q22'].value = edc_fixed_fee
    dest_sheet['Q23'].value = edc_fixed_fee
    dest_sheet['Q24'].value = edc_fixed_fee
    dest_sheet['Q25'].value = edc_fixed_fee

    dest_sheet['R2'].value = edc_variable_fee
    dest_sheet['R3'].value = edc_variable_fee
    dest_sheet['R4'].value = edc_variable_fee
    dest_sheet['R5'].value = edc_variable_fee
    dest_sheet['R6'].value = edc_variable_fee
    dest_sheet['R7'].value = edc_variable_fee
    dest_sheet['R8'].value = edc_variable_fee
    dest_sheet['R9'].value = edc_variable_fee
    dest_sheet['R10'].value = edc_variable_fee
    dest_sheet['R11'].value = edc_variable_fee
    dest_sheet['R12'].value = edc_variable_fee
    dest_sheet['R13'].value = edc_variable_fee
    dest_sheet['R14'].value = edc_variable_fee
    dest_sheet['R15'].value = edc_variable_fee
    dest_sheet['R16'].value = edc_variable_fee
    dest_sheet['R17'].value = edc_variable_fee
    dest_sheet['R18'].value = edc_variable_fee
    dest_sheet['R19'].value = edc_variable_fee
    dest_sheet['R20'].value = edc_variable_fee
    dest_sheet['R21'].value = edc_variable_fee
    dest_sheet['R22'].value = edc_variable_fee
    dest_sheet['R23'].value = edc_variable_fee
    dest_sheet['R24'].value = edc_variable_fee
    dest_sheet['R25'].value = edc_variable_fee

    dest_sheet['Y2'].value = pedc_fixed_fee
    dest_sheet['Y3'].value = pedc_fixed_fee
    dest_sheet['Y4'].value = pedc_fixed_fee
    dest_sheet['Y5'].value = pedc_fixed_fee
    dest_sheet['Y6'].value = pedc_fixed_fee
    dest_sheet['Y7'].value = pedc_fixed_fee
    dest_sheet['Y8'].value = pedc_fixed_fee
    dest_sheet['Y9'].value = pedc_fixed_fee
    dest_sheet['Y10'].value = pedc_fixed_fee
    dest_sheet['Y11'].value = pedc_fixed_fee
    dest_sheet['Y12'].value = pedc_fixed_fee
    dest_sheet['Y13'].value = pedc_fixed_fee
    dest_sheet['Y14'].value = pedc_fixed_fee
    dest_sheet['Y15'].value = pedc_fixed_fee
    dest_sheet['Y16'].value = pedc_fixed_fee
    dest_sheet['Y17'].value = pedc_fixed_fee
    dest_sheet['Y18'].value = pedc_fixed_fee
    dest_sheet['Y19'].value = pedc_fixed_fee
    dest_sheet['Y20'].value = pedc_fixed_fee
    dest_sheet['Y21'].value = pedc_fixed_fee
    dest_sheet['Y22'].value = pedc_fixed_fee
    dest_sheet['Y23'].value = pedc_fixed_fee
    dest_sheet['Y24'].value = pedc_fixed_fee
    dest_sheet['Y25'].value = pedc_fixed_fee

    dest_sheet['Z2'].value = pedc_variable_fee
    dest_sheet['Z3'].value = pedc_variable_fee
    dest_sheet['Z4'].value = pedc_variable_fee
    dest_sheet['Z5'].value = pedc_variable_fee
    dest_sheet['Z6'].value = pedc_variable_fee
    dest_sheet['Z7'].value = pedc_variable_fee
    dest_sheet['Z8'].value = pedc_variable_fee
    dest_sheet['Z9'].value = pedc_variable_fee
    dest_sheet['Z10'].value = pedc_variable_fee
    dest_sheet['Z11'].value = pedc_variable_fee
    dest_sheet['Z12'].value = pedc_variable_fee
    dest_sheet['Z13'].value = pedc_variable_fee
    dest_sheet['Z14'].value = pedc_variable_fee
    dest_sheet['Z15'].value = pedc_variable_fee
    dest_sheet['Z16'].value = pedc_variable_fee
    dest_sheet['Z17'].value = pedc_variable_fee
    dest_sheet['Z18'].value = pedc_variable_fee
    dest_sheet['Z19'].value = pedc_variable_fee
    dest_sheet['Z20'].value = pedc_variable_fee
    dest_sheet['Z21'].value = pedc_variable_fee
    dest_sheet['Z22'].value = pedc_variable_fee
    dest_sheet['Z23'].value = pedc_variable_fee
    dest_sheet['Z24'].value = pedc_variable_fee
    dest_sheet['Z25'].value = pedc_variable_fee

    dest_wb.save(destination_file_path)

# TOTAL SS LOAD 
def total_ss_load():

    # total_ss_load_path = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load.xlsx"
    total_ss_load_path = 'station_load.xlsx'
    # total_ss_load_path = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load.xlsx"
    #destination_file_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\current_rate.xlsx'
    destination_file_path = 'current_rate.xlsx'
    # destination_file_path = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\current_rate.xlsx"
    dest_wb = load_workbook(destination_file_path)
    dest_sheet = dest_wb['Sheet']

    # Load source workbook
    source_wb_2 = load_workbook(total_ss_load_path)  
    # Sheet name of the source workbook
    source_sheet_2 = source_wb_2['Sheet1']

    # Define source and destination ranges
    source_ranges_2 = [('K2', 'K25')]
    dest_ranges_2 = [('S2', 'S25')]

    # Copy data from source to destination based on specified ranges
    for i in range(len(source_ranges_2)):
        copy_values_cr(source_sheet_2, dest_sheet, source_ranges_2[i], dest_ranges_2[i])

    # Save the destination workbook
    dest_wb.save(destination_file_path)

# CONTESTABLE ENERGY
def contestable_energy():
    # CE_filepath = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\contestable_energy.xlsx'
    CE_filepath = 'contestable_energy.xlsx'
    # CE_filepath = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\contestable_energy.xlsx'
    destination_file_path = 'current_rate.xlsx'
    # destination_file_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\current_rate.xlsx'
    # destination_file_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\current_rate.xlsx'
    dest_wb = load_workbook(destination_file_path)
    dest_sheet = dest_wb['Sheet']

    # Load source workbook
    source_wb_CE = load_workbook(CE_filepath)
    # Sheet name of the source workbook
    source_sheet_CE = source_wb_CE['Sheet']

    # Define source and destination ranges
    source_ranges_CE = [('B2', 'B25')]
    dest_ranges_CE = [('T2', 'T25')]

    # Copy data from source to destination based on specified ranges
    for i in range(len(source_ranges_CE)):
        copy_values_cr(source_sheet_CE, dest_sheet, source_ranges_CE[i], dest_ranges_CE[i])

    # Save the destination workbook
    dest_wb.save(destination_file_path)

def find_total_cr():
    # directory = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\MORE Trading Node'
    directory = r'MORE Trading Node'
    # directory = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\MORE Trading Node'
    now = datetime.now()
    # Example folder name: 20240711
    date_today = now.strftime("%Y%m%d")
    contents = os.listdir(directory)
    for item in contents:
        if item == date_today:
            folder_path = os.path.join(directory, item) 
            if os.path.isdir(folder_path):
                files_in_folder = os.listdir(folder_path) # MPI_LMP_DIPC_202407110000, etc.
                current_hour = now.strftime("%H")

                if current_hour == '01':

                    try: 
                        first_file_path = os.path.join(folder_path, files_in_folder[1])
                        second_file_path = os.path.join(folder_path, files_in_folder[2])
                        third_file_path = os.path.join(folder_path, files_in_folder[3])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[4])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[5])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[6])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[7])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[8])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[9])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[10])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[11])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[12])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                    except:
                        final_total = 0
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '02':

                    try:

                        first_file_path = os.path.join(folder_path, files_in_folder[13])
                        second_file_path = os.path.join(folder_path, files_in_folder[14])
                        third_file_path = os.path.join(folder_path, files_in_folder[15])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[16])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[17])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[18])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[19])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[20])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[21])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[22])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[23])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[24])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                        
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                            
                        first_file_path = os.path.join(folder_path, files_in_folder[1])
                        second_file_path = os.path.join(folder_path, files_in_folder[2])
                        third_file_path = os.path.join(folder_path, files_in_folder[3])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[4])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[5])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[6])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[7])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[8])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[9])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[10])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[11])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[12])
                        
                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '03':
                    try: 
                        first_file_path = os.path.join(folder_path, files_in_folder[25])
                        second_file_path = os.path.join(folder_path, files_in_folder[26])
                        third_file_path = os.path.join(folder_path, files_in_folder[27])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[28])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[29])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[30])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[31])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[32])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[33])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[34])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[35])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[36])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                        
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[13])
                        second_file_path = os.path.join(folder_path, files_in_folder[14])
                        third_file_path = os.path.join(folder_path, files_in_folder[15])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[16])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[17])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[18])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[19])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[20])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[21])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[22])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[23])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[24])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_1 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_1 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_1 + file_08STBAR_T1L1_1)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                        
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '04':
                    try: 
                        first_file_path = os.path.join(folder_path, files_in_folder[37])
                        second_file_path = os.path.join(folder_path, files_in_folder[38])
                        third_file_path = os.path.join(folder_path, files_in_folder[39])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[40])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[41])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[42])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[43])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[44])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[45])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[46])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[47])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[48])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:

                        first_file_path = os.path.join(folder_path, files_in_folder[25])
                        second_file_path = os.path.join(folder_path, files_in_folder[26])
                        third_file_path = os.path.join(folder_path, files_in_folder[27])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[28])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[29])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[30])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[31])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[32])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[33])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[34])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[35])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[36])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                        
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '05':

                    try: 
                        first_file_path = os.path.join(folder_path, files_in_folder[49])
                        second_file_path = os.path.join(folder_path, files_in_folder[50])
                        third_file_path = os.path.join(folder_path, files_in_folder[51])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[52])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[53])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[54])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[55])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[56])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[57])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[58])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[59])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[60])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                    except:

                        first_file_path = os.path.join(folder_path, files_in_folder[37])
                        second_file_path = os.path.join(folder_path, files_in_folder[38])
                        third_file_path = os.path.join(folder_path, files_in_folder[39])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[40])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[41])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[42])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[43])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[44])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[45])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[46])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[47])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[48])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '06':

                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[61])
                        second_file_path = os.path.join(folder_path, files_in_folder[62])
                        third_file_path = os.path.join(folder_path, files_in_folder[63])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[64])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[65])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[66])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[67])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[68])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[69])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[70])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[71])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[72])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[49])
                        second_file_path = os.path.join(folder_path, files_in_folder[50])
                        third_file_path = os.path.join(folder_path, files_in_folder[51])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[52])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[53])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[54])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[55])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[56])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[57])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[58])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[59])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[60])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '07':

                    try: 

                        first_file_path = os.path.join(folder_path, files_in_folder[73])
                        second_file_path = os.path.join(folder_path, files_in_folder[74])
                        third_file_path = os.path.join(folder_path, files_in_folder[75])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[76])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[77])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[78])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[79])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[80])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[81])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[82])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[83])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[84])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[61])
                        second_file_path = os.path.join(folder_path, files_in_folder[62])
                        third_file_path = os.path.join(folder_path, files_in_folder[63])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[64])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[65])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[66])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[67])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[68])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[69])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[70])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[71])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[72])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '08':

                    try: 

                        first_file_path = os.path.join(folder_path, files_in_folder[85])
                        second_file_path = os.path.join(folder_path, files_in_folder[86])
                        third_file_path = os.path.join(folder_path, files_in_folder[87])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[88])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[89])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[90])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[91])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[92])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[93])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[94])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[95])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[96])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_1 + file_08STBAR_T1L1_1)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:

                        first_file_path = os.path.join(folder_path, files_in_folder[73])
                        second_file_path = os.path.join(folder_path, files_in_folder[74])
                        third_file_path = os.path.join(folder_path, files_in_folder[75])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[76])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[77])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[78])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[79])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[80])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[81])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[82])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[83])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[84])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '09':

                    try: 
                        first_file_path = os.path.join(folder_path, files_in_folder[97])
                        second_file_path = os.path.join(folder_path, files_in_folder[98])
                        third_file_path = os.path.join(folder_path, files_in_folder[99])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[100])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[101])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[102])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[103])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[104])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[105])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[106])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[107])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[108])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:

                        first_file_path = os.path.join(folder_path, files_in_folder[85])
                        second_file_path = os.path.join(folder_path, files_in_folder[86])
                        third_file_path = os.path.join(folder_path, files_in_folder[87])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[88])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[89])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[90])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[91])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[92])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[93])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[94])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[95])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[96])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '10':

                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[109])
                        second_file_path = os.path.join(folder_path, files_in_folder[110])
                        third_file_path = os.path.join(folder_path, files_in_folder[111])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[112])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[113])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[114])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[115])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[116])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[117])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[118])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[119])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[120])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                    
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_file_path = os.path.join(folder_path, files_in_folder[114])
                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[97])
                        second_file_path = os.path.join(folder_path, files_in_folder[98])
                        third_file_path = os.path.join(folder_path, files_in_folder[99])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[100])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[101])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[102])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[103])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[104])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[105])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[106])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[107])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[108])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                elif current_hour == '11':
                    try: 
                        first_file_path = os.path.join(folder_path, files_in_folder[121])
                        second_file_path = os.path.join(folder_path, files_in_folder[122])
                        third_file_path = os.path.join(folder_path, files_in_folder[123])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[124])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[125])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[126])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[127])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[128])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[129])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[130])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[131])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[132])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3
                        
                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[109])
                        second_file_path = os.path.join(folder_path, files_in_folder[110])
                        third_file_path = os.path.join(folder_path, files_in_folder[111])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[112])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[113])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[114])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[115])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[116])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[117])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[118])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[119])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[120])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                    
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3
                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_file_path = os.path.join(folder_path, files_in_folder[114])
                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '12':
                    try: 
                        first_file_path = os.path.join(folder_path, files_in_folder[133])
                        second_file_path = os.path.join(folder_path, files_in_folder[134])
                        third_file_path = os.path.join(folder_path, files_in_folder[135])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[136])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[137])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[138])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[139])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[140])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[141])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[142])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[143])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[144])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[121])
                        second_file_path = os.path.join(folder_path, files_in_folder[122])
                        third_file_path = os.path.join(folder_path, files_in_folder[123])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[124])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[125])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[126])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[127])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[128])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[129])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[130])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[131])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[132])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '13':

                    try: 

                        first_file_path = os.path.join(folder_path, files_in_folder[145])
                        second_file_path = os.path.join(folder_path, files_in_folder[146])
                        third_file_path = os.path.join(folder_path, files_in_folder[147])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[148])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[149])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[150])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[151])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[152])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[153])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[154])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[155])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[156])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                    
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[133])
                        second_file_path = os.path.join(folder_path, files_in_folder[134])
                        third_file_path = os.path.join(folder_path, files_in_folder[135])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[136])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[137])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[138])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[139])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[140])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[141])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[142])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[143])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[144])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '14':
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[157])
                        second_file_path = os.path.join(folder_path, files_in_folder[158])
                        third_file_path = os.path.join(folder_path, files_in_folder[159])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[160])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[161])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[162])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[163])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[164])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[165])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[166])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[167])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[168])
                    
                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_file_path = os.path.join(folder_path, files_in_folder[168])
                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[145])
                        second_file_path = os.path.join(folder_path, files_in_folder[146])
                        third_file_path = os.path.join(folder_path, files_in_folder[147])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[148])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[149])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[150])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[151])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[152])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[153])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[154])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[155])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[156])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                    
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '15':

                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[169])
                        second_file_path = os.path.join(folder_path, files_in_folder[170])
                        third_file_path = os.path.join(folder_path, files_in_folder[171])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[172])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[173])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[174])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[175])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[176])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[177])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[178])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[179])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[180])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                    
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:

                        first_file_path = os.path.join(folder_path, files_in_folder[157])
                        second_file_path = os.path.join(folder_path, files_in_folder[158])
                        third_file_path = os.path.join(folder_path, files_in_folder[159])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[160])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[161])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[162])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[163])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[164])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[165])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[166])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[167])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[168])
                    
                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_file_path = os.path.join(folder_path, files_in_folder[168])
                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
            
                elif current_hour == '16':
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[181])
                        second_file_path = os.path.join(folder_path, files_in_folder[182])
                        third_file_path = os.path.join(folder_path, files_in_folder[183])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[184])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[185])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[186])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[187])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[188])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[189])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[190])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[191])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[192])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[169])
                        second_file_path = os.path.join(folder_path, files_in_folder[170])
                        third_file_path = os.path.join(folder_path, files_in_folder[171])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[172])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[173])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[174])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[175])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[176])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[177])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[178])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[179])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[180])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                    
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '17':
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[193])
                        second_file_path = os.path.join(folder_path, files_in_folder[194])
                        third_file_path = os.path.join(folder_path, files_in_folder[195])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[196])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[197])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[198])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[199])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[200])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[201])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[202])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[203])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[204])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[181])
                        second_file_path = os.path.join(folder_path, files_in_folder[182])
                        third_file_path = os.path.join(folder_path, files_in_folder[183])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[184])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[185])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[186])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[187])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[188])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[189])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[190])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[191])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[192])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                
                elif current_hour == '18':
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[205])
                        second_file_path = os.path.join(folder_path, files_in_folder[206])
                        third_file_path = os.path.join(folder_path, files_in_folder[207])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[208])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[209])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[210])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[211])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[212])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[213])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[214])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[215])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[216])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                    
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                    
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[193])
                        second_file_path = os.path.join(folder_path, files_in_folder[194])
                        third_file_path = os.path.join(folder_path, files_in_folder[195])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[196])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[197])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[198])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[199])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[200])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[201])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[202])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[203])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[204])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '19':
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[217])
                        second_file_path = os.path.join(folder_path, files_in_folder[218])
                        third_file_path = os.path.join(folder_path, files_in_folder[219])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[220])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[221])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[222])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[223])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[224])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[225])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[226])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[227])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[228])
                    
                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:

                        first_file_path = os.path.join(folder_path, files_in_folder[205])
                        second_file_path = os.path.join(folder_path, files_in_folder[206])
                        third_file_path = os.path.join(folder_path, files_in_folder[207])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[208])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[209])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[210])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[211])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[212])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[213])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[214])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[215])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[216])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                    
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                    
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '20':

                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[229])
                        second_file_path = os.path.join(folder_path, files_in_folder[230])
                        third_file_path = os.path.join(folder_path, files_in_folder[231])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[232])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[233])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[234])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[235])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[236])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[237])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[238])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[239])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[240])
                    
                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[217])
                        second_file_path = os.path.join(folder_path, files_in_folder[218])
                        third_file_path = os.path.join(folder_path, files_in_folder[219])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[220])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[221])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[222])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[223])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[224])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[225])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[226])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[227])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[228])
                    
                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '21': 
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[241])
                        second_file_path = os.path.join(folder_path, files_in_folder[242])
                        third_file_path = os.path.join(folder_path, files_in_folder[243])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[244])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[245])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[246])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[247])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[248])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[249])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[250])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[251])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[252])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[229])
                        second_file_path = os.path.join(folder_path, files_in_folder[230])
                        third_file_path = os.path.join(folder_path, files_in_folder[231])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[232])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[233])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[234])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[235])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[236])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[237])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[238])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[239])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[240])
                    
                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                elif current_hour == '22':
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[253])
                        second_file_path = os.path.join(folder_path, files_in_folder[254])
                        third_file_path = os.path.join(folder_path, files_in_folder[255])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[256])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[257])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[258])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[259])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[260])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[261])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[262])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[263])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[264])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:

                        first_file_path = os.path.join(folder_path, files_in_folder[241])
                        second_file_path = os.path.join(folder_path, files_in_folder[242])
                        third_file_path = os.path.join(folder_path, files_in_folder[243])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[244])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[245])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[246])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[247])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[248])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[249])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[250])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[251])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[252])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '23':
                    try:
                        first_file_path = os.path.join(folder_path, files_in_folder[265])
                        second_file_path = os.path.join(folder_path, files_in_folder[266])
                        third_file_path = os.path.join(folder_path, files_in_folder[267])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[268])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[269])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[270])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[271])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[272])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[273])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[274])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[275])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[276])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total
                    
                    except:
                        
                        first_file_path = os.path.join(folder_path, files_in_folder[253])
                        second_file_path = os.path.join(folder_path, files_in_folder[254])
                        third_file_path = os.path.join(folder_path, files_in_folder[255])
                        fourth_file_path = os.path.join(folder_path, files_in_folder[256])
                        fifth_file_path = os.path.join(folder_path, files_in_folder[257])
                        sixth_file_path = os.path.join(folder_path, files_in_folder[258])
                        seventh_file_path = os.path.join(folder_path, files_in_folder[259])
                        eighth_file_path = os.path.join(folder_path, files_in_folder[260])
                        ninth_file_path = os.path.join(folder_path, files_in_folder[261])
                        tenth_file_path = os.path.join(folder_path, files_in_folder[262])
                        eleventh_file_path = os.path.join(folder_path, files_in_folder[263])
                        twelvth_file_path = os.path.join(folder_path, files_in_folder[264])

                        df = pd.read_csv(first_file_path)

                        search_value_1 = '08PEDC_T1L1'
                        matching_row_1 = df[df['RESOURCE_NAME'] == search_value_1]
                        file_08PEDC_T1L1_1 = matching_row_1['DIPC_PRICE'].values[0]

                        search_value_2 = '08PEDC_T1L2'
                        matching_row_2 = df[df['RESOURCE_NAME'] == search_value_2]
                        file_08PEDC_T1L2_2 = matching_row_2['DIPC_PRICE'].values[0]

                        search_value_3 = '08STBAR_T1L1'
                        matching_row_3 = df[df['RESOURCE_NAME'] == search_value_3]
                        file_08STBAR_T1L1_3 = matching_row_3['DIPC_PRICE'].values[0]

                        average_1 = (file_08PEDC_T1L1_1 + file_08PEDC_T1L2_2 + file_08STBAR_T1L1_3)/3

                        second_df = pd.read_csv(second_file_path)

                        search_value_4 = '08PEDC_T1L1'
                        matching_row_4 = second_df[second_df['RESOURCE_NAME'] == search_value_4]
                        file_08PEDC_T1L1_4 = matching_row_4['DIPC_PRICE'].values[0]
                        
                        search_value_5 = '08PEDC_T1L2'
                        matching_row_5 = second_df[second_df['RESOURCE_NAME'] == search_value_5]
                        file_08PEDC_T1L2_5 = matching_row_5['DIPC_PRICE'].values[0]

                        search_value_6 = '08STBAR_T1L1'
                        matching_row_6 = second_df[second_df['RESOURCE_NAME'] == search_value_6]
                        file_08STBAR_T1L1_6 = matching_row_6['DIPC_PRICE'].values[0]

                        average_2 = (file_08PEDC_T1L1_4 + file_08PEDC_T1L2_5 + file_08STBAR_T1L1_6)/3

                        third_df = pd.read_csv(third_file_path)

                        search_value_7 = '08PEDC_T1L1'
                        matching_row_7 = third_df[third_df['RESOURCE_NAME'] == search_value_7]
                        file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]

                        search_value_8 = '08PEDC_T1L2'
                        matching_row_8 = third_df[third_df['RESOURCE_NAME'] == search_value_8]
                        file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]

                        search_value_9 = '08STBAR_T1L1'
                        matching_row_9 = third_df[third_df['RESOURCE_NAME'] == search_value_9]
                        file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]

                        average_3 = (file_08PEDC_T1L1_7 + file_08PEDC_T1L2_8 + file_08STBAR_T1L1_9)/3

                        fourth_df = pd.read_csv(fourth_file_path)

                        search_value_10 = '08PEDC_T1L1'
                        matching_row_10 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_10]
                        file_08PEDC_T1L1_10 = matching_row_10['DIPC_PRICE'].values[0]

                        search_value_11 = '08PEDC_T1L2'
                        matching_row_11 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_11]
                        file_08PEDC_T1L2_11 = matching_row_11['DIPC_PRICE'].values[0]

                        search_value_12 = '08STBAR_T1L1'
                        matching_row_12 = fourth_df[fourth_df['RESOURCE_NAME'] == search_value_12]
                        file_08STBAR_T1L1_12 = matching_row_12['DIPC_PRICE'].values[0]

                        average_4 = (file_08PEDC_T1L1_10 + file_08PEDC_T1L2_11 + file_08STBAR_T1L1_12)/3

                        fifth_df = pd.read_csv(fifth_file_path)

                        search_value_13 = '08PEDC_T1L1'
                        matching_row_13 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_13]
                        file_08PEDC_T1L1_13 = matching_row_13['DIPC_PRICE'].values[0]

                        search_value_14 = '08PEDC_T1L2'
                        matching_row_14 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_14]
                        file_08PEDC_T1L2_14 = matching_row_14['DIPC_PRICE'].values[0]

                        search_value_15 = '08STBAR_T1L1'
                        matching_row_15 = fifth_df[fifth_df['RESOURCE_NAME'] == search_value_15]
                        file_08STBAR_T1L1_15 = matching_row_15['DIPC_PRICE'].values[0]

                        average_5 = (file_08PEDC_T1L1_13 + file_08PEDC_T1L2_14 + file_08STBAR_T1L1_15)/3

                        sixth_df = pd.read_csv(sixth_file_path)

                        search_value_16 = '08PEDC_T1L1'
                        matching_row_16 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_16]
                        file_08PEDC_T1L1_16 = matching_row_16['DIPC_PRICE'].values[0]

                        search_value_17 = '08PEDC_T1L2'
                        matching_row_17 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_17]
                        file_08PEDC_T1L2_17 = matching_row_17['DIPC_PRICE'].values[0]

                        search_value_18 = '08STBAR_T1L1'
                        matching_row_18 = sixth_df[sixth_df['RESOURCE_NAME'] == search_value_18]
                        file_08STBAR_T1L1_18 = matching_row_18['DIPC_PRICE'].values[0]

                        average_6 = (file_08PEDC_T1L1_16 + file_08PEDC_T1L2_17 + file_08STBAR_T1L1_18)/3

                        seventh_df = pd.read_csv(seventh_file_path)

                        search_value_19 = '08PEDC_T1L1'
                        matching_row_19 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_19]
                        file_08PEDC_T1L1_19 = matching_row_19['DIPC_PRICE'].values[0]

                        search_value_20 = '08PEDC_T1L2'
                        matching_row_20 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_20]
                        file_08PEDC_T1L2_20 = matching_row_20['DIPC_PRICE'].values[0]

                        search_value_21 = '08STBAR_T1L1'
                        matching_row_21 = seventh_df[seventh_df['RESOURCE_NAME'] == search_value_21]
                        file_08STBAR_T1L1_21 = matching_row_21['DIPC_PRICE'].values[0]

                        average_7 = (file_08PEDC_T1L1_19 + file_08PEDC_T1L2_20 + file_08STBAR_T1L1_21)/3

                        eighth_df = pd.read_csv(eighth_file_path)

                        search_value_22 = '08PEDC_T1L1'
                        matching_row_22 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_22]
                        file_08PEDC_T1L1_22 = matching_row_22['DIPC_PRICE'].values[0]

                        search_value_23 = '08PEDC_T1L2'
                        matching_row_23 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_23]
                        file_08PEDC_T1L2_23 = matching_row_23['DIPC_PRICE'].values[0]

                        search_value_24 = '08STBAR_T1L1'
                        matching_row_24 = eighth_df[eighth_df['RESOURCE_NAME'] == search_value_24]
                        file_08STBAR_T1L1_24 = matching_row_24['DIPC_PRICE'].values[0]

                        average_8 = (file_08PEDC_T1L1_22 + file_08PEDC_T1L2_23 + file_08STBAR_T1L1_24)/3
                            
                        ninth_df = pd.read_csv(ninth_file_path)

                        search_value_25 = '08PEDC_T1L1'
                        matching_row_25 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_25]
                        file_08PEDC_T1L1_25 = matching_row_25['DIPC_PRICE'].values[0]

                        search_value_26 = '08PEDC_T1L2'
                        matching_row_26 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_26]
                        file_08PEDC_T1L2_26 = matching_row_26['DIPC_PRICE'].values[0]

                        search_value_27 = '08STBAR_T1L1'
                        matching_row_27 = ninth_df[ninth_df['RESOURCE_NAME'] == search_value_27]
                        file_08STBAR_T1L1_27 = matching_row_27['DIPC_PRICE'].values[0]

                        average_9 = (file_08PEDC_T1L1_25 + file_08PEDC_T1L2_26 + file_08STBAR_T1L1_27)/3

                        tenth_df = pd.read_csv(tenth_file_path)

                        search_value_28 = '08PEDC_T1L1'
                        matching_row_28 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_28]
                        file_08PEDC_T1L1_28 = matching_row_28['DIPC_PRICE'].values[0]

                        search_value_29 = '08PEDC_T1L2'
                        matching_row_29 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_29]
                        file_08PEDC_T1L2_29 = matching_row_29['DIPC_PRICE'].values[0]

                        search_value_30 = '08STBAR_T1L1'
                        matching_row_30 = tenth_df[tenth_df['RESOURCE_NAME'] == search_value_30]
                        file_08STBAR_T1L1_30 = matching_row_30['DIPC_PRICE'].values[0]

                        average_10 = (file_08PEDC_T1L1_28 + file_08PEDC_T1L2_29 + file_08STBAR_T1L1_30)/3

                        eleventh_df = pd.read_csv(eleventh_file_path)

                        search_value_31 = '08PEDC_T1L1'
                        matching_row_31 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_31]
                        file_08PEDC_T1L1_31 = matching_row_31['DIPC_PRICE'].values[0]

                        search_value_32 = '08PEDC_T1L2'
                        matching_row_32 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_32]
                        file_08PEDC_T1L2_32 = matching_row_32['DIPC_PRICE'].values[0]

                        search_value_33 = '08STBAR_T1L1'
                        matching_row_33 = eleventh_df[eleventh_df['RESOURCE_NAME'] == search_value_33]
                        file_08STBAR_T1L1_33 = matching_row_33['DIPC_PRICE'].values[0]

                        average_11 = (file_08PEDC_T1L1_31 + file_08PEDC_T1L2_32 + file_08STBAR_T1L1_33)/3

                        twelvth_df = pd.read_csv(twelvth_file_path)

                        search_value_34 = '08PEDC_T1L1'
                        matching_row_34 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_34]
                        file_08PEDC_T1L1_34 = matching_row_34['DIPC_PRICE'].values[0]
                        
                        search_value_35 = '08PEDC_T1L2'
                        matching_row_35 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_35]
                        file_08PEDC_T1L2_35 = matching_row_35['DIPC_PRICE'].values[0]

                        search_value_36 = '08STBAR_T1L1'
                        matching_row_36 = twelvth_df[twelvth_df['RESOURCE_NAME'] == search_value_36]
                        file_08STBAR_T1L1_36 = matching_row_36['DIPC_PRICE'].values[0]

                        average_12 = (file_08PEDC_T1L1_34 + file_08PEDC_T1L2_35 + file_08STBAR_T1L1_36)/3

                        final_total = (average_1 + average_2 + average_3 + average_4 + average_5 + average_6 + average_7 + average_8 + average_9 + average_10 + average_11 + average_12)/12
                        float_final_total = float(final_total)
                        return float_final_total

                elif current_hour == '00':
                        final_total = 0
                        float_final_total = float(final_total)
                        return float_final_total

# STORE WESM RATE IN THE EXCEL FILE
def find_total_2():
    # destination_file_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\current_rate.xlsx'
    destination_file_path = 'current_rate.xlsx'
    # destination_file_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\current_rate.xlsx'
    dest_wb = load_workbook(destination_file_path)
    dest_sheet = dest_wb['Sheet']
    
    c = datetime.now()
    hour_now = c.strftime('%H')
    if hour_now == '01':
        wesm_rate_var = find_total_cr()
        # cell N2
        dest_sheet['V2'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '02':
        wesm_rate_var = find_total_cr()
        # cell N3
        dest_sheet['V3'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '03':
        wesm_rate_var = find_total_cr()
        # cell N4
        dest_sheet['V4'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '04':
        wesm_rate_var = find_total_cr()
        # cell N5
        dest_sheet['V5'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '05':
        wesm_rate_var = find_total_cr()
        # cell N6
        dest_sheet['V6'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '06':
        wesm_rate_var = find_total_cr()
        # cell N7
        dest_sheet['V7'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '07':
        wesm_rate_var = find_total_cr()
        # cell N8
        dest_sheet['V8'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '08':
        wesm_rate_var = find_total_cr()
        # cell N9
        dest_sheet['V9'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '09':
        wesm_rate_var = find_total_cr()
        # cell N10
        dest_sheet['V10'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '10':
        wesm_rate_var = find_total_cr()
        # cell N11
        dest_sheet['V11'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '11':
        wesm_rate_var = find_total_cr()
        # cell N12
        dest_sheet['V12'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '12':
        wesm_rate_var = find_total_cr()
        # cell N13
        dest_sheet['V13'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '13':
        wesm_rate_var = find_total_cr()
        # cell N14
        dest_sheet['V14'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '14':
        wesm_rate_var = find_total_cr()
        # cell N15
        dest_sheet['V15'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '15':
        wesm_rate_var = find_total_cr()
        # cell N16
        dest_sheet['V16'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '16':
        wesm_rate_var = find_total_cr()
        # cell N17
        dest_sheet['V17'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '17':
        wesm_rate_var = find_total_cr()
        # cell N18
        dest_sheet['V18'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '18':
        wesm_rate_var = find_total_cr()
        # cell N19
        dest_sheet['V19'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '19':
        wesm_rate_var = find_total_cr()
        # cell N20
        dest_sheet['V20'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '20':
        wesm_rate_var = find_total_cr()
        # cell N21
        dest_sheet['V21'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '21':
        wesm_rate_var = find_total_cr()
        # cell N22
        dest_sheet['V22'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '22':
        wesm_rate_var = find_total_cr()
        # cell N23
        dest_sheet['V23'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '23':
        wesm_rate_var = find_total_cr()
        # cell N24
        dest_sheet['V24'] = wesm_rate_var
        dest_wb.save(destination_file_path)
    elif hour_now == '00':
        wesm_rate_var = 0
        # cell N25
        dest_sheet['V25'] = wesm_rate_var
        dest_wb.save(destination_file_path)

# CALCULATE CURRENT RATE AND STORE IN THE EXCEL FILE
def find_total_3():
    # destination_file_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\current_rate.xlsx'
    destination_file_path = 'current_rate.xlsx'
    # destination_file_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\current_rate.xlsx'
    dest_wb = load_workbook(destination_file_path)
    dest_sheet = dest_wb['Sheet']
    c = datetime.now()
    hour_now = c.strftime('%H')

    if hour_now == '01':
        # HOUR 1
        scpc_value_1 = 25000
        scpc_fixed_cost_1 = dest_sheet['G2'].value
        bcq_scpc_1 = dest_sheet['B2'].value
        scpc_variable_cost_1 = dest_sheet['H2'].value

        kspc_value_1 = 20000
        kspc_fixed_cost_1 = dest_sheet['N2'].value
        bcq_kspc_1 = dest_sheet['I2'].value
        kspc_variable_cost_1 = dest_sheet['O2'].value

        edc_value_1 = 20000
        edc_fixed_cost_1 = dest_sheet['Q2'].value
        bcq_edc_1 = dest_sheet['P2'].value
        edc_variable_cost_1 = dest_sheet['R2'].value

        pedc_value_1 = 10000
        pedc_fixed_cost_1 = dest_sheet['Y2'].value
        bcq_pedc_1 = dest_sheet['X2'].value
        pedc_variable_cost_1 = dest_sheet['Z2'].value

        total_ssload_var_1 = dest_sheet['S2'].value
        contestable_energy_var_1 = dest_sheet['T2'].value
        total_bcq_var_1 = dest_sheet['U2'].value
        wesm_rate_var_1 = (dest_sheet['V2'].value)/1000

        current_rate_formula_1 = (((scpc_value_1 * scpc_fixed_cost_1) + (bcq_scpc_1 * scpc_variable_cost_1)) + ((kspc_value_1 * kspc_fixed_cost_1) + (bcq_kspc_1 * kspc_variable_cost_1)) + ((edc_value_1 * edc_fixed_cost_1) + (bcq_edc_1 * edc_variable_cost_1)) + ((pedc_value_1 * pedc_fixed_cost_1) + (bcq_pedc_1 * pedc_variable_cost_1)) + (total_ssload_var_1 - contestable_energy_var_1 - total_bcq_var_1) * wesm_rate_var_1)/(total_ssload_var_1 - contestable_energy_var_1)
        
        dest_sheet['W2'] = current_rate_formula_1
        dest_wb.save(destination_file_path)

    elif hour_now == '02':
        # HOUR 2
        scpc_value_2 = 25000
        scpc_fixed_cost_2 = dest_sheet['G3'].value
        bcq_scpc_2 = dest_sheet['B3'].value
        scpc_variable_cost_2 = dest_sheet['H3'].value

        kspc_value_2 = 20000
        kspc_fixed_cost_2 = dest_sheet['N3'].value
        bcq_kspc_2 = dest_sheet['I3'].value
        kspc_variable_cost_2 = dest_sheet['O3'].value

        edc_value_2 = 20000
        edc_fixed_cost_2 = dest_sheet['Q3'].value
        bcq_edc_2 = dest_sheet['P3'].value
        edc_variable_cost_2 = dest_sheet['R3'].value

        pedc_value_2 = 10000
        pedc_fixed_cost_2 = dest_sheet['Y3'].value
        bcq_pedc_2 = dest_sheet['X3'].value
        pedc_variable_cost_2 = dest_sheet['Z3'].value

        total_ssload_var_2 = dest_sheet['S3'].value
        contestable_energy_var_2 = dest_sheet['T3'].value
        total_bcq_var_2 = dest_sheet['U3'].value
        wesm_rate_var_2 = (dest_sheet['V3'].value)/1000

        current_rate_formula_2 = (((scpc_value_2 * scpc_fixed_cost_2) + (bcq_scpc_2 * scpc_variable_cost_2)) + ((kspc_value_2 * kspc_fixed_cost_2) + (bcq_kspc_2 * kspc_variable_cost_2)) + ((edc_value_2 * edc_fixed_cost_2) + (bcq_edc_2 * edc_variable_cost_2)) + ((pedc_value_2 * pedc_fixed_cost_2) + (bcq_pedc_2 * pedc_variable_cost_2)) + (total_ssload_var_2 - contestable_energy_var_2 - total_bcq_var_2) * wesm_rate_var_2)/(total_ssload_var_2 - contestable_energy_var_2)
        
        dest_sheet['W3'] = current_rate_formula_2
        dest_wb.save(destination_file_path)

    elif hour_now == '03':
        # HOUR 3
        scpc_value_3 = 25000
        scpc_fixed_cost_3 = dest_sheet['G4'].value
        bcq_scpc_3 = dest_sheet['B4'].value
        scpc_variable_cost_3 = dest_sheet['H4'].value

        kspc_value_3 = 20000
        kspc_fixed_cost_3 = dest_sheet['N4'].value
        bcq_kspc_3 = dest_sheet['I4'].value
        kspc_variable_cost_3 = dest_sheet['O4'].value

        edc_value_3 = 20000
        edc_fixed_cost_3 = dest_sheet['Q4'].value
        bcq_edc_3 = dest_sheet['P4'].value
        edc_variable_cost_3 = dest_sheet['R4'].value

        pedc_value_3 = 10000
        pedc_fixed_cost_3 = dest_sheet['Y4'].value
        bcq_pedc_3 = dest_sheet['X4'].value
        pedc_variable_cost_3 = dest_sheet['Z4'].value

        total_ssload_var_3 = dest_sheet['S4'].value
        contestable_energy_var_3 = dest_sheet['T4'].value
        total_bcq_var_3 = dest_sheet['U4'].value
        wesm_rate_var_3 = (dest_sheet['V4'].value)/1000

        current_rate_formula_3 = (((scpc_value_3 * scpc_fixed_cost_3) + (bcq_scpc_3 * scpc_variable_cost_3)) + ((kspc_value_3 * kspc_fixed_cost_3) + (bcq_kspc_3 * kspc_variable_cost_3)) + ((edc_value_3 * edc_fixed_cost_3) + (bcq_edc_3 * edc_variable_cost_3)) + ((pedc_value_3 * pedc_fixed_cost_3) + (bcq_pedc_3 * pedc_variable_cost_3)) + (total_ssload_var_3 - contestable_energy_var_3 - total_bcq_var_3) * wesm_rate_var_3)/(total_ssload_var_3 - contestable_energy_var_3)
        
        dest_sheet['W4'] = current_rate_formula_3
        dest_wb.save(destination_file_path)
        
    elif hour_now == '04':
        # HOUR 4
        scpc_value_4 = 25000
        scpc_fixed_cost_4 = dest_sheet['G5'].value
        bcq_scpc_4 = dest_sheet['B5'].value
        scpc_variable_cost_4 = dest_sheet['H5'].value

        kspc_value_4 = 20000
        kspc_fixed_cost_4 = dest_sheet['N5'].value
        bcq_kspc_4 = dest_sheet['I5'].value
        kspc_variable_cost_4 = dest_sheet['O5'].value

        edc_value_4 = 20000
        edc_fixed_cost_4 = dest_sheet['Q5'].value
        bcq_edc_4 = dest_sheet['P5'].value
        edc_variable_cost_4 = dest_sheet['R5'].value

        pedc_value_4 = 10000
        pedc_fixed_cost_4 = dest_sheet['Y5'].value
        bcq_pedc_4 = dest_sheet['X5'].value
        pedc_variable_cost_4 = dest_sheet['Z5'].value

        total_ssload_var_4 = dest_sheet['S5'].value
        contestable_energy_var_4 = dest_sheet['T5'].value
        total_bcq_var_4 = dest_sheet['U5'].value
        wesm_rate_var_4 = (dest_sheet['V5'].value)/1000

        current_rate_formula_4 = (((scpc_value_4 * scpc_fixed_cost_4) + (bcq_scpc_4 * scpc_variable_cost_4)) + ((kspc_value_4 * kspc_fixed_cost_4) + (bcq_kspc_4 * kspc_variable_cost_4)) + ((edc_value_4 * edc_fixed_cost_4) + (bcq_edc_4 * edc_variable_cost_4)) + ((pedc_value_4 * pedc_fixed_cost_4) + (bcq_pedc_4 * pedc_variable_cost_4)) + (total_ssload_var_4 - contestable_energy_var_4 - total_bcq_var_4) * wesm_rate_var_4)/(total_ssload_var_4 - contestable_energy_var_4)
        
        dest_sheet['W5'] = current_rate_formula_4
        dest_wb.save(destination_file_path)
        
    elif hour_now == '05':
        # HOUR 5
        scpc_value_5 = 25000
        scpc_fixed_cost_5 = dest_sheet['G6'].value
        bcq_scpc_5 = dest_sheet['B6'].value
        scpc_variable_cost_5 = dest_sheet['H6'].value

        kspc_value_5 = 20000
        kspc_fixed_cost_5 = dest_sheet['N6'].value
        bcq_kspc_5 = dest_sheet['I6'].value
        kspc_variable_cost_5 = dest_sheet['O6'].value

        edc_value_5 = 20000
        edc_fixed_cost_5 = dest_sheet['Q6'].value
        bcq_edc_5 = dest_sheet['P6'].value
        edc_variable_cost_5 = dest_sheet['R6'].value

        pedc_value_5 = 10000
        pedc_fixed_cost_5 = dest_sheet['Y6'].value
        bcq_pedc_5 = dest_sheet['X6'].value
        pedc_variable_cost_5 = dest_sheet['Z6'].value

        total_ssload_var_5 = dest_sheet['S6'].value
        contestable_energy_var_5 = dest_sheet['T6'].value
        total_bcq_var_5 = dest_sheet['U6'].value
        wesm_rate_var_5 = (dest_sheet['V6'].value)/1000

        current_rate_formula_5 = (((scpc_value_5 * scpc_fixed_cost_5) + (bcq_scpc_5 * scpc_variable_cost_5)) + ((kspc_value_5 * kspc_fixed_cost_5) + (bcq_kspc_5 * kspc_variable_cost_5)) + ((edc_value_5 * edc_fixed_cost_5) + (bcq_edc_5 * edc_variable_cost_5)) + ((pedc_value_5 * pedc_fixed_cost_5) + (bcq_pedc_5 * pedc_variable_cost_5)) + (total_ssload_var_5 - contestable_energy_var_5 - total_bcq_var_5) * wesm_rate_var_5)/(total_ssload_var_5 - contestable_energy_var_5)
        
        dest_sheet['W6'] = current_rate_formula_5
        dest_wb.save(destination_file_path)

    elif hour_now == '06':
        # HOUR 6
        scpc_value_6 = 25000
        scpc_fixed_cost_6 = dest_sheet['G7'].value
        bcq_scpc_6 = dest_sheet['B7'].value
        scpc_variable_cost_6 = dest_sheet['H7'].value

        kspc_value_6 = 20000
        kspc_fixed_cost_6 = dest_sheet['N7'].value
        bcq_kspc_6 = dest_sheet['I7'].value
        kspc_variable_cost_6 = dest_sheet['O7'].value

        edc_value_6 = 20000
        edc_fixed_cost_6 = dest_sheet['Q7'].value
        bcq_edc_6 = dest_sheet['P7'].value
        edc_variable_cost_6 = dest_sheet['R7'].value

        pedc_value_6 = 10000
        pedc_fixed_cost_6 = dest_sheet['Y7'].value
        bcq_pedc_6 = dest_sheet['X7'].value
        pedc_variable_cost_6 = dest_sheet['Z7'].value

        total_ssload_var_6 = dest_sheet['S7'].value
        contestable_energy_var_6 = dest_sheet['T7'].value
        total_bcq_var_6 = dest_sheet['U7'].value
        wesm_rate_var_6 = (dest_sheet['V7'].value)/1000

        current_rate_formula_6 = (((scpc_value_6 * scpc_fixed_cost_6) + (bcq_scpc_6 * scpc_variable_cost_6)) + ((kspc_value_6 * kspc_fixed_cost_6) + (bcq_kspc_6 * kspc_variable_cost_6)) + ((edc_value_6 * edc_fixed_cost_6) + (bcq_edc_6 * edc_variable_cost_6)) + ((pedc_value_6 * pedc_fixed_cost_6) + (bcq_pedc_6 * pedc_variable_cost_6)) + (total_ssload_var_6 - contestable_energy_var_6 - total_bcq_var_6) * wesm_rate_var_6)/(total_ssload_var_6 - contestable_energy_var_6)
        
        dest_sheet['W7'] = current_rate_formula_6
        dest_wb.save(destination_file_path)

    elif hour_now == '07':
        # HOUR 7
        scpc_value_7 = 25000
        scpc_fixed_cost_7 = dest_sheet['G8'].value
        bcq_scpc_7 = dest_sheet['B8'].value
        scpc_variable_cost_7 = dest_sheet['H8'].value

        kspc_value_7 = 20000
        kspc_fixed_cost_7 = dest_sheet['N8'].value
        bcq_kspc_7 = dest_sheet['I8'].value
        kspc_variable_cost_7 = dest_sheet['O8'].value

        edc_value_7 = 20000
        edc_fixed_cost_7 = dest_sheet['Q8'].value
        bcq_edc_7 = dest_sheet['P8'].value
        edc_variable_cost_7 = dest_sheet['R8'].value

        pedc_value_7 = 10000
        pedc_fixed_cost_7 = dest_sheet['Y8'].value
        bcq_pedc_7 = dest_sheet['X8'].value
        pedc_variable_cost_7 = dest_sheet['Z8'].value

        total_ssload_var_7 = dest_sheet['S8'].value
        contestable_energy_var_7 = dest_sheet['T8'].value
        total_bcq_var_7 = dest_sheet['U8'].value
        wesm_rate_var_7 = (dest_sheet['V8'].value)/1000

        current_rate_formula_7 = (((scpc_value_7 * scpc_fixed_cost_7) + (bcq_scpc_7 * scpc_variable_cost_7)) + ((kspc_value_7 * kspc_fixed_cost_7) + (bcq_kspc_7 * kspc_variable_cost_7)) + ((edc_value_7 * edc_fixed_cost_7) + (bcq_edc_7 * edc_variable_cost_7)) + ((pedc_value_7 * pedc_fixed_cost_7) + (bcq_pedc_7 * pedc_variable_cost_7)) + (total_ssload_var_7 - contestable_energy_var_7 - total_bcq_var_7) * wesm_rate_var_7)/(total_ssload_var_7 - contestable_energy_var_7)
        
        dest_sheet['W8'] = current_rate_formula_7
        dest_wb.save(destination_file_path)

    elif hour_now == '08':
        # HOUR 8
        scpc_value_8 = 25000
        scpc_fixed_cost_8 = dest_sheet['G9'].value
        bcq_scpc_8 = dest_sheet['B9'].value
        scpc_variable_cost_8 = dest_sheet['H9'].value

        kspc_value_8 = 20000
        kspc_fixed_cost_8 = dest_sheet['N9'].value
        bcq_kspc_8 = dest_sheet['I9'].value
        kspc_variable_cost_8 = dest_sheet['O9'].value

        edc_value_8 = 20000
        edc_fixed_cost_8 = dest_sheet['Q9'].value
        bcq_edc_8 = dest_sheet['P9'].value
        edc_variable_cost_8 = dest_sheet['R9'].value

        pedc_value_8 = 10000
        pedc_fixed_cost_8 = dest_sheet['Y9'].value
        bcq_pedc_8 = dest_sheet['X9'].value
        pedc_variable_cost_8 = dest_sheet['Z9'].value

        total_ssload_var_8 = dest_sheet['S9'].value
        contestable_energy_var_8 = dest_sheet['T9'].value
        total_bcq_var_8 = dest_sheet['U9'].value
        wesm_rate_var_8 = (dest_sheet['V9'].value)/1000

        current_rate_formula_8 = (((scpc_value_8 * scpc_fixed_cost_8) + (bcq_scpc_8 * scpc_variable_cost_8)) + ((kspc_value_8 * kspc_fixed_cost_8) + (bcq_kspc_8 * kspc_variable_cost_8)) + ((edc_value_8 * edc_fixed_cost_8) + (bcq_edc_8 * edc_variable_cost_8)) + ((pedc_value_8 * pedc_fixed_cost_8) + (bcq_pedc_8 * pedc_variable_cost_8)) + (total_ssload_var_8 - contestable_energy_var_8 - total_bcq_var_8) * wesm_rate_var_8)/(total_ssload_var_8 - contestable_energy_var_8)
        
        dest_sheet['W9'] = current_rate_formula_8
        dest_wb.save(destination_file_path)

    elif hour_now == '09':
        # HOUR 9
        scpc_value_9 = 25000
        scpc_fixed_cost_9 = dest_sheet['G10'].value
        bcq_scpc_9 = dest_sheet['B10'].value
        scpc_variable_cost_9 = dest_sheet['H10'].value

        kspc_value_9 = 20000
        kspc_fixed_cost_9 = dest_sheet['N10'].value
        bcq_kspc_9 = dest_sheet['I10'].value
        kspc_variable_cost_9 = dest_sheet['O10'].value

        edc_value_9 = 20000
        edc_fixed_cost_9 = dest_sheet['Q10'].value
        bcq_edc_9 = dest_sheet['P10'].value
        edc_variable_cost_9 = dest_sheet['R10'].value

        pedc_value_9 = 10000
        pedc_fixed_cost_9 = dest_sheet['Y10'].value
        bcq_pedc_9 = dest_sheet['X10'].value
        pedc_variable_cost_9 = dest_sheet['Z10'].value

        total_ssload_var_9 = dest_sheet['S10'].value
        contestable_energy_var_9 = dest_sheet['T10'].value
        total_bcq_var_9 = dest_sheet['U10'].value
        wesm_rate_var_9 = (dest_sheet['V10'].value)/1000

        current_rate_formula_9 = (((scpc_value_9 * scpc_fixed_cost_9) + (bcq_scpc_9 * scpc_variable_cost_9)) + ((kspc_value_9 * kspc_fixed_cost_9) + (bcq_kspc_9 * kspc_variable_cost_9)) + ((edc_value_9 * edc_fixed_cost_9) + (bcq_edc_9 * edc_variable_cost_9)) + ((pedc_value_9 * pedc_fixed_cost_9) + (bcq_pedc_9 * pedc_variable_cost_9)) + (total_ssload_var_9 - contestable_energy_var_9 - total_bcq_var_9) * wesm_rate_var_9)/(total_ssload_var_9 - contestable_energy_var_9)
        
        dest_sheet['W10'] = current_rate_formula_9
        dest_wb.save(destination_file_path)

    elif hour_now == '10':
        scpc_value_10 = 25000
        scpc_fixed_cost_10 = dest_sheet['G11'].value
        bcq_scpc_10 = dest_sheet['B11'].value
        scpc_variable_cost_10 = dest_sheet['H11'].value

        kspc_value_10 = 20000
        kspc_fixed_cost_10 = dest_sheet['N11'].value
        bcq_kspc_10 = dest_sheet['I11'].value
        kspc_variable_cost_10 = dest_sheet['O11'].value

        edc_value_10 = 20000
        edc_fixed_cost_10 = dest_sheet['Q11'].value
        bcq_edc_10 = dest_sheet['P11'].value
        edc_variable_cost_10 = dest_sheet['R11'].value

        pedc_value_10 = 10000
        pedc_fixed_cost_10 = dest_sheet['Y11'].value
        bcq_pedc_10 = dest_sheet['X11'].value
        pedc_variable_cost_10 = dest_sheet['Z11'].value

        total_ssload_var_10 = dest_sheet['S11'].value
        contestable_energy_var_10 = dest_sheet['T11'].value
        total_bcq_var_10 = dest_sheet['U11'].value
        wesm_rate_var_10 = (dest_sheet['V11'].value)/1000

        current_rate_formula_10 = (((scpc_value_10 * scpc_fixed_cost_10) + (bcq_scpc_10 * scpc_variable_cost_10)) + ((kspc_value_10 * kspc_fixed_cost_10) + (bcq_kspc_10 * kspc_variable_cost_10)) + ((edc_value_10 * edc_fixed_cost_10) + (bcq_edc_10 * edc_variable_cost_10)) + ((pedc_value_10 * pedc_fixed_cost_10) + (bcq_pedc_10 * pedc_variable_cost_10)) + (total_ssload_var_10 - contestable_energy_var_10 - total_bcq_var_10) * wesm_rate_var_10)/(total_ssload_var_10 - contestable_energy_var_10)
        
        dest_sheet['W11'] = current_rate_formula_10
        dest_wb.save(destination_file_path)

    elif hour_now == '11':
        # HOUR 11
        scpc_value_11 = 25000
        scpc_fixed_cost_11 = dest_sheet['G12'].value
        bcq_scpc_11 = dest_sheet['B12'].value
        scpc_variable_cost_11 = dest_sheet['H12'].value

        kspc_value_11 = 20000
        kspc_fixed_cost_11 = dest_sheet['N12'].value
        bcq_kspc_11 = dest_sheet['I12'].value
        kspc_variable_cost_11 = dest_sheet['O12'].value

        edc_value_11 = 20000
        edc_fixed_cost_11 = dest_sheet['Q12'].value
        bcq_edc_11 = dest_sheet['P12'].value
        edc_variable_cost_11 = dest_sheet['R12'].value

        pedc_value_11 = 10000
        pedc_fixed_cost_11 = dest_sheet['Y12'].value
        bcq_pedc_11 = dest_sheet['X12'].value
        pedc_variable_cost_11 = dest_sheet['Z12'].value

        total_ssload_var_11 = dest_sheet['S12'].value
        contestable_energy_var_11 = dest_sheet['T12'].value
        total_bcq_var_11 = dest_sheet['U12'].value
        wesm_rate_var_11 = (dest_sheet['V12'].value)/1000

        current_rate_formula_11 = (((scpc_value_11 * scpc_fixed_cost_11) + (bcq_scpc_11 * scpc_variable_cost_11)) + ((kspc_value_11 * kspc_fixed_cost_11) + (bcq_kspc_11 * kspc_variable_cost_11)) + ((edc_value_11 * edc_fixed_cost_11) + (bcq_edc_11 * edc_variable_cost_11)) + ((pedc_value_11 * pedc_fixed_cost_11) + (bcq_pedc_11 * pedc_variable_cost_11)) + (total_ssload_var_11 - contestable_energy_var_11 - total_bcq_var_11) * wesm_rate_var_11)/(total_ssload_var_11 - contestable_energy_var_11)
        
        dest_sheet['W12'] = current_rate_formula_11
        dest_wb.save(destination_file_path)

    elif hour_now == '12':
        # HOUR 12
        scpc_value_12 = 25000
        scpc_fixed_cost_12 = dest_sheet['G13'].value
        bcq_scpc_12 = dest_sheet['B13'].value
        scpc_variable_cost_12 = dest_sheet['H13'].value

        kspc_value_12 = 20000
        kspc_fixed_cost_12 = dest_sheet['N13'].value
        bcq_kspc_12 = dest_sheet['I13'].value
        kspc_variable_cost_12 = dest_sheet['O13'].value

        edc_value_12 = 20000
        edc_fixed_cost_12 = dest_sheet['Q13'].value
        bcq_edc_12 = dest_sheet['P13'].value
        edc_variable_cost_12 = dest_sheet['R13'].value

        pedc_value_12 = 10000
        pedc_fixed_cost_12 = dest_sheet['Y13'].value
        bcq_pedc_12 = dest_sheet['X13'].value
        pedc_variable_cost_12 = dest_sheet['Z13'].value

        total_ssload_var_12 = dest_sheet['S13'].value
        contestable_energy_var_12 = dest_sheet['T13'].value
        total_bcq_var_12 = dest_sheet['U13'].value
        wesm_rate_var_12 = (dest_sheet['V13'].value)/1000

        current_rate_formula_12 = (((scpc_value_12 * scpc_fixed_cost_12) + (bcq_scpc_12 * scpc_variable_cost_12)) + ((kspc_value_12 * kspc_fixed_cost_12) + (bcq_kspc_12 * kspc_variable_cost_12)) + ((edc_value_12 * edc_fixed_cost_12) + (bcq_edc_12 * edc_variable_cost_12)) + ((pedc_value_12 * pedc_fixed_cost_12) + (bcq_pedc_12 * pedc_variable_cost_12)) + (total_ssload_var_12 - contestable_energy_var_12 - total_bcq_var_12) * wesm_rate_var_12)/(total_ssload_var_12 - contestable_energy_var_12)
        
        dest_sheet['W13'] = current_rate_formula_12
        dest_wb.save(destination_file_path)

    elif hour_now == '13':
        # HOUR 13
        scpc_value_13 = 25000
        scpc_fixed_cost_13 = dest_sheet['G14'].value
        bcq_scpc_13 = dest_sheet['B14'].value
        scpc_variable_cost_13 = dest_sheet['H14'].value

        kspc_value_13 = 20000
        kspc_fixed_cost_13 = dest_sheet['N14'].value
        bcq_kspc_13 = dest_sheet['I14'].value
        kspc_variable_cost_13 = dest_sheet['O14'].value

        edc_value_13 = 20000
        edc_fixed_cost_13 = dest_sheet['Q14'].value
        bcq_edc_13 = dest_sheet['P14'].value
        edc_variable_cost_13 = dest_sheet['R14'].value

        pedc_value_13 = 10000
        pedc_fixed_cost_13 = dest_sheet['Y14'].value
        bcq_pedc_13 = dest_sheet['X14'].value
        pedc_variable_cost_13 = dest_sheet['Z14'].value

        total_ssload_var_13 = dest_sheet['S14'].value
        contestable_energy_var_13 = dest_sheet['T14'].value
        total_bcq_var_13 = dest_sheet['U14'].value
        wesm_rate_var_13 = (dest_sheet['V14'].value)/1000

        current_rate_formula_13 = (((scpc_value_13 * scpc_fixed_cost_13) + (bcq_scpc_13 * scpc_variable_cost_13)) + ((kspc_value_13 * kspc_fixed_cost_13) + (bcq_kspc_13 * kspc_variable_cost_13)) + ((edc_value_13 * edc_fixed_cost_13) + (bcq_edc_13 * edc_variable_cost_13)) + ((pedc_value_13 * pedc_fixed_cost_13) + (bcq_pedc_13 * pedc_variable_cost_13)) + (total_ssload_var_13 - contestable_energy_var_13 - total_bcq_var_13) * wesm_rate_var_13)/(total_ssload_var_13 - contestable_energy_var_13)
        
        dest_sheet['W14'] = current_rate_formula_13
        dest_wb.save(destination_file_path)

    elif hour_now == '14':
        # HOUR 14
        scpc_value_14 = 25000
        scpc_fixed_cost_14 = dest_sheet['G15'].value
        bcq_scpc_14 = dest_sheet['B15'].value
        scpc_variable_cost_14 = dest_sheet['H15'].value

        kspc_value_14 = 20000
        kspc_fixed_cost_14 = dest_sheet['N15'].value
        bcq_kspc_14 = dest_sheet['I15'].value
        kspc_variable_cost_14 = dest_sheet['O15'].value

        edc_value_14 = 20000
        edc_fixed_cost_14 = dest_sheet['Q15'].value
        bcq_edc_14 = dest_sheet['P15'].value
        edc_variable_cost_14 = dest_sheet['R15'].value

        pedc_value_14 = 10000
        pedc_fixed_cost_14 = dest_sheet['Y15'].value
        bcq_pedc_14 = dest_sheet['X15'].value
        pedc_variable_cost_14 = dest_sheet['Z15'].value

        total_ssload_var_14 = dest_sheet['S15'].value
        contestable_energy_var_14 = dest_sheet['T15'].value
        total_bcq_var_14 = dest_sheet['U15'].value
        wesm_rate_var_14 = (dest_sheet['V15'].value)/1000

        current_rate_formula_14 = (((scpc_value_14 * scpc_fixed_cost_14) + (bcq_scpc_14 * scpc_variable_cost_14)) + ((kspc_value_14 * kspc_fixed_cost_14) + (bcq_kspc_14 * kspc_variable_cost_14)) + ((edc_value_14 * edc_fixed_cost_14) + (bcq_edc_14 * edc_variable_cost_14)) + ((pedc_value_14 * pedc_fixed_cost_14) + (bcq_pedc_14 * pedc_variable_cost_14)) + (total_ssload_var_14 - contestable_energy_var_14 - total_bcq_var_14) * wesm_rate_var_14)/(total_ssload_var_14 - contestable_energy_var_14)
        
        dest_sheet['W15'] = current_rate_formula_14
        dest_wb.save(destination_file_path)

    elif hour_now == '15':
        # HOUR 15
        scpc_value_15 = 25000
        scpc_fixed_cost_15 = dest_sheet['G16'].value
        bcq_scpc_15 = dest_sheet['B16'].value
        scpc_variable_cost_15 = dest_sheet['H16'].value

        kspc_value_15 = 20000
        kspc_fixed_cost_15 = dest_sheet['N16'].value
        bcq_kspc_15 = dest_sheet['I16'].value
        kspc_variable_cost_15 = dest_sheet['O16'].value

        edc_value_15 = 20000
        edc_fixed_cost_15 = dest_sheet['Q16'].value
        bcq_edc_15 = dest_sheet['P16'].value
        edc_variable_cost_15 = dest_sheet['R16'].value

        pedc_value_15 = 10000
        pedc_fixed_cost_15 = dest_sheet['Y16'].value
        bcq_pedc_15 = dest_sheet['X16'].value
        pedc_variable_cost_15 = dest_sheet['Z16'].value

        total_ssload_var_15 = dest_sheet['S16'].value
        contestable_energy_var_15 = dest_sheet['T16'].value
        total_bcq_var_15 = dest_sheet['U16'].value
        wesm_rate_var_15 = (dest_sheet['V16'].value)/1000

        current_rate_formula_15 = (((scpc_value_15 * scpc_fixed_cost_15) + (bcq_scpc_15 * scpc_variable_cost_15)) + ((kspc_value_15 * kspc_fixed_cost_15) + (bcq_kspc_15 * kspc_variable_cost_15)) + ((edc_value_15 * edc_fixed_cost_15) + (bcq_edc_15 * edc_variable_cost_15)) + ((pedc_value_15 * pedc_fixed_cost_15) + (bcq_pedc_15 * pedc_variable_cost_15)) + (total_ssload_var_15 - contestable_energy_var_15 - total_bcq_var_15) * wesm_rate_var_15)/(total_ssload_var_15 - contestable_energy_var_15)
        
        dest_sheet['W16'] = current_rate_formula_15
        dest_wb.save(destination_file_path)

    elif hour_now == '16':
        # HOUR 16
        scpc_value_16 = 25000
        scpc_fixed_cost_16 = dest_sheet['G17'].value
        bcq_scpc_16 = dest_sheet['B17'].value
        scpc_variable_cost_16 = dest_sheet['H17'].value

        kspc_value_16 = 20000
        kspc_fixed_cost_16 = dest_sheet['N17'].value
        bcq_kspc_16 = dest_sheet['I17'].value
        kspc_variable_cost_16 = dest_sheet['O17'].value

        edc_value_16 = 20000
        edc_fixed_cost_16 = dest_sheet['Q17'].value
        bcq_edc_16 = dest_sheet['P17'].value
        edc_variable_cost_16 = dest_sheet['R17'].value

        pedc_value_16 = 10000
        pedc_fixed_cost_16 = dest_sheet['Y17'].value
        bcq_pedc_16 = dest_sheet['X17'].value
        pedc_variable_cost_16 = dest_sheet['Z17'].value

        total_ssload_var_16 = dest_sheet['S17'].value
        contestable_energy_var_16 = dest_sheet['T17'].value
        total_bcq_var_16 = dest_sheet['U17'].value
        wesm_rate_var_16 = (dest_sheet['V17'].value)/1000

        current_rate_formula_16 = (((scpc_value_16 * scpc_fixed_cost_16) + (bcq_scpc_16 * scpc_variable_cost_16)) + ((kspc_value_16 * kspc_fixed_cost_16) + (bcq_kspc_16 * kspc_variable_cost_16)) + ((edc_value_16 * edc_fixed_cost_16) + (bcq_edc_16 * edc_variable_cost_16)) + ((pedc_value_16 * pedc_fixed_cost_16) + (bcq_pedc_16 * pedc_variable_cost_16)) + (total_ssload_var_16 - contestable_energy_var_16 - total_bcq_var_16) * wesm_rate_var_16)/(total_ssload_var_16 - contestable_energy_var_16)
        
        dest_sheet['W17'] = current_rate_formula_16
        dest_wb.save(destination_file_path)

    elif hour_now == '17':
        # HOUR 17
        scpc_value_17 = 25000
        scpc_fixed_cost_17 = dest_sheet['G18'].value
        bcq_scpc_17 = dest_sheet['B18'].value
        scpc_variable_cost_17 = dest_sheet['H18'].value

        kspc_value_17 = 20000
        kspc_fixed_cost_17 = dest_sheet['N18'].value
        bcq_kspc_17 = dest_sheet['I18'].value
        kspc_variable_cost_17 = dest_sheet['O18'].value

        edc_value_17 = 20000
        edc_fixed_cost_17 = dest_sheet['Q18'].value
        bcq_edc_17 = dest_sheet['P18'].value
        edc_variable_cost_17 = dest_sheet['R18'].value

        pedc_value_17 = 10000
        pedc_fixed_cost_17 = dest_sheet['Y18'].value
        bcq_pedc_17 = dest_sheet['X18'].value
        pedc_variable_cost_17 = dest_sheet['Z18'].value

        total_ssload_var_17 = dest_sheet['S18'].value
        contestable_energy_var_17 = dest_sheet['T18'].value
        total_bcq_var_17 = dest_sheet['U18'].value
        wesm_rate_var_17 = (dest_sheet['V18'].value)/1000

        current_rate_formula_17 = (((scpc_value_17 * scpc_fixed_cost_17) + (bcq_scpc_17 * scpc_variable_cost_17)) + ((kspc_value_17 * kspc_fixed_cost_17) + (bcq_kspc_17 * kspc_variable_cost_17)) + ((edc_value_17 * edc_fixed_cost_17) + (bcq_edc_17 * edc_variable_cost_17)) + ((pedc_value_17 * pedc_fixed_cost_17) + (bcq_pedc_17 * pedc_variable_cost_17)) + (total_ssload_var_17 - contestable_energy_var_17 - total_bcq_var_17) * wesm_rate_var_17)/(total_ssload_var_17 - contestable_energy_var_17)
        
        dest_sheet['W18'] = current_rate_formula_17
        dest_wb.save(destination_file_path)

    elif hour_now == '18':
        # HOUR 18
        scpc_value_18 = 25000
        scpc_fixed_cost_18 = dest_sheet['G19'].value
        bcq_scpc_18 = dest_sheet['B19'].value
        scpc_variable_cost_18 = dest_sheet['H19'].value

        kspc_value_18 = 20000
        kspc_fixed_cost_18 = dest_sheet['N19'].value
        bcq_kspc_18 = dest_sheet['I19'].value
        kspc_variable_cost_18 = dest_sheet['O19'].value

        edc_value_18 = 20000
        edc_fixed_cost_18 = dest_sheet['Q19'].value
        bcq_edc_18 = dest_sheet['P19'].value
        edc_variable_cost_18 = dest_sheet['R19'].value

        pedc_value_18 = 10000
        pedc_fixed_cost_18 = dest_sheet['Y19'].value
        bcq_pedc_18 = dest_sheet['X19'].value
        pedc_variable_cost_18 = dest_sheet['Z19'].value

        total_ssload_var_18 = dest_sheet['S19'].value
        contestable_energy_var_18 = dest_sheet['T19'].value
        total_bcq_var_18 = dest_sheet['U19'].value
        wesm_rate_var_18 = (dest_sheet['V19'].value)/1000

        current_rate_formula_18 = (((scpc_value_18 * scpc_fixed_cost_18) + (bcq_scpc_18 * scpc_variable_cost_18)) + ((kspc_value_18 * kspc_fixed_cost_18) + (bcq_kspc_18 * kspc_variable_cost_18)) + ((edc_value_18 * edc_fixed_cost_18) + (bcq_edc_18 * edc_variable_cost_18)) + ((pedc_value_18 * pedc_fixed_cost_18) + (bcq_pedc_18 * pedc_variable_cost_18)) + (total_ssload_var_18 - contestable_energy_var_18 - total_bcq_var_18) * wesm_rate_var_18)/(total_ssload_var_18 - contestable_energy_var_18)
        
        dest_sheet['W19'] = current_rate_formula_18
        dest_wb.save(destination_file_path)

    elif hour_now == '19':
        # HOUR 19 
        scpc_value_19 = 25000
        scpc_fixed_cost_19 = dest_sheet['G20'].value
        bcq_scpc_19 = dest_sheet['B20'].value
        scpc_variable_cost_19 = dest_sheet['H20'].value

        kspc_value_19 = 20000
        kspc_fixed_cost_19 = dest_sheet['N20'].value
        bcq_kspc_19 = dest_sheet['I20'].value
        kspc_variable_cost_19 = dest_sheet['O20'].value

        edc_value_19 = 20000
        edc_fixed_cost_19 = dest_sheet['Q20'].value
        bcq_edc_19 = dest_sheet['P20'].value
        edc_variable_cost_19 = dest_sheet['R20'].value

        pedc_value_19 = 10000
        pedc_fixed_cost_19 = dest_sheet['Y20'].value
        bcq_pedc_19 = dest_sheet['X20'].value
        pedc_variable_cost_19 = dest_sheet['Z20'].value

        total_ssload_var_19 = dest_sheet['S20'].value
        contestable_energy_var_19 = dest_sheet['T20'].value
        total_bcq_var_19 = dest_sheet['U20'].value
        wesm_rate_var_19 = (dest_sheet['V20'].value)/1000

        current_rate_formula_19 = (((scpc_value_19 * scpc_fixed_cost_19) + (bcq_scpc_19 * scpc_variable_cost_19)) + ((kspc_value_19 * kspc_fixed_cost_19) + (bcq_kspc_19 * kspc_variable_cost_19)) + ((edc_value_19 * edc_fixed_cost_19) + (bcq_edc_19 * edc_variable_cost_19)) + ((pedc_value_19 * pedc_fixed_cost_19) + (bcq_pedc_19 * pedc_variable_cost_19)) + (total_ssload_var_19 - contestable_energy_var_19 - total_bcq_var_19) * wesm_rate_var_19)/(total_ssload_var_19 - contestable_energy_var_19)
        
        dest_sheet['W20'] = current_rate_formula_19
        dest_wb.save(destination_file_path)    

    elif hour_now == '20':
        # HOUR 20
        scpc_value_20 = 25000
        scpc_fixed_cost_20 = dest_sheet['G21'].value
        bcq_scpc_20 = dest_sheet['B21'].value
        scpc_variable_cost_20 = dest_sheet['H21'].value

        kspc_value_20 = 20000
        kspc_fixed_cost_20 = dest_sheet['N21'].value
        bcq_kspc_20 = dest_sheet['I21'].value
        kspc_variable_cost_20 = dest_sheet['O21'].value

        edc_value_20 = 20000
        edc_fixed_cost_20 = dest_sheet['Q21'].value
        bcq_edc_20 = dest_sheet['P21'].value
        edc_variable_cost_20 = dest_sheet['R21'].value

        pedc_value_20 = 10000
        pedc_fixed_cost_20 = dest_sheet['Y21'].value
        bcq_pedc_20 = dest_sheet['X21'].value
        pedc_variable_cost_20 = dest_sheet['Z21'].value

        total_ssload_var_20 = dest_sheet['S21'].value
        contestable_energy_var_20 = dest_sheet['T21'].value
        total_bcq_var_20 = dest_sheet['U21'].value
        wesm_rate_var_20 = (dest_sheet['V21'].value)/1000

        current_rate_formula_20 = (((scpc_value_20 * scpc_fixed_cost_20) + (bcq_scpc_20 * scpc_variable_cost_20)) + ((kspc_value_20 * kspc_fixed_cost_20) + (bcq_kspc_20 * kspc_variable_cost_20)) + ((edc_value_20 * edc_fixed_cost_20) + (bcq_edc_20 * edc_variable_cost_20)) + ((pedc_value_20 * pedc_fixed_cost_20) + (bcq_pedc_20 * pedc_variable_cost_20)) + (total_ssload_var_20 - contestable_energy_var_20 - total_bcq_var_20) * wesm_rate_var_20)/(total_ssload_var_20 - contestable_energy_var_20)
        
        dest_sheet['W21'] = current_rate_formula_20
        dest_wb.save(destination_file_path)

    elif hour_now == '21':
        # HOUR 21
        scpc_value_21 = 25000
        scpc_fixed_cost_21 = dest_sheet['G22'].value
        bcq_scpc_21 = dest_sheet['B22'].value
        scpc_variable_cost_21 = dest_sheet['H22'].value

        kspc_value_21 = 20000
        kspc_fixed_cost_21 = dest_sheet['N22'].value
        bcq_kspc_21 = dest_sheet['I22'].value
        kspc_variable_cost_21 = dest_sheet['O22'].value

        edc_value_21 = 20000
        edc_fixed_cost_21 = dest_sheet['Q22'].value
        bcq_edc_21 = dest_sheet['P22'].value
        edc_variable_cost_21 = dest_sheet['R22'].value

        pedc_value_21 = 10000
        pedc_fixed_cost_21 = dest_sheet['Y22'].value
        bcq_pedc_21 = dest_sheet['X22'].value
        pedc_variable_cost_21 = dest_sheet['Z22'].value

        total_ssload_var_21 = dest_sheet['S22'].value
        contestable_energy_var_21 = dest_sheet['T22'].value
        total_bcq_var_21 = dest_sheet['U22'].value
        wesm_rate_var_21 = (dest_sheet['V22'].value)/1000

        current_rate_formula_21 = (((scpc_value_21 * scpc_fixed_cost_21) + (bcq_scpc_21 * scpc_variable_cost_21)) + ((kspc_value_21 * kspc_fixed_cost_21) + (bcq_kspc_21 * kspc_variable_cost_21)) + ((edc_value_21 * edc_fixed_cost_21) + (bcq_edc_21 * edc_variable_cost_21)) + ((pedc_value_21 * pedc_fixed_cost_21) + (bcq_pedc_21 * pedc_variable_cost_21)) + (total_ssload_var_21 - contestable_energy_var_21 - total_bcq_var_21) * wesm_rate_var_21)/(total_ssload_var_21 - contestable_energy_var_21)
        
        dest_sheet['W22'] = current_rate_formula_21
        dest_wb.save(destination_file_path)
    
    elif hour_now == '22':
        # HOUR 22
        scpc_value_22 = 25000
        scpc_fixed_cost_22 = dest_sheet['G23'].value
        bcq_scpc_22 = dest_sheet['B23'].value
        scpc_variable_cost_22 = dest_sheet['H23'].value

        kspc_value_22 = 20000
        kspc_fixed_cost_22 = dest_sheet['N23'].value
        bcq_kspc_22 = dest_sheet['I23'].value
        kspc_variable_cost_22 = dest_sheet['O23'].value

        edc_value_22 = 20000
        edc_fixed_cost_22 = dest_sheet['Q23'].value
        bcq_edc_22 = dest_sheet['P23'].value
        edc_variable_cost_22 = dest_sheet['R23'].value

        pedc_value_22 = 10000
        pedc_fixed_cost_22 = dest_sheet['Y23'].value
        bcq_pedc_22 = dest_sheet['X23'].value
        pedc_variable_cost_22 = dest_sheet['Z23'].value

        total_ssload_var_22 = dest_sheet['S23'].value
        contestable_energy_var_22 = dest_sheet['T23'].value
        total_bcq_var_22 = dest_sheet['U23'].value
        wesm_rate_var_22 = (dest_sheet['V23'].value)/1000

        current_rate_formula_22 = (((scpc_value_22 * scpc_fixed_cost_22) + (bcq_scpc_22 * scpc_variable_cost_22)) + ((kspc_value_22 * kspc_fixed_cost_22) + (bcq_kspc_22 * kspc_variable_cost_22)) + ((edc_value_22 * edc_fixed_cost_22) + (bcq_edc_22 * edc_variable_cost_22)) + ((pedc_value_22 * pedc_fixed_cost_22) + (bcq_pedc_22 * pedc_variable_cost_22)) + (total_ssload_var_22 - contestable_energy_var_22 - total_bcq_var_22) * wesm_rate_var_22)/(total_ssload_var_22 - contestable_energy_var_22)
        
        dest_sheet['W23'] = current_rate_formula_22
        dest_wb.save(destination_file_path)

    elif hour_now == '23':
        # HOUR 23
        scpc_value_23 = 25000
        scpc_fixed_cost_23 = dest_sheet['G24'].value
        bcq_scpc_23 = dest_sheet['B24'].value
        scpc_variable_cost_23 = dest_sheet['H24'].value

        kspc_value_23 = 20000
        kspc_fixed_cost_23 = dest_sheet['N24'].value
        bcq_kspc_23 = dest_sheet['I24'].value
        kspc_variable_cost_23 = dest_sheet['O24'].value

        edc_value_23 = 20000
        edc_fixed_cost_23 = dest_sheet['Q24'].value
        bcq_edc_23 = dest_sheet['P24'].value
        edc_variable_cost_23 = dest_sheet['R24'].value

        pedc_value_23 = 10000
        pedc_fixed_cost_23 = dest_sheet['Y24'].value
        bcq_pedc_23 = dest_sheet['X24'].value
        pedc_variable_cost_23 = dest_sheet['Z24'].value

        total_ssload_var_23 = dest_sheet['S24'].value
        contestable_energy_var_23 = dest_sheet['T24'].value
        total_bcq_var_23 = dest_sheet['U24'].value
        wesm_rate_var_23 = (dest_sheet['V24'].value)/1000

        current_rate_formula_23 = (((scpc_value_23 * scpc_fixed_cost_23) + (bcq_scpc_23 * scpc_variable_cost_23)) + ((kspc_value_23 * kspc_fixed_cost_23) + (bcq_kspc_23 * kspc_variable_cost_23)) + ((edc_value_23 * edc_fixed_cost_23) + (bcq_edc_23 * edc_variable_cost_23)) + ((pedc_value_23 * pedc_fixed_cost_23) + (bcq_pedc_23 * pedc_variable_cost_23)) + (total_ssload_var_23 - contestable_energy_var_23 - total_bcq_var_23) * wesm_rate_var_23)/(total_ssload_var_23 - contestable_energy_var_23)
        
        dest_sheet['W24'] = current_rate_formula_23
        dest_wb.save(destination_file_path)

    elif hour_now == '00':
        # HOUR 24
        scpc_value_24 = 25000
        scpc_fixed_cost_24 = dest_sheet['G25'].value
        bcq_scpc_24 = dest_sheet['B25'].value
        scpc_variable_cost_24 = dest_sheet['H25'].value

        kspc_value_24 = 20000
        kspc_fixed_cost_24 = dest_sheet['N25'].value
        bcq_kspc_24 = dest_sheet['I25'].value
        kspc_variable_cost_24 = dest_sheet['O25'].value

        edc_value_24 = 20000
        edc_fixed_cost_24 = dest_sheet['Q25'].value
        bcq_edc_24 = dest_sheet['P25'].value
        edc_variable_cost_24 = dest_sheet['R25'].value

        pedc_value_24 = 10000
        pedc_fixed_cost_24 = dest_sheet['Y25'].value
        bcq_pedc_24 = dest_sheet['X25'].value
        pedc_variable_cost_24 = dest_sheet['Z25'].value

        total_ssload_var_24 = dest_sheet['S25'].value
        contestable_energy_var_24 = dest_sheet['T25'].value
        total_bcq_var_24 = dest_sheet['U25'].value
        wesm_rate_var_24 = (dest_sheet['V25'].value)/1000

        current_rate_formula_24 = 0
        
        dest_sheet['W25'] = current_rate_formula_24
        dest_wb.save(destination_file_path)   

# Function to retrieve the current hour in 24-hour format
def get_current_hour_cr():
    now = datetime.now()
    current_hour = now.hour
    if current_hour == 0:
        return 24
    return current_hour

# Function to get current rate value for the current hour (1 to 24) from Excel
def get_current_rate_for_current_hour(excel_file, current_hour, default_value=0.0):
    # Read Excel file into a Pandas DataFrame
    df = pd.read_excel(excel_file, header=None, names=['HOUR', 'BCQ_SCPC', 'RATE_SCPC_B1_FIXED_FEE', 
                                                        'RATE_SCPC_B1_VARIABLE_FEE', 'RATE_SCPC_B2_FIXED_FEE', 
                                                        'RATE_SCPC_B2_VARIABLE_FEE', 'RATE_SCPC_AVE_FIXED_FEE', 
                                                        'RATE_SCPC_AVE_VARIABLE_FEE', 'BCQ_KSPC', 'RATE_KSPC_B1_FIXED_FEE', 
                                                        'RATE_KSPC_B1_VARIABLE_FEE', 'RATE_KSPC_B2_FIXED_FEE', 
                                                        'RATE_KSPC_B2_VARIABLE_FEE', 'RATE_KSPC_AVE_FIXED_FEE', 
                                                        'RATE_KSPC_AVE_VARIABLE_FEE', 'BCQ_EDC', 'RATE_EDC_FIXED_FEE', 
                                                        'RATE_EDC_VARIABLE_FEE', 'TOTAL_SS_LOAD', 'CONTESTABLE_ENERGY', 
                                                        'TOTAL_BCQ', 'WESM_RATE', 'CURRENT_RATE', 'BCQ_PEDC', 'RATE_PEDC_FIXED_FEE', 'RATE_PEDC_VARIABLE_FEE'], skiprows=1)

    # Filter the row where 'HOUR' matches the current_hour
    current_rate_value = df.loc[df['HOUR'] == current_hour, 'CURRENT_RATE']

    if current_rate_value.empty or pd.isna(current_rate_value.iloc[0]):
        # Get today's date and time
        now = datetime.now()
        # Subtract one hour to get the previous hour
        previous_hour = now - timedelta(hours=1)
        # Extract the hour part
        previous_hour_only = previous_hour.hour
        # Filter the row where 'HOUR' matches the previous_hour
        previous_rate_value = df.loc[df['HOUR'] == previous_hour_only, 'CURRENT_RATE']
        # Check if the previous rate value is not empty or NaN, and convert it to float
        if not previous_rate_value.empty and not pd.isna(previous_rate_value.iloc[0]):
            float_current_rate_value = float(previous_rate_value.iloc[0])
        else:
            float_current_rate_value = float(default_value)
    else:
        float_current_rate_value = float(current_rate_value.iloc[0])

    return float_current_rate_value

def insert_into_mysql_cr(conn, float_current_rate_value):
    try:
        # Create a cursor object
        cursor = conn.cursor()
        # SQL Insert Statement
        sql = "INSERT INTO current_rate (rate) VALUES (%s)"
        # Execute the SQL Query
        cursor.execute(sql, (float_current_rate_value,))
        # Commit the transaction
        conn.commit()
        # Print a confirmation message
        print(f"Value {float_current_rate_value} inserted successfully into MySQL.")
    except mysql.connector.Error as err:
        print(f"Error: {err}")
        conn.rollback()
    finally:
        if cursor:
            cursor.close()

def retrieve_and_insert_last_value_cr(conn):
    try:
        # Create a cursor object
        cursor = conn.cursor()
        # SQL Query to get the last value
        sql_retrieve = "SELECT rate FROM current_rate ORDER BY id DESC LIMIT 1"
        cursor.execute(sql_retrieve)
        result = cursor.fetchone()

        # Check if a result was found
        if result:
            last_value = result[0]
            print(f"Last value retrieved from the database: {last_value}")

            # SQL Insert Statement to insert the last value back into the database
            sql_insert = "INSERT INTO current_rate (rate) VALUES (%s)"
            cursor.execute(sql_insert, (last_value,))
            conn.commit()
            print(f"Last value {last_value} inserted successfully into MySQL.")
        else:
            print("No previous value found in the database.")
    except mysql.connector.Error as err:
        print(f"Error: {err}")
        conn.rollback()
    finally:
        if cursor:
            cursor.close()

def main_cr(excel_file, conn):
    # while True:
    try:
        # Ensure initial_function and others are correctly defined
        initial_function()
        total_ss_load()
        contestable_energy()
        find_total_cr()
        find_total_2()
        find_total_3()
        
        current_hour = get_current_hour_cr()
        float_current_rate_value = get_current_rate_for_current_hour(excel_file, current_hour)

        # Insert into MySQL database
        insert_into_mysql_cr(conn, float_current_rate_value)
    except pd.errors.EmptyDataError:
        retrieve_and_insert_last_value_cr(conn)
    except Exception as e:
        print(f"Unexpected error: {e}")
    #time.sleep(800) # Wait for 800 seconds before next update

def current_rate_file():
    excel_file = 'current_rate.xlsx'
    
    # while True:
    conn = mysql.connector.connect(
        host='cesra-db.cxkuksua06qz.ap-southeast-1.rds.amazonaws.com',
        database='myDb',
        user='cesra_dbm',
        password='ibIDN0NcnGYo71qDZuHw',
        port=3309
    )

    # Create MySQL table if it doesn't exist
    try:
        cursor = conn.cursor()
        cursor.execute("""
            CREATE TABLE IF NOT EXISTS current_rate (
                id INT AUTO_INCREMENT PRIMARY KEY,
                rate FLOAT(10, 4) NOT NULL,
                insert_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        """)
    except mysql.connector.Error as err:
        print(f"Error creating table: {err}")
    finally:
        cursor.close()

    try:
        # Run main function to continuously check and update database
        main_cr(excel_file, conn)
    except Exception as e:
        print(f"Error in main function: {e}")
    finally:
        # Close the connection
        conn.close()

def get_driver():
    options = Options()
    options.add_argument("--disable-gpu")
    options.add_argument("--headless")

    return webdriver.Chrome(
        service=Service(
            ChromeDriverManager(chrome_type=ChromeType.CHROMIUM).install()
        ),
        options=options,
    )

# ------ from get_temp_weather_data.py ------
def fetch_weather_data():
    # # Set up Selenium options
    # chrome_options = Options()
    # chrome_options.add_argument("--headless")  # Run in headless mode (no browser window)

    # # Initialize the webdriver
    # driver = webdriver.Chrome()

    # Set up options for headless mode
    # options = Options()
    # options.add_argument("--disable-gpu")
    # options.add_argument("--headless")
    
    # Initialize WebDriver with ChromeDriver and Chrome options
    driver = get_driver()
    # driver = webdriver.Chrome(ChromeDriverManager().install())
    # URL of The Weather Channel
    url = 'https://weather.com/en-TT/weather/today/l/d5c2f0e4c2053e855f8c6f30f8c21aedcedfe8c9f8842071a894732e8b0eff99'
    driver.get(url)

    # Find the temperature element in the page
    temp_element = driver.find_element(By.XPATH, "/html/body/div[1]/main/div[2]/main/div[1]/div/section/div/div/div[2]/div[1]/div[1]/span")
    # Find the weather condition element in the page
    weather_element = driver.find_element(By.XPATH, "/html/body/div[1]/main/div[2]/main/div[1]/div/section/div/div/div[2]/div[1]/div[1]/div[1]")
    # Extract the temperature value
    temperature = temp_element.text.replace("°", "") if temp_element else "Not found"
    # Extract the weather condition 
    weather = weather_element.text if weather_element else 'Not found'

    # Close the webdriver
    driver.quit()

    now = datetime.now()
    date_today = now.strftime("%m/%d/%Y")
    current_hour = now.strftime("%H")

    new_data = {
        "Temperature (in Celsius)": [temperature],
        "Weather Condition": [weather],
        "Date Today": [date_today],
        "Current Hour": [current_hour]
    }

    new_df = pd.DataFrame(new_data)

    # Filepath to the Excel file
    file_path = 'temp_data.xlsx'

    # Check if the Excel file exists
    if os.path.exists(file_path):
        # Read the existing data
        existing_df = pd.read_excel(file_path)
        # Append the new data
        updated_df = pd.concat([existing_df, new_df], ignore_index=True)
    else:
        # If the file does not exist, use the new data as the DataFrame
        updated_df = new_df

    # Write the updated DataFrame back to the Excel file
    updated_df.to_excel(file_path, index=False)

def get_temp_weather_data_file():
    # while True:
    fetch_weather_data()
    # time.sleep(600) # Every 600 seconds

# ------ from store_temp_weather_db.py ------
# Function to retrieve the current date
def get_current_date():
    now = datetime.now()
    current_date = now.strftime("%m/%d/%Y")
    return current_date

# Function to retrieve the current hour 
def get_current_hour_stwd():
    now = datetime.now()
    current_hour = now.hour
    if current_hour == 0:
        return 24
    return current_hour

# Function to retrieve temperature and weather condition from Excel for the current date and hour
def get_temp_weather_for_current_hour(excel_file, current_date, current_hour):
    try:
        # Read Excel file into a Pandas DataFrame
        df = pd.read_excel(excel_file, header=None, names=['Temperature', 'Weather Condition', 'Date Today', 'Current Hour'], skiprows=1)

        # Filter the row based on date and hour
        filtered_data = df[(df['Date Today'] == current_date) & (df['Current Hour'] == current_hour)]

        if not filtered_data.empty:
            temperature = filtered_data['Temperature'].values[0]
            weather_condition = filtered_data['Weather Condition'].values[0]
            return int(temperature), weather_condition
        else:
            return None, None
    except Exception as e:
        print(f"Error retrieving temperature and weather condition from Excel: {e}")
        return None, None

# Function to insert temperature and weather condition into MySQL
def insert_data_into_mysql(conn, temperature, weather_condition):
    try:
        cursor = conn.cursor()
        sql = "INSERT INTO temp_data (temp, weather) VALUES (%s, %s)"
        cursor.execute(sql, (temperature, weather_condition))
        conn.commit() # Commit the transaction
        cursor.close()
        print(f"Temperature {temperature} and Weather Condition {weather_condition} inserted successfully into MySQL.")
    except mysql.connector.Error as e:
        print(f"Error inserting temperature and weather condition into MySQL: {e}")
    except Exception as e:
        print(f"Error: {e}")

# Main function to run the script
def main_stwd(excel_file, conn):
    current_date = get_current_date()
    # while True:

    current_hour = get_current_hour_stwd()
    temperature, weather_condition = get_temp_weather_for_current_hour(excel_file, current_date, current_hour)

    if temperature is not None and weather_condition is not None:
        insert_data_into_mysql(conn, temperature, weather_condition)
    else:
        print(f"Invalid temperature valu: {temperature} and invalid weather condition value: {weather_condition}")
            
        #time.sleep(800)

def store_temp_weather_db_file():
    # while True:
    excel_file = 'temp_data.xlsx'

    conn = mysql.connector.connect(
        host='cesra-db.cxkuksua06qz.ap-southeast-1.rds.amazonaws.com',
        database='myDb',
        user='cesra_dbm',
        password='ibIDN0NcnGYo71qDZuHw',
        port=3309
    )

    # Create MySQL table if it doesn't exist
    cursor = conn.cursor()
    cursor.execute("""
        CREATE TABLE IF NOT EXISTS temp_data (
            id INT AUTO_INCREMENT PRIMARY KEY,
            temp INT,
            weather TEXT,
            insert_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        )
    """)
    cursor.close()

    # Run main function to continuously check and update database
    main_stwd(excel_file, conn)

# # ------ from so_advisories.py file ------
# # Check expected columns based on header
# def inspect_csv_so(file_path, encoding='utf-16', delimiter='\t'):
#     with open(file_path, 'r', encoding=encoding) as infile:
#         reader = csv.reader(infile, delimiter=delimiter)
#         header = next(reader)
        
#         # Clean the header by removing empty strings and stripping whitespace
#         header = [col.strip() for col in header if col.strip()]
#         expected_columns = len(header)
        
#         print(f"Cleaned Header: {header}")
#         print(f"Expected columns based on header: {expected_columns}")
        
#         return expected_columns, header

# def clean_csv_so(file_path, cleaned_file_path, encoding='utf-16', delimiter='\t', expected_columns=None):
#     with open(file_path, 'r', encoding=encoding) as infile:
#         reader = csv.reader(infile, delimiter=delimiter)
#         data = list(reader)
        
#         if expected_columns is None:
#             expected_columns = len(data[0])
        
#         cleaned_data = []
#         for i, row in enumerate(data):
#             if len(row) > expected_columns:
#                 # Adjust the row to have the expected number of columns
#                 new_row = row[:expected_columns-1] + [' '.join(row[expected_columns-1:])]
#                 cleaned_data.append(new_row)
#             elif len(row) < expected_columns:
#                 # Handle rows with fewer columns (e.g., append empty strings)
#                 new_row = row + [''] * (expected_columns - len(row))
#                 cleaned_data.append(new_row)
#             else:
#                 cleaned_data.append(row)
    
#     # Write cleaned data to a new file
#     with open(cleaned_file_path, 'w', encoding=encoding, newline='') as outfile:
#         writer = csv.writer(outfile, delimiter=delimiter)
#         writer.writerow(header)  # Write the cleaned header first
#         writer.writerows(cleaned_data[1:])  # Write the data rows

# # Function to remove specific problematic characters
# def remove_problematic_characters_so(text):
#     # Replace the problematic character \x02 (hex) or  (unicode) with an empty string
#     return text.replace('\x02', '').replace('', '')

# def main_so():
#     try:
#         # Set up options for headless mode
#         chrome_options = Options()
#         chrome_options.add_argument("--headless")  # Enable headless mode
#         chrome_options.add_argument("--disable-gpu")  # Disable GPU acceleration (optional)
#         chrome_options.add_argument("--window-size=1920,1080")  # Set the window size (optional)

#         # Initialize the WebDriver with the specified options
#         driver = webdriver.Chrome(options=chrome_options)

#         # driver = webdriver.Chrome()
#         # URL of website
#         url = 'https://embi.iemop.ph/t/tod/views/SYSTEM_ADVISORY/SOADVISORIES?%3AshowAppBanner=false&%3Adisplay_count=n&%3AshowVizHome=n&%3Aorigin=viz_share_link&%3AisGuestRedirectFromVizportal=y&%3Aembed=y'
#         # Opening the website
#         driver.get(url) 
#         # # Maximize window
#         # driver.maximize_window()
#         time.sleep(20)
#         # Click 'Download'
#         driver.find_element(By.XPATH, "/html/body/div[2]/div[2]/div[2]/div[1]/div[2]/div[2]").click()
#         time.sleep(20)
#         # Click 'Crosstab'
#         driver.find_element(By.XPATH, "/html/body/div[6]/div/div/div/div/div[2]/div/button[3]").click()
#         time.sleep(20)
#         # Click 'Download'
#         driver.find_element(By.XPATH, '/html/body/div[7]/div/div/div/div/div[2]/div/div[2]/button').click()
#         time.sleep(20)
#         #list_of_files_so = glob.glob(r'C:\Users\aslee\Downloads\*') # Downloads Path 
#         list_of_files_so = glob.glob(r'C:\Users\Corplan\Downloads\*')
#         prefix_so = 'SO_ADV'

#         # Filter the list to include only files starting with the prefix
#         #filtered_files_so = [file for file in list_of_files_so if file.startswith(prefix_so)]
#         filtered_files_so = [file for file in list_of_files_so if os.path.basename(file).startswith(prefix_so)]
#         # Find the most recently created file from the filtered list
#         if filtered_files_so:
#             most_recent_file_so = max(filtered_files_so, key=os.path.getctime)
#             print(f"The most recently created file starting with '{prefix_so}' is: {most_recent_file_so}")
#         else:
#             print(f"No files starting with '{prefix_so}' found.")
#         # Finds the most recently created file from a list of files
#         # csv_file_path = max(list_of_files, key=os.path.getctime)
#         #final_csv_file_path = r'C:\Users\aslee\Downloads\SO_ADV_crosstab.csv'
#         #final_csv_file_path = r'C:\Users\Corplan\Downloads\SO_ADV_crosstab.csv'
#         time.sleep(20)
#         # for i in range(1, 100000):
#         #     if csv_file_path == rf'C:\Users\aslee\Downloads\SO_ADV_crosstab ({i}).csv':
#         #     #if csv_file_path == rf'C:\Users\Corplan\Downloads\SO_ADV_crosstab ({i}).csv':
#         #         os.replace(csv_file_path, final_csv_file_path)
#         #         break 
#         time.sleep(20)
#         global header
#         # Usage
#         expected_columns, header = inspect_csv_so(most_recent_file_so, delimiter='\t')
#         time.sleep(20)
#         # # Create a new Excel workbook
#         # workbook = openpyxl.Workbook()
#         # # Select the default sheet (usually named 'Sheet')
#         # sheet = workbook.active
#         # # Save the workbook to a file
#         # workbook.save('SO_ADVISORIES.xlsx')
#         # Usage
#         #cleaned_csv_file_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\SO_ADVISORIES.xlsx'
#         cleaned_csv_file_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\SO_ADVISORIES.xlsx'
#         #cleaned_csv_file_path = r'C:\Users\Corplan\Downloads\cleaned_output_file.csv'
#         clean_csv_so(most_recent_file_so, cleaned_csv_file_path, encoding='utf-16', delimiter='\t', expected_columns=expected_columns)
#         # Read the cleaned CSV file
#         df = pd.read_csv(cleaned_csv_file_path, encoding='utf-16', delimiter='\t')
#         time.sleep(20)
#         # Clean each cell in the DataFrame
#         df_cleaned = df.applymap(remove_problematic_characters_so)
#         time.sleep(20)
#         # Write the cleaned DataFrame to an Excel file
#         #excel_file_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\SO_ADVISORIES.xlsx'
#         excel_file_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\SO_ADVISORIES.xlsx'
#         df_cleaned.to_excel(excel_file_path, index=False)
#         print(f'CSV file "{cleaned_csv_file_path}" successfully converted to Excel file "{excel_file_path}"')
#     except:
#         time.sleep(1)
#         st.rerun()

# # def so_advisories_file():
# #     so_thread = threading.Thread(target=main_so, daemon=False)
# #     so_thread.start()

# # ------ from mo_advisories.py file ------
# # Check expected columns based on header
# def inspect_csv_mo(file_path, encoding='utf-16', delimiter='\t'):
#     with open(file_path, 'r', encoding=encoding) as infile:
#         reader = csv.reader(infile, delimiter=delimiter)
#         header_mo = next(reader)
        
#         # Clean the header by removing empty strings and stripping whitespace
#         header_mo = [col.strip() for col in header_mo if col.strip()]
#         expected_columns_mo = len(header_mo)
        
#         print(f"Cleaned Header: {header_mo}")
#         print(f"Expected columns based on header: {expected_columns_mo}")
        
#         return expected_columns_mo, header_mo
# def clean_csv_mo(file_path, cleaned_file_path, encoding='utf-16', delimiter='\t', expected_columns_mo=None):
#     with open(file_path, 'r', encoding=encoding) as infile:
#         reader = csv.reader(infile, delimiter=delimiter)
#         data = list(reader)
        
#         if expected_columns_mo is None:
#             expected_columns_mo = len(data[0])
        
#         cleaned_data = []
#         for i, row in enumerate(data):
#             if len(row) > expected_columns_mo:
#                 # Adjust the row to have the expected number of columns
#                 new_row = row[:expected_columns_mo-1] + [' '.join(row[expected_columns_mo-1:])]
#                 cleaned_data.append(new_row)
#             elif len(row) < expected_columns_mo:
#                 # Handle rows with fewer columns (e.g., append empty strings)
#                 new_row = row + [''] * (expected_columns_mo - len(row))
#                 cleaned_data.append(new_row)
#             else:
#                 cleaned_data.append(row)
    
#     # Write cleaned data to a new file
#     with open(cleaned_file_path, 'w', encoding=encoding, newline='') as outfile:
#         writer = csv.writer(outfile, delimiter=delimiter)
#         writer.writerow(header_mo)  # Write the cleaned header first
#         writer.writerows(cleaned_data[1:])  # Write the data rows

# # Function to remove specific problematic characters
# def remove_problematic_characters_mo(text):
#     # Replace the problematic character \x02 (hex) or  (unicode) with an empty string
#     return text.replace('\x02', '').replace('', '')

# def main_mo():
#     try:
#         # Set up options for headless mode
#         chrome_options = Options()
#         chrome_options.add_argument("--headless")  # Enable headless mode
#         chrome_options.add_argument("--disable-gpu")  # Disable GPU acceleration (optional)
#         chrome_options.add_argument("--window-size=1920,1080")  # Set the window size (optional)

#         # Initialize the WebDriver with the specified options
#         driver = webdriver.Chrome(options=chrome_options)
#         # driver = webdriver.Chrome()
#         # URL of website
#         url = 'https://embi.iemop.ph/t/tod/views/SYSTEM_ADVISORY/MARKETSYSTEMS?%3AshowAppBanner=false&%3Adisplay_count=n&%3AshowVizHome=n&%3Aorigin=viz_share_link&%3AisGuestRedirectFromVizportal=y&%3Aembed=y'
#         # Opening the website
#         driver.get(url) 
#         # # Maximize window
#         # driver.maximize_window()
#         time.sleep(20)
#         # Click 'Download'
#         driver.find_element(By.XPATH, "/html/body/div[2]/div[2]/div[2]/div[1]/div[2]/div[2]").click()
#         time.sleep(20)
#         # Click 'Crosstab'
#         driver.find_element(By.XPATH, "/html/body/div[6]/div/div/div/div/div[2]/div/button[3]").click()
#         time.sleep(20)
#         # Click 'Download'
#         driver.find_element(By.XPATH, "/html/body/div[7]/div/div/div/div/div[2]/div/div[2]/button").click()
#         time.sleep(20)
#         list_of_files_mo = glob.glob(r'C:\Users\Corplan\Downloads\*')
#         #list_of_files_mo = glob.glob(r'C:\Users\aslee\Downloads\*')
#         # Define the prefix to filter files
#         prefix_mo = 'ADV'

#         # Filter the list to include only files starting with the prefix
#         #filtered_files_mo = [file for file in list_of_files_mo if file.startswith(prefix_mo)]
#         filtered_files_mo = [file for file in list_of_files_mo if os.path.basename(file).startswith(prefix_mo)]
        
#         # Find the most recently created file from the filtered list
#         if filtered_files_mo:
#             most_recent_file_mo = max(filtered_files_mo, key=os.path.getctime)
#             print(f"The most recently created file starting with '{prefix_mo}' is: {most_recent_file_mo}")
#         else:
#             print(f"No files starting with '{prefix_mo}' found.")
#         #list_of_files = glob.glob(r'C:\Users\Corplan\Downloads\*')
#         # Finds the most recently created file from a list of files
#         # csv_file_path_mo = max(list_of_files, key=os.path.getctime)
#         # final_csv_file_path_mo = r'C:\Users\aslee\Downloads\ADV_crosstab.csv'
#         #final_csv_file_path = r'C:\Users\Corplan\Downloads\ADV_crosstab.csv'
#         # time.sleep(20)
#         # for i in range(1, 100000):
#         #     if csv_file_path_mo == rf'C:\Users\aslee\Downloads\ADV_crosstab ({i}).csv':
#         #     #if csv_file_path == rf'C:\Users\Corplan\Downloads\ADV_crosstab ({i}).csv':
#         #         os.replace(csv_file_path_mo, final_csv_file_path_mo)
#         #         break
#         time.sleep(20)
#         global header_mo
#         # Usage
#         expected_columns_mo, header_mo = inspect_csv_mo(most_recent_file_mo, delimiter='\t')
#         time.sleep(20)
#         # # Create a new Excel workbook
#         # workbook = openpyxl.Workbook()
#         # # Select the default sheet (usually named 'Sheet')
#         # sheet = workbook.active
#         # # Save the workbook to a file
#         # workbook.save('MO_ADVISORIES.xlsx')
#         # Usage
#         #cleaned_csv_file_path_mo = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\MO_ADVISORIES.xlsx'
#         cleaned_csv_file_path_mo = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\MO_ADVISORIES.xlsx'
#         clean_csv_mo(most_recent_file_mo, cleaned_csv_file_path_mo, encoding='utf-16', delimiter='\t', expected_columns_mo=expected_columns_mo)
#         time.sleep(20)
#         # Read the cleaned CSV file
#         df_2_mo = pd.read_csv(cleaned_csv_file_path_mo, encoding='utf-16', delimiter='\t')
#         time.sleep(20)
#         # Clean each cell in the DataFrame
#         df_cleaned_mo = df_2_mo.applymap(remove_problematic_characters_mo)
#         time.sleep(20)
#         # Write the cleaned DataFrame to an Excel file
#         #excel_file_path_mo = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\MO_ADVISORIES.xlsx'
#         excel_file_path_mo = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\MO_ADVISORIES.xlsx'
#         df_cleaned_mo.to_excel(excel_file_path_mo, index=False)
#         print(f'CSV file "{cleaned_csv_file_path_mo}" successfully converted to Excel file "{excel_file_path_mo}"')
#     except:
#         time.sleep(1)
#         st.rerun()

# # def mo_advisories_file():
# #     mo_thread = threading.Thread(target=main_mo, daemon=False)
# #     mo_thread.start()

# def advisories_file():
#     so_thread = threading.Thread(target=main_so, daemon=False)
#     mo_thread = threading.Thread(target=main_mo, daemon=False)
#     so_thread.start()
#     mo_thread.start()

def view_all_data():
    c.execute('select * from TimeIntervals order by id asc')
    data=c.fetchall()
    return data

def view_all_data2():
    c.execute('select * from forecasted_energy order by id asc')
    data=c.fetchall()
    return data

def view_all_data3():
    c.execute('select * from total_bcq_nomination order by id asc')
    data=c.fetchall()
    return data

def view_all_data4():
    c.execute('select * from total_substation_load order by id asc')
    data=c.fetchall()
    return data

def view_all_data5():
    c.execute('select * from contestable_energy order by id asc')
    data=c.fetchall()
    return data

def view_all_data6():
    c.execute('select * from actual_energy order by id asc')
    data = c.fetchall()
    return data

def view_all_data7():
    c.execute('select * from wesm_exposure order by id asc')
    data = c.fetchall()
    return data

def view_all_data8():
    c.execute('select * from more_trading_node order by id asc')
    data = c.fetchall()
    return data

def view_all_data9():
    c.execute('select * from current_rate order by id asc')
    data = c.fetchall()
    return data

def view_all_data10():
    c.execute('select * from temp_data order by id asc')
    data = c.fetchall()
    return data

# Function to fetch latest 10 entries
def fetch_latest_10_entries(df):
    return df.head(10)

# Function to fetch latest entry
def fetch_latest_entry(df):
    return df.head(1)

def safe_get(df, row, column):
    try:
        return df.at[row, column]
    except KeyError:
        return 0

# Function to copy values from source range to destination range
def copy_values_slg(source_sheet_slg, dest_sheet_slg, source_range_slg, dest_range_slg):
    source_start_slg, source_end_slg = source_range_slg
    dest_start_slg, dest_end_slg = dest_range_slg

    # Copy values from source to destination
    source_values_slg = []
    for row in source_sheet_slg[source_start_slg:source_end_slg]:
        for cell in row:
            source_values_slg.append(cell.value)
    
    dest_index_slg = 0
    for row_slg in dest_sheet_slg[dest_start_slg:dest_end_slg]:
        for cell_slg in row_slg:
            if dest_index_slg < len(source_values_slg):
                cell_slg.value = source_values_slg[dest_index_slg]
                dest_index_slg += 1
            else:
                break

def load_data_from_excel():
    workbook = openpyxl.Workbook()
    sheet = workbook.active
    sheet['A1'] = 'Hour'
    sheet['B1'] = 'Lapaz'
    sheet['C1'] = 'Jaro'
    sheet['D1'] = 'Mandurriao'
    sheet['E1'] = 'Molo'
    sheet['F1'] = 'Diversion'
    sheet['G1'] = 'Mobile SS 1'
    sheet['H1'] = 'Mobile SS 2'
    sheet['I1'] = 'Megaworld'
    workbook.save('station_load_graph.xlsx')
    workbook.close()
    print("Excel file 'station_load_graph.xlsx' created successfully.")

    # File path for destination Excel file
    # destination_file_path_slg = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load_graph.xlsx'
    destination_file_path_slg = 'station_load_graph.xlsx'
    # destination_file_path_slg = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load_graph.xlsx'
    # source_file_path_slg = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load.xlsx'
    source_file_path_slg = 'station_load.xlsx'
    # source_file_path_slg = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load.xlsx'
    # Load source workbook
    source_wb_slg = load_workbook(source_file_path_slg)  
    # Sheet name of the source workbook
    source_sheet_slg = source_wb_slg['Sheet1']

    # Load destination workbook
    dest_wb_slg = load_workbook(destination_file_path_slg)

    # Sheet name of the destination workbook
    dest_sheet_slg = dest_wb_slg['Sheet']

    # Define source and destination ranges
    source_ranges_slg = [('B2', 'B25'), ('C2', 'C25'), ('D2', 'D25'), ('E2', 'E25'), ('F2', 'F25'), ('G2', 'G25'), ('H2', 'H25'), ('I2', 'I25'), ('J2', 'J25')]
    dest_ranges_slg = [('A2', 'A25'), ('B2', 'B25'), ('C2', 'C25'), ('D2', 'D25'), ('E2', 'E25'), ('F2', 'F25'), ('G2', 'G25'), ('H2', 'H25'), ('I2', 'I25')]
    
    # Copy data from source to destination based on specified ranges
    for i in range(len(source_ranges_slg)):
        copy_values_slg(source_sheet_slg, dest_sheet_slg, source_ranges_slg[i], dest_ranges_slg[i])
    
    # Save the destination workbook
    dest_wb_slg.save(destination_file_path_slg)

    # Read the Excel file into a Pandas Dataframe
   # file_path = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load_graph.xlsx"
    file_path = 'station_load_graph.xlsx'
    # file_path = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load_graph.xlsx"
    df = pd.read_excel(file_path)

    # Connect to the MySQL Database
    try:
        connection = mysql.connector.connect(
            host='cesra-db.cxkuksua06qz.ap-southeast-1.rds.amazonaws.com',
            database='myDb',
            user='cesra_dbm',
            password='ibIDN0NcnGYo71qDZuHw',
            port=3309
        )

        if connection.is_connected():
            print("Successfully connected to the database")
            cursor = connection.cursor()

            # Create a table
            table_name = 'station_load_graph'
            create_table_query = f"""
            CREATE TABLE IF NOT EXISTS {table_name} (
                id INT AUTO_INCREMENT PRIMARY KEY,
                Hour INT(11) NOT NULL,
                Lapaz INT(11) NOT NULL,
                Jaro INT(11) NOT NULL,
                Mandurriao INT(11) NOT NULL,
                Molo INT(11) NOT NULL,
                Diversion INT(11) NOT NULL,
                `Mobile SS 1` INT(11) NOT NULL,
                `Mobile SS 2` INT(11) NOT NULL,
                Megaworld INT(11) NOT NULL
            )
            """

            cursor.execute(create_table_query)
            print("Table created successfully or table already exists")

            # Insert data from dataframe into the MySQL table
            for i, row in df.iterrows():
                sql = f"INSERT INTO {table_name} (Hour, Lapaz, Jaro, Mandurriao, Molo, Diversion, `Mobile SS 1`, `Mobile SS 2`, Megaworld) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s)"
                cursor.execute(sql, tuple(row))
                print(f"Inserted row {i + 1}")

            # Commit the transaction
            connection.commit()
            print("Data committed to the database")

    except Error as e:
        print(f"Error: {e}")

    finally:
        if connection.is_connected():
            cursor.close()
            connection.close()
            print("MySQL connection is closed.")

    # Read the Excel file
    # file_path = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load_graph.xlsx"
    file_path = 'station_load_graph.xlsx'
    # file_path = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load_graph.xlsx"
    df = pd.read_excel(file_path, sheet_name='Sheet')
    return df

# Calculates the average of every 12 values in a list and stores them
def average_every_12(data):
    averages = []
    for i in range(0, len(data), 12):
        window = data[i:i+12]
        if window:
            averages.append(sum(window)/len(window))
    # Returns a list containing the averages for each 12-element window
    return averages

# Function to copy values from source range to destination range
def copy_values(source_sheet, dest_sheet, source_range, dest_range):
    source_start, source_end = source_range
    dest_start, dest_end = dest_range
    
    # Copy values from source to destination
    source_values = []
    for row in source_sheet[source_start:source_end]:
        for cell in row:
            source_values.append(cell.value)
    
    dest_index = 0
    for row in dest_sheet[dest_start:dest_end]:
        for cell in row:
            if dest_index < len(source_values):
                cell.value = source_values[dest_index]
                dest_index += 1
            else:
                break

# Helper function to format numbers in 'k' or 'M' style with two decimal places
def format_value(value):
    if value >= 1_000_000:
        return f'{value / 1_000_000:.2f}M'  # Format to millions with two decimal places
    elif value >= 1_000:
        return f'{value / 1_000:.2f}k'  # Format to thousands with two decimal places
    else:
        return f'{value:.2f}'  # Format with two decimal places for values less than 1,000

def format_value_2(value):
    # Format the value to always show two decimal places
    return f'{value:,.2f}'  

# def sub_load_func():
#     # -- START OF DISPLAYING THE SUBSTATION LOAD (KW) BAR CHART -- 

#         # Load data
#         df_excel = load_data_from_excel()

#         # For getting the current hour
#         now = datetime.now()
#         now_hour = now.hour
#         if now_hour == 0:
#             now_hour = 24

#         # Find the row where the hour matches the current hour
#         matching_row = df_excel[df_excel['Hour'] == now_hour]

#         # Check if there's no matching data for the current hour
#         if matching_row.empty:
#             # If no data for the current hour, get the latest available data
#             matching_row = df_excel.iloc[-1]  # Get the last row in the DataFrame
#         else:
#             matching_row = matching_row.iloc[0]  # Get the first row matching the current hour

#         # Extract the values
#         hour_value = matching_row['Hour']
#         lapaz_value = matching_row['Lapaz']
#         jaro_value = matching_row['Jaro']
#         mandurriao_value = matching_row['Mandurriao']
#         molo_value = matching_row['Molo']
#         diversion_value = matching_row['Diversion']
#         mobile_ss1_value = matching_row['Mobile SS 1']
#         mobile_ss2_value = matching_row['Mobile SS 2']
#         megaworld_value = matching_row['Megaworld']

#         # Prepare data for the bar chart
#         chart_data = pd.DataFrame({
#             'Substation': ['Lapaz', 'Jaro', 'Mandurriao', 'Molo', 'Diversion', 'Mobile SS 1', 'Mobile SS 2', 'Megaworld'],
#             'kW': [lapaz_value, jaro_value, mandurriao_value, molo_value, diversion_value, mobile_ss1_value, mobile_ss2_value, megaworld_value]
#         })

#         # Create the horizontal bar chart with Plotly
#         fig_ss_load = px.bar(chart_data, y='Substation', x='kW', text='kW', orientation='h')

#         # Customize the bar colors
#         # Red, Green, Light Blue, Dark Blue, Yellow, Pink, Purple, Brown
#         colors = ['#cc3333', '#228B22', '#ADD8E6', '#4682B4', '#FFDB58', '#FFC0CB', '#C3B1E1', '#C19A6B']
#         fig_ss_load.update_traces(marker_color=colors)

#         # Customize the layout
#         fig_ss_load.update_traces(
#             texttemplate='%{x:,.0f}',  # Format numbers with thousands separators and no decimal places
#             textposition='outside',
#             textfont_size=12  # Reduce text size if needed
#         )

#         # Add padding by adjusting the layout
#         fig_ss_load.update_layout(
#             title={
#                 'text':'Substation Load (kW)',
#                 'font':{
#                     'color': 'white' # Set title color to white
#                 }
#             },
#             margin=dict(r=30, t=30, b=15),  # Increase margins further
#             xaxis=dict(
#                 title='kW',
#                 tickformat=',',  # Format axis ticks with commas as thousands separators
#                 showgrid=False,
#                 zeroline=False,
#                 range=[0, max(chart_data['kW']) * 1.2]  # Extend the x-axis range further
#             ),
#             uniformtext_minsize=8,
#             uniformtext_mode='hide',
#             height=240  # Set the height of the bar chart
#         )

#         fig_ss_load.update_layout(
#             plot_bgcolor='black',
#             paper_bgcolor='black'
#         )

#         return fig_ss_load

#         # -- END OF DISPLAYING THE SUBSTATION LOAD (KW) BAR CHART -- 

def sub_load_func():
    # -- START OF DISPLAYING THE SUBSTATION LOAD (KW) BAR CHART -- 

    # Load data
    df_excel = load_data_from_excel()

    # For getting the current hour
    now = datetime.now()
    now_hour = now.hour
    if now_hour == 0:
        now_hour = 24

    # Find the row where the hour matches the current hour
    matching_row = df_excel[df_excel['Hour'] == now_hour]

    # Check if there's no matching data for the current hour
    if matching_row.empty:
        # If no data for the current hour, get the latest available data
        matching_row = df_excel.iloc[-1]  # Get the last row in the DataFrame
    else:
        matching_row = matching_row.iloc[0]  # Get the first row matching the current hour

    # Extract the values
    hour_value = matching_row['Hour']
    lapaz_value = matching_row['Lapaz']
    jaro_value = matching_row['Jaro']
    mandurriao_value = matching_row['Mandurriao']
    molo_value = matching_row['Molo']
    diversion_value = matching_row['Diversion']
    mobile_ss1_value = matching_row['Mobile SS 1']
    mobile_ss2_value = matching_row['Mobile SS 2']
    megaworld_value = matching_row['Megaworld']

    # Prepare data for the bar chart
    chart_data = pd.DataFrame({
        'Substation': ['Lapaz', 'Jaro', 'Mandurriao', 'Molo', 'Diversion', 'Mobile SS 1', 'Mobile SS 2', 'Megaworld'],
        'kW': [lapaz_value, jaro_value, mandurriao_value, molo_value, diversion_value, mobile_ss1_value, mobile_ss2_value, megaworld_value]
    })

    # # Sort data by 'kW' values in ascending order
    # chart_data = chart_data.sort_values(by='kW', ascending=True)

    # Modify the labels for Molo and Mobile SS 1
    chart_data['Label'] = chart_data.apply(lambda row: (
        'Loaned to NEPC' if row['Substation'] == 'Mobile SS 1' else
        # 'On Standby' if row['Substation'] == 'Mobile SS 2' else
        f"{row['kW']:,.0f}" if row['kW'] != 0 else ''
    ), axis=1)

    # # Add priority column to control the order of Mobile SS 1 and Mobile SS 2
    # chart_data['Priority'] = chart_data['Substation'].apply(lambda x: 1 if x == 'Mobile SS 1' else (2 if x == 'Mobile SS 2' else 3))

    # Add Priority column where 'Mobile SS 1' is 1 and the rest is 2
    chart_data['Priority'] = chart_data['Substation'].apply(lambda x: 1 if x == 'Mobile SS 1' else 2)

    # Sort data by 'Priority' and 'kW' values (Molo and Mobile SS 1 first, then by kW)
    chart_data = chart_data.sort_values(by=['Priority', 'kW'], ascending=[True, True])

    # Create the horizontal bar chart with Plotly
    fig_ss_load = px.bar(chart_data, y='Substation', x='kW', text='Label', orientation='h',
                         color='Substation',
                         color_discrete_map={
                             'Lapaz': '#cc3333',         # Red
                             'Jaro': '#228B22',          # Green
                             'Mandurriao': '#ADD8E6',    # Light Blue
                             'Molo': '#4682B4',          # Dark Blue
                             'Diversion': '#FFDB58',     # Yellow
                             'Mobile SS 1': '#FFC0CB',   # Pink
                             'Mobile SS 2': '#C3B1E1',   # Purple
                             'Megaworld': '#C19A6B'      # Brown
                         })

    # Customize the layout
    fig_ss_load.update_traces(
        texttemplate='%{text}',  # Format numbers with thousands separators and no decimal places
        textposition='outside',
        textfont_size=12  # Reduce text size if needed
    )

    # Add padding by adjusting the layout
    fig_ss_load.update_layout(
        title={
            'text': 'Substation Load (kW)',
            'font': {
                'color': 'white'  # Set title color to white
            }
        },
        margin=dict(r=30, t=30, b=15),  # Increase margins further
        xaxis=dict(
            title='kW',
            tickformat=',',  # Format axis ticks with commas as thousands separators
            showgrid=False,
            zeroline=False,
            range=[0, max(chart_data['kW']) * 1.2]  # Extend the x-axis range further
        ),
        showlegend=False,
        uniformtext_minsize=8,
        uniformtext_mode='hide',
        height=270  # Set the height of the bar chart
    )

    fig_ss_load.update_layout(
        plot_bgcolor='black',
        paper_bgcolor='black'
    )

    return fig_ss_load

# #NEWER VER
# def actual_vs_forecasted():
#     # -- START OF DISPLAYING THE ACTUAL VS FORECASTED ENERGY CHART --

#     # File paths
#     station_load_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load_graph.xlsx'
#     bcq_nomination_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\total_bcq_nomination.xlsx'
#     forecasted_energy_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\forecasted_energy.xlsx'
#     actual_energy_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\actual_energy.xlsx'

#     # Load Actual Energy data
#     actual_energy_wb = openpyxl.load_workbook(actual_energy_destination_path)
#     actual_energy_sheet = actual_energy_wb.active
#     actual_energy_values = []

#     now = datetime.now()
#     current_hour = now.hour
#     if current_hour == 0:
#         current_hour = 24

#     for i in range(2, current_hour + 2):
#         ae_value = actual_energy_sheet[f'D{i}'].value
#         actual_energy_values.append(ae_value)

#     # Read the station load data into a DataFrame
#     df = pd.read_excel(station_load_destination_path)

#     data = {'Hour': list(range(1, 25))}
#     stations = {
#         'Lapaz': '#cc3333',
#         'Jaro': '#228B22',
#         'Mandurriao': '#ADD8E6',
#         'Molo': '#4682B4',
#         'Diversion': '#FFDB58',
#         'Mobile SS 1': '#FFC0CB',
#         'Mobile SS 2': '#C3B1E1',
#         'Megaworld': '#C19A6B'
#     }

#     # Add station values for each hour
#     for station in stations.keys():
#         data[station] = [safe_get(df, hour - 1, station) for hour in data['Hour']]

#     # Calculate total values
#     data['Total'] = [sum(data[station][hour - 1] for station in stations.keys()) for hour in data['Hour']]

#     result_df = pd.DataFrame(data)

#     fig = go.Figure()

#     # Add each station as a bar trace
#     for station, color in stations.items():
#         fig.add_trace(go.Bar(
#             x=result_df['Hour'],
#             y=[value * 0.9 for value in result_df[station]],  # Lower the bar heights slightly
#             name=station,
#             marker_color=color
#         ))

#     # Forecasted and BCQ traces
#     df_2 = pd.read_excel(forecasted_energy_destination_path)
#     df_3 = pd.read_excel(bcq_nomination_destination_path)

#     # Create combined hover text with all substations, Actual Energy, Forecasted Energy, BCQ Nomination, and Total Substation Load
#     hover_text = []
#     for i, hour in enumerate(result_df['Hour']):
#         if hour >= current_hour:  # Only include hover text for the current hour and beyond
#             # Format the hover text for each hour
#             hover_text.append(
#                 f"Hour: {hour}<br>"
#                 + f"Actual Energy: {format_value_2(float(actual_energy_values[i]))}<br>"
#                 + "<br>".join([f"{station}: {format_value_2(result_df[station][i])}" for station in stations.keys()])
#                 + f"<br>Total Substation Load: {format_value_2(result_df['Total'][i])}<br>"
#                 + f"BCQ Nomination: {format_value_2(df_3['TOTAL_BCQ'].iloc[i])}<br>"
#                 + f"Forecasted Energy: {format_value_2(df_2['NET'].iloc[i])}"
#             )
#         else:
#             hover_text.append('')

#     # Add hover information as a single box at the current hour
#     fig.add_trace(go.Scatter(
#         x=result_df['Hour'],
#         y=[result_df['Total'][i] * 0.92 for i in range(len(result_df['Hour']))],
#         mode='markers',
#         marker=dict(size=0),  # Make the markers invisible
#         text=hover_text,
#         hoverinfo='text'
#     ))

#     # Add actual energy values as text annotations on top of the bars
#     for i, hour in enumerate(result_df['Hour']):
#         if hour % 2 != 0 and i < len(actual_energy_values) and hour <= current_hour:
#             formatted_value = format_value(int(actual_energy_values[i]))
#             fig.add_trace(go.Scatter(
#                 x=[hour],
#                 y=[result_df['Total'][i] * 0.92],  # Position text slightly above the adjusted bar height
#                 mode='text',
#                 text=[formatted_value],
#                 textposition='top center',
#                 showlegend=False,
#                 textfont=dict(size=10, color='white'),  # Adjust font size and color for better visibility
#             ))

#     # Add Forecasted Energy trace
#     fig.add_trace(go.Scatter(
#         x=df_2['HOUR'],
#         y=df_2['NET'],
#         mode='lines',
#         name='Forecasted Energy',
#         line=dict(color='white')
#     ))

#     # Add BCQ Nomination trace
#     fig.add_trace(go.Scatter(
#         x=df_3['HOUR'],
#         y=df_3['TOTAL_BCQ'],
#         mode='lines+markers',
#         name='BCQ Nomination',
#         line=dict(color='#76448a')
#     ))

#     # Update layout
#     fig.update_layout(
#         title={
#             'text': 'Actual vs Forecasted Energy (kWh)',
#             'font': {'color': 'white'}
#         },
#         margin=dict(l=0, r=0, t=30, b=0),
#         xaxis_title='Interval',
#         yaxis_title='kWh',
#         xaxis=dict(
#             tickmode='array',
#             tickvals=list(range(1, 25)),
#             ticktext=[str(i) for i in range(1, 25)]
#         ),
#         yaxis_tickformat=',',
#         plot_bgcolor='black',
#         paper_bgcolor='black',
#         barmode='stack',
#         height=270
#     )

#     return fig

# NEW VER
def actual_vs_forecasted():
    # -- START OF DISPLAYING THE ACTUAL VS FORECASTED ENERGY CHART --
    # station_load_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load_graph.xlsx'
    station_load_destination_path = 'station_load_graph.xlsx'
    #station_load_destination_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load_graph.xlsx'
    # bcq_nomination_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\total_bcq_nomination.xlsx'
    bcq_nomination_destination_path = 'total_bcq_nomination.xlsx'
    #bcq_nomination_destination_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\total_bcq_nomination.xlsx'
    # forecasted_energy_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\forecasted_energy.xlsx'
    forecasted_energy_destination_path = 'forecasted_energy.xlsx'
    #forecasted_energy_destination_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\forecasted_energy.xlsx'
    # actual_energy_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\actual_energy.xlsx'
    actual_energy_destination_path = 'actual_energy.xlsx'
    #actual_energy_destination_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\actual_energy.xlsx'


    # # File paths
    # station_load_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load_graph.xlsx'
    # bcq_nomination_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\total_bcq_nomination.xlsx'
    # forecasted_energy_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\forecasted_energy.xlsx'
    # actual_energy_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\actual_energy.xlsx'

    # Load Actual Energy data
    actual_energy_wb = openpyxl.load_workbook(actual_energy_destination_path)
    actual_energy_sheet = actual_energy_wb.active
    actual_energy_values = []

    now = datetime.now()
    current_hour = now.hour
    if current_hour == 0:
        current_hour = 24

    for i in range(2, current_hour + 2):
        ae_value = actual_energy_sheet[f'D{i}'].value
        actual_energy_values.append(ae_value)

    # Read the station load data into a DataFrame
    df = pd.read_excel(station_load_destination_path)

    data = {'Hour': list(range(1, 25))}
    stations = {
        'Lapaz': '#cc3333',
        'Jaro': '#228B22',
        'Mandurriao': '#ADD8E6',
        'Molo': '#4682B4',
        'Diversion': '#FFDB58',
        'Mobile SS 1': '#FFC0CB',
        'Mobile SS 2': '#C3B1E1',
        'Megaworld': '#C19A6B'
    }

    # Add station values for each hour
    for station in stations.keys():
        data[station] = [safe_get(df, hour - 1, station) for hour in data['Hour']]

    # Calculate total values
    data['Total'] = [sum(data[station][hour - 1] for station in stations.keys()) for hour in data['Hour']]

    result_df = pd.DataFrame(data)

    fig = go.Figure()

    # Add each station as a bar trace
    for station, color in stations.items():
        fig.add_trace(go.Bar(
            x=result_df['Hour'],
            y=[value * 0.9 for value in result_df[station]],  # Lower the bar heights slightly
            name=station,
            marker_color=color,
            hoverinfo="skip"
        ))

    # Forecasted and BCQ traces
    df_2 = pd.read_excel(forecasted_energy_destination_path)
    df_3 = pd.read_excel(bcq_nomination_destination_path)

    # Create combined hover text with all substations, Actual Energy, Forecasted Energy, BCQ Nomination, and Total Substation Load
    hover_text = []
    for i, hour in enumerate(result_df['Hour']):
        if hour <= current_hour:
            # Format the hover text for each hour
            hover_text.append(
                f"Hour: {hour}<br>"
                + f"BCQ Nomination: {format_value_2(df_3['TOTAL_BCQ'].iloc[i])}<br>"
                + f"Forecasted Energy: {format_value_2(df_2['NET'].iloc[i])}<br>"
                + f"Actual Energy: {format_value_2(float(actual_energy_values[i]))}<br>"
                + f"Total Substation Load: {format_value_2(result_df['Total'][i])}<br>"
                + "<br>".join([f"{station}: {format_value_2(result_df[station][i])}" for station in stations.keys()])
            )
        else:
            hover_text.append(
                f"Hour: {hour}<br>"
                + f"BCQ Nomination: {format_value_2(df_3['TOTAL_BCQ'].iloc[i])}<br>"
                + f"Forecasted Energy: {format_value_2(df_2['NET'].iloc[i])}"
            )

    # Add hover information at the top of the bars
    fig.add_trace(go.Scatter(
        x=result_df['Hour'],
        y=[result_df['Total'][i] * 0.92 for i in range(len(result_df['Hour']))],
        mode='lines',
        line=dict(width=0),
        text=hover_text,
        textposition='top center',
        hoverinfo='text',
        name=''
    ))

    # Add actual energy values as text annotations on top of the bars
    for i, hour in enumerate(result_df['Hour']):
        #if i%2 == 0 and i < len(actual_energy_values) and hour <= current_hour:
        if hour%2 != 0 and i < len(actual_energy_values) and hour <= current_hour:
            formatted_value = format_value(int(actual_energy_values[i]))
            fig.add_trace(go.Scatter(
                x=[hour],
                y=[result_df['Total'][i] * 0.92],  # Position text slightly above the adjusted bar height
                mode='text',
                text=[formatted_value],
                textposition='top center',
                showlegend=False,
                textfont=dict(size=10, color='white'),  # Adjust font size and color for better visibility
                hoverinfo="skip"
            ))

    # Add Forecasted Energy trace
    fig.add_trace(go.Scatter(
        x=df_2['HOUR'],
        y=df_2['NET'],
        mode='lines',
        name='Forecasted Energy',
        line=dict(color='white'),
        hoverinfo="skip"
    ))

    # Add BCQ Nomination trace
    fig.add_trace(go.Scatter(
        x=df_3['HOUR'],
        y=df_3['TOTAL_BCQ'],
        mode='lines+markers',
        name='BCQ Nomination',
        line=dict(color='#76448a'),
        hoverinfo="skip"
    ))

    # Update layout
    fig.update_layout(
        title={
            'text': 'Actual vs Forecasted Energy (kWh)',
            'font': {'color': 'white'}
        },
        margin=dict(l=0, r=0, t=30, b=0),
        xaxis_title='Interval',
        yaxis_title='kWh',
        xaxis=dict(
            tickmode='array',
            tickvals=list(range(1, 25)),
            ticktext=[str(i) for i in range(1, 25)]
        ),
        yaxis_tickformat=',',
        plot_bgcolor='black',
        paper_bgcolor='black',
        barmode='stack',
        height=270
    )

    return fig

# # OLD VER
# def actual_vs_forecasted():
#     # -- START OF DISPLAYING THE ACTUAL VS FORECASTED ENERGY CHART --

#         # File paths
#         station_load_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load_graph.xlsx'
#         # station_load_destination_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\station_load_graph.xlsx'
#         bcq_nomination_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\total_bcq_nomination.xlsx'
#         # bcq_nomination_destination_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\total_bcq_nomination.xlsx'
#         forecasted_energy_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\forecasted_energy.xlsx'
#         # forecasted_energy_destination_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\forecasted_energy.xlsx'
#         actual_energy_destination_path = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\actual_energy.xlsx'
#         # actual_energy_destination_path = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\actual_energy.xlsx'
#         # Load Actual Energy data
#         actual_energy_wb = openpyxl.load_workbook(actual_energy_destination_path)
#         actual_energy_sheet = actual_energy_wb.active
#         actual_energy_values = []  # Initialize Actual Energy list

#         now = datetime.now()
#         current_hour = now.hour
#         if current_hour == 0:
#             current_hour = 24

#         # Create a list of actual energy values for current hour backwards
#         for i in range(2, current_hour + 2):
#             ae_value = actual_energy_sheet[f'D{i}'].value
#             actual_energy_values.append(ae_value)

#         # Read the station load data into a DataFrame
#         df = pd.read_excel(station_load_destination_path)

#         # Initialize a dictionary to store the results
#         data = {'Hour': list(range(1, 25))}
#         # # Orange, Green, Light Blue, Dark Blue, Yellow, Pink, Purple, Brown
#         # colors = ['#E3963E', '#228B22', '#ADD8E6', '#4682B4', '#FFDB58', '#FFC0CB', '#C3B1E1', '#C19A6B']
#         # List of stations and their corresponding colors
#         stations = {
#             'Lapaz': '#cc3333',
#             'Jaro': '#228B22',
#             'Mandurriao': '#ADD8E6',
#             'Molo': '#4682B4',
#             'Diversion': '#FFDB58',
#             'Mobile SS 1': '#FFC0CB',
#             'Mobile SS 2': '#C3B1E1',
#             'Megaworld': '#C19A6B'
#         }

#         # Loop through each station and add their hourly values to the dictionary
#         for station in stations.keys():
#             data[station] = [safe_get(df, hour - 1, station) for hour in data['Hour']]

#         # Calculate total values for each hour
#         data['Total'] = [sum(data[station][hour - 1] for station in stations.keys()) for hour in data['Hour']]

#         # Convert the dictionary to a DataFrame
#         result_df = pd.DataFrame(data)

#         # Create a Figure object for the plot
#         fig = go.Figure()

#         # Add each station as a bar trace with specified colors
#         for station, color in stations.items():
#             fig.add_trace(go.Bar(
#                 x=result_df['Hour'],
#                 y=[value * 0.9 for value in result_df[station]],  # Lower the bar heights slightly
#                 name=station,
#                 marker_color=color
#         ))

#         # Add total as a scatter trace with a straight line
#         df_2 = pd.read_excel(forecasted_energy_destination_path)
#         fig.add_trace(go.Scatter(
#             x=df_2['HOUR'],
#             y=df_2['NET'],
#             mode='lines',
#             name='Forecasted Energy',
#             line=dict(color='white')
#         ))

#         # Add a crooked line for demonstration
#         df_3 = pd.read_excel(bcq_nomination_destination_path)
#         fig.add_trace(go.Scatter(
#             x=df_3['HOUR'],
#             y=df_3['TOTAL_BCQ'],
#             mode='lines+markers',
#             name='BCQ Nomination',
#             line=dict(color='#76448a')
#         ))

#         # Update layout with x and y axis labels and custom y-axis formatting
#         fig.update_layout(
#             title={
#                 'text':'Actual vs Forecasted Energy (kWh)',
#                 'font':{
#                     'color': 'white' # Set title color to white
#                 }
#             },
#             margin=dict(l=0, r=0, t=30, b=0),  # Adjust margins to fit small screens
#             xaxis_title='Interval',
#             yaxis_title='kWh',
#             xaxis=dict(
#                 tickmode='array',
#                 tickvals=list(range(1, 25)),
#                 ticktext=[str(i) for i in range(1, 25)]
#             ),
#             yaxis_tickformat=',',  # Format y-axis to use commas for thousands
#             plot_bgcolor='black',
#             paper_bgcolor='black',
#             barmode='stack',
#             height=270  # Maintain the height at 260
#         )

#         # Add actual energy values as text annotations on top of the bars
#         for i, hour in enumerate(result_df['Hour']):
#             #if i%2 == 0 and i < len(actual_energy_values) and hour <= current_hour:
#             if hour%2 != 0 and i < len(actual_energy_values) and hour <= current_hour:
#                 formatted_value = format_value(int(actual_energy_values[i]))
#                 fig.add_trace(go.Scatter(
#                     x=[hour],
#                     y=[result_df['Total'][i] * 0.92],  # Position text slightly above the adjusted bar height
#                     mode='text',
#                     text=[formatted_value],
#                     textposition='top center',
#                     showlegend=False,
#                     textfont=dict(size=10, color='white')  # Adjust font size and color for better visibility
#                 ))

#         # Add hover information at the top of the bars
#         hover_text = [
#             f"Actual Energy: {format_value_2(float(actual_energy_values[hour - 1]))}" if hour <= current_hour else ''
#             for hour in result_df['Hour']
#         ]

#         fig.add_trace(go.Scatter(
#             x=result_df['Hour'],
#             y=[result_df['Total'][i] * 0.92 for i in range(len(result_df['Hour']))],
#             mode='lines',
#             line=dict(width=0),
#             text=hover_text,
#             textposition='top center',
#             hoverinfo='text',
#             name='Actual Energy'
#         ))

#         return fig

#         # -- END OF DISPLAYING THE ACTUAL VS FORECASTED ENERGY CHART --

def tipc_func():
            # -- START OF TRADING INTERVAL PRICE CALCULATION LINE CHART --

        # directory = r'C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\MORE Trading Node'
        directory = r'MORE Trading Node'
        # directory = r'E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\MORE Trading Node'
        now = datetime.now()
        date_today = now.strftime("%Y%m%d")
        contents = os.listdir(directory)
        for item in contents:
            if item == date_today:
                folder_path = os.path.join(directory, item) 
                if os.path.isdir(folder_path):
                    files_in_folder = os.listdir(folder_path) # MPI_LMP_DIPC_202407110000, etc.
                    
                    last_known_value = None

                    # list_botoca_g01 = []
                    list_calaca_g01 = []
                    list_calaca_g02 = []
                    # list_kal_g01 = []
                    # list_kal_g02 = []
                    # list_kal_g03 = []
                    # list_kal_g04 = []
                    list_leyte_a = []
                    list_kspc_g01 = []
                    list_kspc_g02 = []
                    list_bantap_l01 = []
                    list_pedc_t1l1 = []
                    list_pedc_t1l2 = []
                    list_stbar_t1l1 = []
                    list_pedc_u01 = []
                    list_pedc_u02 = []
                    list_pedc_u03 = []

                    # results_botoca_g01 = []
                    results_calaca_g01 = []
                    results_calaca_g02 = []
                    # results_kal_g01 = []
                    # results_kal_g02 = []
                    # results_kal_g03 = []
                    # results_kal_g04 = []
                    results_leyte_a = []
                    results_kspc_g01 = []
                    results_kspc_g02 = []
                    results_bantap_l01 = []
                    results_pedc_t1l1 = []
                    results_pedc_t1l2 = []
                    results_stbar_t1l1 = []
                    results_pedc_u01 = []
                    results_pedc_u02 = []
                    results_pedc_u03 = []
                    
                    # # 03BOTOCA_G01
                    # for i in range(1, len(files_in_folder)):
                        
                    #     filepath = os.path.join(folder_path, files_in_folder[i]) 

                    #     try: 
                    #         df = pd.read_csv(filepath)
                    #     except pd.errors.EmptyDataError:
                    #         if last_known_value is not None:
                    #             list_botoca_g01.append(last_known_value)
                    #         continue
                    #     except IndexError:
                    #         break
                            
                    #     try: 
                    #         search_value = '03BOTOCA_G01'
                    #         matching_row = df[df['RESOURCE_NAME'] == search_value]
                    #         if not matching_row.empty:

                    #             file_03BOTOCA_G01 = matching_row['DIPC_PRICE'].values[0]
                    #             list_botoca_g01.append(file_03BOTOCA_G01)
                    #             last_known_value = file_03BOTOCA_G01
                    #         else:
                    #             # If no matching row is found, use the last known value
                    #             if last_known_value is not None:
                    #                 list_botoca_g01.append(last_known_value)
                    #     except KeyError:
                    #         # If RESOURCE_NAME column is missing, use the last known value
                    #         if last_known_value is not None:
                    #             list_botoca_g01.append(last_known_value)
                    #         continue
                            
                    # 03CALACA_G01
                    for i in range(1, len(files_in_folder)):

                        filepath = os.path.join(folder_path, files_in_folder[i]) 

                        try: 
                            df = pd.read_csv(filepath)
                        except pd.errors.EmptyDataError:
                            if last_known_value is not None:
                                list_calaca_g01.append(last_known_value)
                            continue
                        except IndexError:
                            break
                        try: 
                            search_value = '03CALACA_G01'
                            matching_row = df[df['RESOURCE_NAME'] == search_value]
                            if not matching_row.empty:

                                file_03CALACA_G01 = matching_row['DIPC_PRICE'].values[0]
                                list_calaca_g01.append(file_03CALACA_G01)
                                last_known_value = file_03CALACA_G01
                            else:
                                # If no matching row is found, use the last known value
                                if last_known_value is not None:
                                    list_calaca_g01.append(last_known_value)
                        except KeyError:
                            # If RESOURCE_NAME column is missing, use the last known value
                            if last_known_value is not None:
                                list_calaca_g01.append(last_known_value)
                            continue
                        
                    # 03CALACA_G02
                    for i in range(1, len(files_in_folder)):
                        filepath = os.path.join(folder_path, files_in_folder[i]) 

                        try: 
                            df = pd.read_csv(filepath)
                        except pd.errors.EmptyDataError:
                            if last_known_value is not None:
                                list_calaca_g02.append(last_known_value)
                            continue
                        except IndexError:
                            break
                        try: 
                            search_value = '03CALACA_G02'
                            matching_row = df[df['RESOURCE_NAME'] == search_value]
                            if not matching_row.empty:
                                file_03CALACA_G02 = matching_row['DIPC_PRICE'].values[0]
                                list_calaca_g02.append(file_03CALACA_G02)
                                last_known_value = file_03CALACA_G02
                            else:
                                # If no matching row is found, use the last known value
                                if last_known_value is not None:
                                    list_calaca_g02.append(last_known_value)
                        except KeyError:
                            # If RESOURCE_NAME column is missing, use the last known value
                            if last_known_value is not None:
                                list_calaca_g02.append(last_known_value)
                            continue
                    
                    # # 03KAL_G01
                    # for i in range(1, len(files_in_folder)):
                    #     filepath = os.path.join(folder_path, files_in_folder[i]) 

                    #     try: 
                    #         df = pd.read_csv(filepath)
                    #     except pd.errors.EmptyDataError:
                    #         if last_known_value is not None:
                    #             list_kal_g01.append(last_known_value)
                    #         continue
                    #     except IndexError:
                    #         break
                    #     try: 
                    #         search_value = '03KAL_G01'
                    #         matching_row = df[df['RESOURCE_NAME'] == search_value]
                    #         if not matching_row.empty:
                    #             file_03KAL_G01 = matching_row['DIPC_PRICE'].values[0]
                    #             list_kal_g01.append(file_03KAL_G01)
                    #             last_known_value = file_03KAL_G01
                    #         else:
                    #             # If no matching row is found, use the last known value
                    #             if last_known_value is not None:
                    #                 list_kal_g01.append(last_known_value)
                    #     except KeyError:
                    #         # If RESOURCE_NAME column is missing, use the last known value
                    #         if last_known_value is not None:
                    #             list_kal_g01.append(last_known_value)
                    #         continue
                    
                    # # 03KAL_G02
                    # for i in range(1, len(files_in_folder)):
                    #     filepath = os.path.join(folder_path, files_in_folder[i]) 

                    #     try: 
                    #         df = pd.read_csv(filepath)
                    #     except pd.errors.EmptyDataError:
                    #         if last_known_value is not None:
                    #             list_kal_g02.append(last_known_value)
                    #         continue
                    #     except IndexError:
                    #         break
                    #     try: 
                    #         search_value = '03KAL_G02'
                    #         matching_row = df[df['RESOURCE_NAME'] == search_value]
                    #         if not matching_row.empty:
                    #             file_03KAL_G02 = matching_row['DIPC_PRICE'].values[0]
                    #             list_kal_g02.append(file_03KAL_G02)
                    #             last_known_value = file_03KAL_G02
                    #         else:
                    #             # If no matching row is found, use the last known value
                    #             if last_known_value is not None:
                    #                 list_kal_g02.append(last_known_value)
                    #     except KeyError:
                    #         # If RESOURCE_NAME column is missing, use the last known value
                    #         if last_known_value is not None:
                    #             list_kal_g02.append(last_known_value)
                    #         continue
                    
                    # # 03KAL_G03
                    # for i in range(1, len(files_in_folder)):
                    #     filepath = os.path.join(folder_path, files_in_folder[i]) 

                    #     try: 
                    #         df = pd.read_csv(filepath)
                    #     except pd.errors.EmptyDataError:
                    #         if last_known_value is not None:
                    #             list_kal_g03.append(last_known_value)
                    #         continue
                    #     except IndexError:
                    #         break
                    #     try: 
                    #         search_value = '03KAL_G03'
                    #         matching_row = df[df['RESOURCE_NAME'] == search_value]
                    #         if not matching_row.empty:
                    #             file_03KAL_G03 = matching_row['DIPC_PRICE'].values[0]
                    #             list_kal_g03.append(file_03KAL_G03)
                    #             last_known_value = file_03KAL_G03
                    #         else:
                    #             # If no matching row is found, use the last known value
                    #             if last_known_value is not None:
                    #                 list_kal_g03.append(last_known_value)
                    #     except KeyError:
                    #         # If RESOURCE_NAME column is missing, use the last known value
                    #         if last_known_value is not None:
                    #             list_kal_g03.append(last_known_value)
                    #         continue
                    
                    # # 03KAL_G04
                    # for i in range(1, len(files_in_folder)):
                    #     filepath = os.path.join(folder_path, files_in_folder[i]) 

                    #     try: 
                    #         df = pd.read_csv(filepath)
                    #     except pd.errors.EmptyDataError:
                    #         if last_known_value is not None:
                    #             list_kal_g04.append(last_known_value)
                    #         continue
                    #     except IndexError:
                    #         break
                    #     try: 
                    #         search_value = '03KAL_G04'
                    #         matching_row = df[df['RESOURCE_NAME'] == search_value]
                    #         if not matching_row.empty:
                    #             file_03KAL_G04 = matching_row['DIPC_PRICE'].values[0]
                    #             list_kal_g04.append(file_03KAL_G04)
                    #             last_known_value = file_03KAL_G04
                    #         else:
                    #             # If no matching row is found, use the last known value
                    #             if last_known_value is not None:
                    #                 list_kal_g04.append(last_known_value)
                    #     except KeyError:
                    #         # If RESOURCE_NAME column is missing, use the last known value
                    #         if last_known_value is not None:
                    #             list_kal_g04.append(last_known_value)
                    #         continue
                    
                    # 04LEYTE_A
                    for i in range(1, len(files_in_folder)):
                        filepath = os.path.join(folder_path, files_in_folder[i]) 

                        try: 
                            df = pd.read_csv(filepath)
                        except pd.errors.EmptyDataError:
                            if last_known_value is not None:
                                list_leyte_a.append(last_known_value)
                            continue
                        except IndexError:
                            break
                        try: 
                            search_value = '04LEYTE_A'
                            matching_row = df[df['RESOURCE_NAME'] == search_value]
                            if not matching_row.empty:
                                file_04LEYTE_A = matching_row['DIPC_PRICE'].values[0]
                                list_leyte_a.append(file_04LEYTE_A)
                                last_known_value = file_04LEYTE_A
                            else:
                                # If no matching row is found, use the last known value
                                if last_known_value is not None:
                                    list_leyte_a.append(last_known_value)
                        except KeyError:
                            # If RESOURCE_NAME column is missing, use the last known value
                            if last_known_value is not None:
                                list_leyte_a.append(last_known_value)
                            continue
                    
                    # 05KSPC_G01
                    for i in range(1, len(files_in_folder)):
                        filepath = os.path.join(folder_path, files_in_folder[i]) 

                        try: 
                            df = pd.read_csv(filepath)
                        except pd.errors.EmptyDataError:
                            if last_known_value is not None:
                                list_kspc_g01.append(last_known_value)
                            continue
                        except IndexError:
                            break
                        try: 
                            search_value = '05KSPC_G01'
                            matching_row = df[df['RESOURCE_NAME'] == search_value]
                            if not matching_row.empty:
                                file_05KSPC_G01 = matching_row['DIPC_PRICE'].values[0]
                                list_kspc_g01.append(file_05KSPC_G01)
                                last_known_value = file_05KSPC_G01
                            else:
                                # If no matching row is found, use the last known value
                                if last_known_value is not None:
                                    list_kspc_g01.append(last_known_value)
                        except KeyError:
                            # If RESOURCE_NAME column is missing, use the last known value
                            if last_known_value is not None:
                                list_kspc_g01.append(last_known_value)
                            continue
                    
                    # 05KSPC_G02
                    for i in range(1, len(files_in_folder)):
                        filepath = os.path.join(folder_path, files_in_folder[i]) 

                        try: 
                            df = pd.read_csv(filepath)
                        except pd.errors.EmptyDataError:
                            if last_known_value is not None:
                                list_kspc_g02.append(last_known_value)
                            continue
                        except IndexError:
                            break
                        try: 
                            search_value = '05KSPC_G02'
                            matching_row = df[df['RESOURCE_NAME'] == search_value]
                            if not matching_row.empty:
                                file_05KSPC_G02 = matching_row['DIPC_PRICE'].values[0]
                                list_kspc_g02.append(file_05KSPC_G02)
                                last_known_value = file_05KSPC_G02
                            else:
                                # If no matching row is found, use the last known value
                                if last_known_value is not None:
                                    list_kspc_g02.append(last_known_value)
                        except KeyError:
                            # If RESOURCE_NAME column is missing, use the last known value
                            if last_known_value is not None:
                                list_kspc_g02.append(last_known_value)
                            continue
                    
                    # 08BANTAP_L01
                    for i in range(1, len(files_in_folder)):
                        filepath = os.path.join(folder_path, files_in_folder[i]) 

                        try: 
                            df = pd.read_csv(filepath)
                        except pd.errors.EmptyDataError:
                            if last_known_value is not None:
                                list_bantap_l01.append(last_known_value)
                            continue
                        except IndexError:
                            break
                        try: 
                            search_value = '08BANTAP_L01'
                            matching_row = df[df['RESOURCE_NAME'] == search_value]
                            if not matching_row.empty:
                                file_08BANTAP_L01 = matching_row['DIPC_PRICE'].values[0]
                                list_bantap_l01.append(file_08BANTAP_L01)
                                last_known_value = file_08BANTAP_L01
                            else:
                                # If no matching row is found, use the last known value
                                if last_known_value is not None:
                                    list_bantap_l01.append(last_known_value)
                        except KeyError:
                            # If RESOURCE_NAME column is missing, use the last known value
                            if last_known_value is not None:
                                list_bantap_l01.append(last_known_value)
                            continue

                    # 08PEDC_T1L1
                    for i in range(1, len(files_in_folder)):
                        filepath = os.path.join(folder_path, files_in_folder[i]) 

                        try: 
                            df = pd.read_csv(filepath)
                        except pd.errors.EmptyDataError:
                            if last_known_value is not None:
                                list_pedc_t1l1.append(last_known_value)
                            continue
                        except IndexError:
                            break
                        try: 
                            search_value = '08PEDC_T1L1'
                            matching_row = df[df['RESOURCE_NAME'] == search_value]
                            if not matching_row.empty:
                                file_08PEDC_T1L1 = matching_row['DIPC_PRICE'].values[0]
                                list_pedc_t1l1.append(file_08PEDC_T1L1)
                                last_known_value = file_08PEDC_T1L1
                            else:
                                # If no matching row is found, use the last known value
                                if last_known_value is not None:
                                    list_pedc_t1l1.append(last_known_value)
                        except KeyError:
                            # If RESOURCE_NAME column is missing, use the last known value
                            if last_known_value is not None:
                                list_pedc_t1l1.append(last_known_value)
                            continue

                    # 08PEDC_T1L2
                    for i in range(1, len(files_in_folder)):
                        filepath = os.path.join(folder_path, files_in_folder[i]) 

                        try: 
                            df = pd.read_csv(filepath)
                        except pd.errors.EmptyDataError:
                            if last_known_value is not None:
                                list_pedc_t1l1.append(last_known_value)
                            continue
                        except IndexError:
                            break
                        try: 
                            search_value = '08PEDC_T1L2'
                            matching_row = df[df['RESOURCE_NAME'] == search_value]
                            if not matching_row.empty:
                                file_08PEDC_T1L2 = matching_row['DIPC_PRICE'].values[0]
                                list_pedc_t1l2.append(file_08PEDC_T1L2)
                                last_known_value = file_08PEDC_T1L2
                            else:
                                # If no matching row is found, use the last known value
                                if last_known_value is not None:
                                    list_pedc_t1l2.append(last_known_value)
                        except KeyError:
                            # If RESOURCE_NAME column is missing, use the last known value
                            if last_known_value is not None:
                                list_pedc_t1l2.append(last_known_value)
                            continue
                    
                    # 08STBAR_T1L1
                    for i in range(1, len(files_in_folder)):
                        filepath = os.path.join(folder_path, files_in_folder[i]) 

                        try: 
                            df = pd.read_csv(filepath)
                        except pd.errors.EmptyDataError:
                            if last_known_value is not None:
                                list_stbar_t1l1.append(last_known_value)
                            continue
                        except IndexError:
                            break
                        try: 
                            search_value = '08STBAR_T1L1'
                            matching_row = df[df['RESOURCE_NAME'] == search_value]
                            if not matching_row.empty:
                                file_08STBAR_T1L1 = matching_row['DIPC_PRICE'].values[0]
                                list_stbar_t1l1.append(file_08STBAR_T1L1)
                                last_known_value = file_08STBAR_T1L1
                            else:
                                # If no matching row is found, use the last known value
                                if last_known_value is not None:
                                    list_stbar_t1l1.append(last_known_value)
                        except KeyError:
                            # If RESOURCE_NAME column is missing, use the last known value
                            if last_known_value is not None:
                                list_stbar_t1l1.append(last_known_value)
                            continue
                    
                    # 08PEDC_U01
                    for i in range(1, len(files_in_folder)):
                        filepath = os.path.join(folder_path, files_in_folder[i]) 

                        try: 
                            df = pd.read_csv(filepath)
                        except pd.errors.EmptyDataError:
                            if last_known_value is not None:
                                list_pedc_u01.append(last_known_value)
                            continue
                        except IndexError:
                            break
                        try: 
                            search_value = '08PEDC_U01'
                            matching_row = df[df['RESOURCE_NAME'] == search_value]
                            if not matching_row.empty:
                                file_08PEDC_U01 = matching_row['DIPC_PRICE'].values[0]
                                list_pedc_u01.append(file_08PEDC_U01)
                                last_known_value = file_08PEDC_U01
                            else:
                                # If no matching row is found, use the last known value
                                if last_known_value is not None:
                                    list_pedc_u01.append(last_known_value)
                        except KeyError:
                            # If RESOURCE_NAME column is missing, use the last known value
                            if last_known_value is not None:
                                list_pedc_u01.append(last_known_value)
                            continue

                    # 08PEDC_U02
                    for i in range(1, len(files_in_folder)):
                        filepath = os.path.join(folder_path, files_in_folder[i]) 

                        try: 
                            df = pd.read_csv(filepath)
                        except pd.errors.EmptyDataError:
                            if last_known_value is not None:
                                list_pedc_u02.append(last_known_value)
                            continue
                        except IndexError:
                            break
                        try: 
                            search_value = '08PEDC_U02'
                            matching_row = df[df['RESOURCE_NAME'] == search_value]
                            if not matching_row.empty:
                                file_08PEDC_U02 = matching_row['DIPC_PRICE'].values[0]
                                list_pedc_u02.append(file_08PEDC_U02)
                                last_known_value = file_08PEDC_U02
                            else:
                                # If no matching row is found, use the last known value
                                if last_known_value is not None:
                                    list_pedc_u02.append(last_known_value)
                        except KeyError:
                            # If RESOURCE_NAME column is missing, use the last known value
                            if last_known_value is not None:
                                list_pedc_u02.append(last_known_value)
                            continue

                    # 08PEDC_U03
                    for i in range(1, len(files_in_folder)):
                        filepath = os.path.join(folder_path, files_in_folder[i]) 

                        try: 
                            df = pd.read_csv(filepath)
                        except pd.errors.EmptyDataError:
                            if last_known_value is not None:
                                list_pedc_u03.append(last_known_value)
                            continue
                        except IndexError:
                            break
                        try: 
                            search_value = '08PEDC_U03'
                            matching_row = df[df['RESOURCE_NAME'] == search_value]
                            if not matching_row.empty:
                                file_08PEDC_U03 = matching_row['DIPC_PRICE'].values[0]
                                list_pedc_u03.append(file_08PEDC_U03)
                                last_known_value = file_08PEDC_U03
                            else:
                                # If no matching row is found, use the last known value
                                if last_known_value is not None:
                                    list_pedc_u03.append(last_known_value)
                        except KeyError:
                            # If RESOURCE_NAME column is missing, use the last known value
                            if last_known_value is not None:
                                list_pedc_u03.append(last_known_value)
                            continue


                    filepath_0 = os.path.join(folder_path, files_in_folder[0]) 
                    try:
                        df_0 = pd.read_csv(filepath_0)
                    except IndexError:
                        break
                    
                    # search_value_0 = '03BOTOCA_G01'
                    # matching_row_0 = df_0[df_0['RESOURCE_NAME'] == search_value_0]
                    # file_03BOTOCA_G01_0 = matching_row_0['DIPC_PRICE'].values[0]
                    # list_botoca_g01[-1] = file_03BOTOCA_G01_0

                    search_value_0 = '03CALACA_G01'
                    matching_row_0 = df_0[df_0['RESOURCE_NAME'] == search_value_0]
                    file_03CALACA_G01_0 = matching_row_0['DIPC_PRICE'].values[0]
                    list_calaca_g01[-1] = file_03CALACA_G01_0

                    search_value_1 = '03CALACA_G02'
                    matching_row_1 = df_0[df_0['RESOURCE_NAME'] == search_value_1]
                    file_03CALACA_G02_1 = matching_row_1['DIPC_PRICE'].values[0]
                    list_calaca_g02[-1] = file_03CALACA_G02_1

                    # search_value_3 = '03KAL_G01'
                    # matching_row_3 = df_0[df_0['RESOURCE_NAME'] == search_value_3]
                    # file_03KAL_G01_0 = matching_row_3['DIPC_PRICE'].values[0]
                    # list_kal_g01[-1] = file_03KAL_G01_0

                    # search_value_4 = '03KAL_G02'
                    # matching_row_4 = df_0[df_0['RESOURCE_NAME'] == search_value_4]
                    # file_03KAL_G02_0 = matching_row_4['DIPC_PRICE'].values[0]
                    # list_kal_g02[-1] = file_03KAL_G02_0

                    # search_value_5 = '03KAL_G03'
                    # matching_row_5 = df_0[df_0['RESOURCE_NAME'] == search_value_5]
                    # file_03KAL_G03_0 = matching_row_5['DIPC_PRICE'].values[0]
                    # list_kal_g03[-1] = file_03KAL_G03_0

                    # search_value_6 = '03KAL_G04'
                    # matching_row_6 = df_0[df_0['RESOURCE_NAME'] == search_value_6]
                    # file_03KAL_G04_0 = matching_row_6['DIPC_PRICE'].values[0]
                    # list_kal_g04[-1] = file_03KAL_G04_0

                    search_value_3 = '04LEYTE_A'
                    matching_row_3 = df_0[df_0['RESOURCE_NAME'] == search_value_3]
                    file_04LEYTE_A_3 = matching_row_3['DIPC_PRICE'].values[0]
                    list_leyte_a[-1] = file_04LEYTE_A_3

                    search_value_4 = '05KSPC_G01'
                    matching_row_4 = df_0[df_0['RESOURCE_NAME'] == search_value_4]
                    file_05KSPC_G01_4 = matching_row_4['DIPC_PRICE'].values[0]
                    list_kspc_g01[-1] = file_05KSPC_G01_4

                    search_value_5 = '05KSPC_G02'
                    matching_row_5 = df_0[df_0['RESOURCE_NAME'] == search_value_5]
                    file_05KSPC_G02_5 = matching_row_5['DIPC_PRICE'].values[0]
                    list_kspc_g02[-1] = file_05KSPC_G02_5

                    search_value_6 = '08BANTAP_L01'
                    matching_row_6 = df_0[df_0['RESOURCE_NAME'] == search_value_6]
                    file_08BANTAP_L01_6 = matching_row_6['DIPC_PRICE'].values[0]
                    list_bantap_l01[-1] = file_08BANTAP_L01_6

                    search_value_7 = '08PEDC_T1L1'
                    matching_row_7 = df_0[df_0['RESOURCE_NAME'] == search_value_7]
                    file_08PEDC_T1L1_7 = matching_row_7['DIPC_PRICE'].values[0]
                    list_pedc_t1l1[-1] = file_08PEDC_T1L1_7

                    search_value_8 = '08PEDC_T1L2'
                    matching_row_8 = df_0[df_0['RESOURCE_NAME'] == search_value_8]
                    file_08PEDC_T1L2_8 = matching_row_8['DIPC_PRICE'].values[0]
                    list_pedc_t1l2[-1] = file_08PEDC_T1L2_8

                    search_value_9 = '08STBAR_T1L1'
                    matching_row_9 = df_0[df_0['RESOURCE_NAME'] == search_value_9]
                    file_08STBAR_T1L1_9 = matching_row_9['DIPC_PRICE'].values[0]
                    list_stbar_t1l1[-1] = file_08STBAR_T1L1_9

                    # 08PEDC_U01
                    search_value_10 = '08PEDC_U01'
                    matching_row_10 = df_0[df_0['RESOURCE_NAME'] == search_value_10]
                    file_08PEDC_U01_10 = matching_row_10['DIPC_PRICE'].values[0]
                    list_pedc_u01[-1] = file_08PEDC_U01_10

                    # 08PEDC_U02
                    search_value_11 = '08PEDC_U02'
                    matching_row_11 = df_0[df_0['RESOURCE_NAME'] == search_value_11]
                    file_08PEDC_U02_11 = matching_row_11['DIPC_PRICE'].values[0]
                    list_pedc_u02[-1] = file_08PEDC_U02_11

                    # 08PEDC_U03
                    search_value_12 = '08PEDC_U03'
                    matching_row_12 = df_0[df_0['RESOURCE_NAME'] == search_value_12]
                    file_08PEDC_U03_12 = matching_row_12['DIPC_PRICE'].values[0]
                    list_pedc_u03[-1] = file_08PEDC_U03_12


                    # average_botoca_g01 = average_every_12(list_botoca_g01)
                    average_calaca_g01 = average_every_12(list_calaca_g01)
                    average_calaca_g02 = average_every_12(list_calaca_g02)
                    # average_kal_g01 = average_every_12(list_kal_g01)
                    # average_kal_g02 = average_every_12(list_kal_g02)
                    # average_kal_g03 = average_every_12(list_kal_g03)
                    # average_kal_g04 = average_every_12(list_kal_g04)
                    average_leyte_a = average_every_12(list_leyte_a)
                    average_kspc_g01 = average_every_12(list_kspc_g01)
                    average_kspc_g02 = average_every_12(list_kspc_g02)
                    average_bantap_l01 = average_every_12(list_bantap_l01)
                    average_pedc_t1l1 = average_every_12(list_pedc_t1l1)
                    average_pedc_t1l2 = average_every_12(list_pedc_t1l2)
                    average_stbar_t1l1 = average_every_12(list_stbar_t1l1)
                    average_pedc_u01 = average_every_12(list_pedc_u01)
                    average_pedc_u02 = average_every_12(list_pedc_u02)
                    average_pedc_u03 = average_every_12(list_pedc_u03)

        current_time = datetime.now()
        hour_value = current_time.strftime("%H")

        if hour_value == "01":
            data = {
                "HOUR": ["01"],
               # "03BOTOCA_G01": [average_botoca_g01[0]],
                "03CALACA_G01": [average_calaca_g01[0]],
                "03CALACA_G02": [average_calaca_g02[0]],
               # "03KAL_G01": [average_kal_g01[0]], 
               # "03KAL_G02": [average_kal_g02[0]], 
               # "03KAL_G03": [average_kal_g03[0]],
               # "03KAL_G04": [average_kal_g04[0]],
                "04LEYTE_A": [average_leyte_a[0]],
                "05KSPC_G01": [average_kspc_g01[0]],
                "05KSPC_G02": [average_kspc_g02[0]], 
                "08BANTAP_L01": [average_bantap_l01[0]],
                "08PEDC_T1L1": [average_pedc_t1l1[0]],
                "08PEDC_T1L2": [average_pedc_t1l2[0]],
                "08STBAR_T1L1": [average_stbar_t1l1[0]],
                "08PEDC_U01": [average_pedc_u01[0]],
                "08PEDC_U02": [average_pedc_u02[0]],
                "08PEDC_U03": [average_pedc_u03[0]]
            }

        elif hour_value == "02":
            data = {
                "HOUR": ["01", "02"],
               # "03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1]],
               # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1]], 
               # "03KAL_G02": [average_kal_g02[0], average_kal_g02[1]], 
               # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1]],
               # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1]]
            }

        elif hour_value == '03':
            data = {
                "HOUR": ["01", "02", "03"],
               # "03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2]],
              #  "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2]], 
              #  "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2]], 
               # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2]],
               # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2]]
            }

        elif hour_value == '04':
            data = {
                "HOUR": ["01", "02", "03", "04"],
              #  "03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3]],
              #  "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3]], 
              #  "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3]], 
               # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3]],
               # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3]]
            }

        elif hour_value == '05':
            data = {
                "HOUR": ["01", "02", "03", "04", "05"],
               # "03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4]],
              #  "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4]], 
              #  "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4]], 
               # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4]],
               # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4]]
            }
        elif hour_value == '06':
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06"],
                #"03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5]],
              #  "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5]], 
              #  "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5]], 
              #  "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5]],
              #  "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5]]
            }

        elif hour_value == '07':
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07"],
              #  "03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6]],
               # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6]], 
               # "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6]], 
               # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6]],
               # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6]]
            }
        elif hour_value == '08':
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08"],
               # "03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7]],
               # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7]], 
                #"03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7]], 
                #"03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7]],
                #"03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7]]
            }

        elif hour_value == "09":
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09"],
                #"03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8]],
               # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8]], 
               # "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8]], 
                #"03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8]],
                #"03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8]]
            }

        elif hour_value == "10":
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10"],
               # "03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8], average_botoca_g01[9]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8], average_calaca_g01[9]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8], average_calaca_g02[9]],
               # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8], average_kal_g01[9]], 
               # "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8], average_kal_g02[9]], 
               # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8], average_kal_g03[9]],
               ## "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8], average_kal_g04[9]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8], average_leyte_a[9]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8], average_kspc_g01[9]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8], average_kspc_g02[9]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8], average_bantap_l01[9]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8], average_pedc_t1l1[9]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8], average_pedc_t1l2[9]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8], average_stbar_t1l1[9]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9]]
            }

        elif hour_value == "11":
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11"],
                #"03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8], average_botoca_g01[9], average_botoca_g01[10]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8], average_calaca_g01[9], average_calaca_g01[10]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8], average_calaca_g02[9], average_calaca_g02[10]],
               # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8], average_kal_g01[9], average_kal_g01[10]], 
               # "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8], average_kal_g02[9], average_kal_g02[10]], 
                #"03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8], average_kal_g03[9], average_kal_g03[10]],
               # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8], average_kal_g04[9], average_kal_g04[10]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8], average_leyte_a[9], average_leyte_a[10]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8], average_kspc_g01[9], average_kspc_g01[10]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8], average_kspc_g02[9], average_kspc_g02[10]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8], average_bantap_l01[9], average_bantap_l01[10]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8], average_pedc_t1l1[9], average_pedc_t1l1[10]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8], average_pedc_t1l2[9], average_pedc_t1l2[10]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8], average_stbar_t1l1[9], average_stbar_t1l1[10]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9], average_pedc_u01[10]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9], average_pedc_u02[10]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9], average_pedc_u03[10]]
            }

        elif hour_value == "12":
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12"],
              #  "03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8], average_botoca_g01[9], average_botoca_g01[10], average_botoca_g01[11]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8], average_calaca_g01[9], average_calaca_g01[10], average_calaca_g01[11]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8], average_calaca_g02[9], average_calaca_g02[10], average_calaca_g02[11]],
               # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8], average_kal_g01[9], average_kal_g01[10], average_kal_g01[11]], 
                #"03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8], average_kal_g02[9], average_kal_g02[10], average_kal_g02[11]], 
                #"03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8], average_kal_g03[9], average_kal_g03[10], average_kal_g03[11]],
               # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8], average_kal_g04[9], average_kal_g04[10], average_kal_g04[11]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8], average_leyte_a[9], average_leyte_a[10], average_leyte_a[11]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8], average_kspc_g01[9], average_kspc_g01[10], average_kspc_g01[11]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8], average_kspc_g02[9], average_kspc_g02[10], average_kspc_g02[11]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8], average_bantap_l01[9], average_bantap_l01[10], average_bantap_l01[11]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8], average_pedc_t1l1[9], average_pedc_t1l1[10], average_pedc_t1l1[11]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8], average_pedc_t1l2[9], average_pedc_t1l2[10], average_pedc_t1l2[11]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8], average_stbar_t1l1[9], average_stbar_t1l1[10], average_stbar_t1l1[11]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9], average_pedc_u01[10], average_pedc_u01[11]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9], average_pedc_u02[10], average_pedc_u02[11]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9], average_pedc_u03[10], average_pedc_u03[11]]
            }

        elif hour_value == "13":
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13"],
                #"03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8], average_botoca_g01[9], average_botoca_g01[10], average_botoca_g01[11], average_botoca_g01[12]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8], average_calaca_g01[9], average_calaca_g01[10], average_calaca_g01[11], average_calaca_g01[12]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8], average_calaca_g02[9], average_calaca_g02[10], average_calaca_g02[11], average_calaca_g02[12]],
                #"03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8], average_kal_g01[9], average_kal_g01[10], average_kal_g01[11], average_kal_g01[12]], 
                #"03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8], average_kal_g02[9], average_kal_g02[10], average_kal_g02[11], average_kal_g02[12]], 
                #"03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8], average_kal_g03[9], average_kal_g03[10], average_kal_g03[11], average_kal_g03[12]],
                #"03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8], average_kal_g04[9], average_kal_g04[10], average_kal_g04[11], average_kal_g04[12]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8], average_leyte_a[9], average_leyte_a[10], average_leyte_a[11], average_leyte_a[12]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8], average_kspc_g01[9], average_kspc_g01[10], average_kspc_g01[11], average_kspc_g01[12]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8], average_kspc_g02[9], average_kspc_g02[10], average_kspc_g02[11], average_kspc_g02[12]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8], average_bantap_l01[9], average_bantap_l01[10], average_bantap_l01[11], average_bantap_l01[12]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8], average_pedc_t1l1[9], average_pedc_t1l1[10], average_pedc_t1l1[11], average_pedc_t1l1[12]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8], average_pedc_t1l2[9], average_pedc_t1l2[10], average_pedc_t1l2[11], average_pedc_t1l2[12]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8], average_stbar_t1l1[9], average_stbar_t1l1[10], average_stbar_t1l1[11], average_stbar_t1l1[12]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9], average_pedc_u01[10], average_pedc_u01[11], average_pedc_u01[12]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9], average_pedc_u02[10], average_pedc_u02[11], average_pedc_u02[12]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9], average_pedc_u03[10], average_pedc_u03[11], average_pedc_u03[12]]
            }

        elif hour_value == "14":
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14"],
               # "03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8], average_botoca_g01[9], average_botoca_g01[10], average_botoca_g01[11], average_botoca_g01[12], average_botoca_g01[13]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8], average_calaca_g01[9], average_calaca_g01[10], average_calaca_g01[11], average_calaca_g01[12], average_calaca_g01[13]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8], average_calaca_g02[9], average_calaca_g02[10], average_calaca_g02[11], average_calaca_g02[12], average_calaca_g02[13]],
                #"03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8], average_kal_g01[9], average_kal_g01[10], average_kal_g01[11], average_kal_g01[12], average_kal_g01[13]], 
                #"03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8], average_kal_g02[9], average_kal_g02[10], average_kal_g02[11], average_kal_g02[12], average_kal_g02[13]], 
                #"03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8], average_kal_g03[9], average_kal_g03[10], average_kal_g03[11], average_kal_g03[12], average_kal_g03[13]],
                #"03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8], average_kal_g04[9], average_kal_g04[10], average_kal_g04[11], average_kal_g04[12], average_kal_g04[13]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8], average_leyte_a[9], average_leyte_a[10], average_leyte_a[11], average_leyte_a[12], average_leyte_a[13]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8], average_kspc_g01[9], average_kspc_g01[10], average_kspc_g01[11], average_kspc_g01[12], average_kspc_g01[13]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8], average_kspc_g02[9], average_kspc_g02[10], average_kspc_g02[11], average_kspc_g02[12], average_kspc_g02[13]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8], average_bantap_l01[9], average_bantap_l01[10], average_bantap_l01[11], average_bantap_l01[12], average_bantap_l01[13]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8], average_pedc_t1l1[9], average_pedc_t1l1[10], average_pedc_t1l1[11], average_pedc_t1l1[12], average_pedc_t1l1[13]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8], average_pedc_t1l2[9], average_pedc_t1l2[10], average_pedc_t1l2[11], average_pedc_t1l2[12], average_pedc_t1l2[13]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8], average_stbar_t1l1[9], average_stbar_t1l1[10], average_stbar_t1l1[11], average_stbar_t1l1[12], average_stbar_t1l1[13]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9], average_pedc_u01[10], average_pedc_u01[11], average_pedc_u01[12], average_pedc_u01[13]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9], average_pedc_u02[10], average_pedc_u02[11], average_pedc_u02[12], average_pedc_u02[13]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9], average_pedc_u03[10], average_pedc_u03[11], average_pedc_u03[12], average_pedc_u03[13]]
            }

        elif hour_value == "15":
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15"],
                #"03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8], average_botoca_g01[9], average_botoca_g01[10], average_botoca_g01[11], average_botoca_g01[12], average_botoca_g01[13], average_botoca_g01[14]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8], average_calaca_g01[9], average_calaca_g01[10], average_calaca_g01[11], average_calaca_g01[12], average_calaca_g01[13], average_calaca_g01[14]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8], average_calaca_g02[9], average_calaca_g02[10], average_calaca_g02[11], average_calaca_g02[12], average_calaca_g02[13], average_calaca_g02[14]],
                # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8], average_kal_g01[9], average_kal_g01[10], average_kal_g01[11], average_kal_g01[12], average_kal_g01[13], average_kal_g01[14]], 
                # "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8], average_kal_g02[9], average_kal_g02[10], average_kal_g02[11], average_kal_g02[12], average_kal_g02[13], average_kal_g02[14]], 
                # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8], average_kal_g03[9], average_kal_g03[10], average_kal_g03[11], average_kal_g03[12], average_kal_g03[13], average_kal_g03[14]],
                #"03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8], average_kal_g04[9], average_kal_g04[10], average_kal_g04[11], average_kal_g04[12], average_kal_g04[13], average_kal_g04[14]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8], average_leyte_a[9], average_leyte_a[10], average_leyte_a[11], average_leyte_a[12], average_leyte_a[13], average_leyte_a[14]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8], average_kspc_g01[9], average_kspc_g01[10], average_kspc_g01[11], average_kspc_g01[12], average_kspc_g01[13], average_kspc_g01[14]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8], average_kspc_g02[9], average_kspc_g02[10], average_kspc_g02[11], average_kspc_g02[12], average_kspc_g02[13], average_kspc_g02[14]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8], average_bantap_l01[9], average_bantap_l01[10], average_bantap_l01[11], average_bantap_l01[12], average_bantap_l01[13], average_bantap_l01[14]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8], average_pedc_t1l1[9], average_pedc_t1l1[10], average_pedc_t1l1[11], average_pedc_t1l1[12], average_pedc_t1l1[13], average_pedc_t1l1[14]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8], average_pedc_t1l2[9], average_pedc_t1l2[10], average_pedc_t1l2[11], average_pedc_t1l2[12], average_pedc_t1l2[13], average_pedc_t1l2[14]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8], average_stbar_t1l1[9], average_stbar_t1l1[10], average_stbar_t1l1[11], average_stbar_t1l1[12], average_stbar_t1l1[13], average_stbar_t1l1[14]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9], average_pedc_u01[10], average_pedc_u01[11], average_pedc_u01[12], average_pedc_u01[13], average_pedc_u01[14]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9], average_pedc_u02[10], average_pedc_u02[11], average_pedc_u02[12], average_pedc_u02[13], average_pedc_u02[14]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9], average_pedc_u03[10], average_pedc_u03[11], average_pedc_u03[12], average_pedc_u03[13], average_pedc_u03[14]]
            }

        elif hour_value == "16":
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16"],
                #"03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8], average_botoca_g01[9], average_botoca_g01[10], average_botoca_g01[11], average_botoca_g01[12], average_botoca_g01[13], average_botoca_g01[14], average_botoca_g01[15]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8], average_calaca_g01[9], average_calaca_g01[10], average_calaca_g01[11], average_calaca_g01[12], average_calaca_g01[13], average_calaca_g01[14], average_calaca_g01[15]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8], average_calaca_g02[9], average_calaca_g02[10], average_calaca_g02[11], average_calaca_g02[12], average_calaca_g02[13], average_calaca_g02[14], average_calaca_g02[15]],
                # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8], average_kal_g01[9], average_kal_g01[10], average_kal_g01[11], average_kal_g01[12], average_kal_g01[13], average_kal_g01[14], average_kal_g01[15]], 
                # "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8], average_kal_g02[9], average_kal_g02[10], average_kal_g02[11], average_kal_g02[12], average_kal_g02[13], average_kal_g02[14], average_kal_g02[15]], 
                # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8], average_kal_g03[9], average_kal_g03[10], average_kal_g03[11], average_kal_g03[12], average_kal_g03[13], average_kal_g03[14], average_kal_g03[15]],
                # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8], average_kal_g04[9], average_kal_g04[10], average_kal_g04[11], average_kal_g04[12], average_kal_g04[13], average_kal_g04[14], average_kal_g04[15]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8], average_leyte_a[9], average_leyte_a[10], average_leyte_a[11], average_leyte_a[12], average_leyte_a[13], average_leyte_a[14], average_leyte_a[15]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8], average_kspc_g01[9], average_kspc_g01[10], average_kspc_g01[11], average_kspc_g01[12], average_kspc_g01[13], average_kspc_g01[14], average_kspc_g01[15]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8], average_kspc_g02[9], average_kspc_g02[10], average_kspc_g02[11], average_kspc_g02[12], average_kspc_g02[13], average_kspc_g02[14], average_kspc_g02[15]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8], average_bantap_l01[9], average_bantap_l01[10], average_bantap_l01[11], average_bantap_l01[12], average_bantap_l01[13], average_bantap_l01[14], average_bantap_l01[15]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8], average_pedc_t1l1[9], average_pedc_t1l1[10], average_pedc_t1l1[11], average_pedc_t1l1[12], average_pedc_t1l1[13], average_pedc_t1l1[14], average_pedc_t1l1[15]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8], average_pedc_t1l2[9], average_pedc_t1l2[10], average_pedc_t1l2[11], average_pedc_t1l2[12], average_pedc_t1l2[13], average_pedc_t1l2[14], average_pedc_t1l2[15]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8], average_stbar_t1l1[9], average_stbar_t1l1[10], average_stbar_t1l1[11], average_stbar_t1l1[12], average_stbar_t1l1[13], average_stbar_t1l1[14], average_stbar_t1l1[15]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9], average_pedc_u01[10], average_pedc_u01[11], average_pedc_u01[12], average_pedc_u01[13], average_pedc_u01[14], average_pedc_u01[15]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9], average_pedc_u02[10], average_pedc_u02[11], average_pedc_u02[12], average_pedc_u02[13], average_pedc_u02[14], average_pedc_u02[15]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9], average_pedc_u03[10], average_pedc_u03[11], average_pedc_u03[12], average_pedc_u03[13], average_pedc_u03[14], average_pedc_u03[15]]
            }

        elif hour_value == "17":
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17"],
                #"03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8], average_botoca_g01[9], average_botoca_g01[10], average_botoca_g01[11], average_botoca_g01[12], average_botoca_g01[13], average_botoca_g01[14], average_botoca_g01[15], average_botoca_g01[16]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8], average_calaca_g01[9], average_calaca_g01[10], average_calaca_g01[11], average_calaca_g01[12], average_calaca_g01[13], average_calaca_g01[14], average_calaca_g01[15], average_calaca_g01[16]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8], average_calaca_g02[9], average_calaca_g02[10], average_calaca_g02[11], average_calaca_g02[12], average_calaca_g02[13], average_calaca_g02[14], average_calaca_g02[15], average_calaca_g02[16]],
                # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8], average_kal_g01[9], average_kal_g01[10], average_kal_g01[11], average_kal_g01[12], average_kal_g01[13], average_kal_g01[14], average_kal_g01[15], average_kal_g01[16]], 
                # "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8], average_kal_g02[9], average_kal_g02[10], average_kal_g02[11], average_kal_g02[12], average_kal_g02[13], average_kal_g02[14], average_kal_g02[15], average_kal_g02[16]], 
                # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8], average_kal_g03[9], average_kal_g03[10], average_kal_g03[11], average_kal_g03[12], average_kal_g03[13], average_kal_g03[14], average_kal_g03[15], average_kal_g03[16]],
                # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8], average_kal_g04[9], average_kal_g04[10], average_kal_g04[11], average_kal_g04[12], average_kal_g04[13], average_kal_g04[14], average_kal_g04[15], average_kal_g04[16]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8], average_leyte_a[9], average_leyte_a[10], average_leyte_a[11], average_leyte_a[12], average_leyte_a[13], average_leyte_a[14], average_leyte_a[15], average_leyte_a[16]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8], average_kspc_g01[9], average_kspc_g01[10], average_kspc_g01[11], average_kspc_g01[12], average_kspc_g01[13], average_kspc_g01[14], average_kspc_g01[15], average_kspc_g01[16]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8], average_kspc_g02[9], average_kspc_g02[10], average_kspc_g02[11], average_kspc_g02[12], average_kspc_g02[13], average_kspc_g02[14], average_kspc_g02[15], average_kspc_g02[16]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8], average_bantap_l01[9], average_bantap_l01[10], average_bantap_l01[11], average_bantap_l01[12], average_bantap_l01[13], average_bantap_l01[14], average_bantap_l01[15], average_bantap_l01[16]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8], average_pedc_t1l1[9], average_pedc_t1l1[10], average_pedc_t1l1[11], average_pedc_t1l1[12], average_pedc_t1l1[13], average_pedc_t1l1[14], average_pedc_t1l1[15], average_pedc_t1l1[16]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8], average_pedc_t1l2[9], average_pedc_t1l2[10], average_pedc_t1l2[11], average_pedc_t1l2[12], average_pedc_t1l2[13], average_pedc_t1l2[14], average_pedc_t1l2[15], average_pedc_t1l2[16]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8], average_stbar_t1l1[9], average_stbar_t1l1[10], average_stbar_t1l1[11], average_stbar_t1l1[12], average_stbar_t1l1[13], average_stbar_t1l1[14], average_stbar_t1l1[15], average_stbar_t1l1[16]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9], average_pedc_u01[10], average_pedc_u01[11], average_pedc_u01[12], average_pedc_u01[13], average_pedc_u01[14], average_pedc_u01[15], average_pedc_u01[16]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9], average_pedc_u02[10], average_pedc_u02[11], average_pedc_u02[12], average_pedc_u02[13], average_pedc_u02[14], average_pedc_u02[15], average_pedc_u02[16]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9], average_pedc_u03[10], average_pedc_u03[11], average_pedc_u03[12], average_pedc_u03[13], average_pedc_u03[14], average_pedc_u03[15], average_pedc_u03[16]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9], average_pedc_u01[10], average_pedc_u01[11], average_pedc_u01[12], average_pedc_u01[13], average_pedc_u01[14], average_pedc_u01[15], average_pedc_u01[16]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9], average_pedc_u02[10], average_pedc_u02[11], average_pedc_u02[12], average_pedc_u02[13], average_pedc_u02[14], average_pedc_u02[15], average_pedc_u02[16]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9], average_pedc_u03[10], average_pedc_u03[11], average_pedc_u03[12], average_pedc_u03[13], average_pedc_u03[14], average_pedc_u03[15], average_pedc_u03[16]]
            }

        elif hour_value == "18":
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18"],
                #"03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8], average_botoca_g01[9], average_botoca_g01[10], average_botoca_g01[11], average_botoca_g01[12], average_botoca_g01[13], average_botoca_g01[14], average_botoca_g01[15], average_botoca_g01[16], average_botoca_g01[17]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8], average_calaca_g01[9], average_calaca_g01[10], average_calaca_g01[11], average_calaca_g01[12], average_calaca_g01[13], average_calaca_g01[14], average_calaca_g01[15], average_calaca_g01[16], average_calaca_g01[17]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8], average_calaca_g02[9], average_calaca_g02[10], average_calaca_g02[11], average_calaca_g02[12], average_calaca_g02[13], average_calaca_g02[14], average_calaca_g02[15], average_calaca_g02[16], average_calaca_g02[17]],
                # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8], average_kal_g01[9], average_kal_g01[10], average_kal_g01[11], average_kal_g01[12], average_kal_g01[13], average_kal_g01[14], average_kal_g01[15], average_kal_g01[16], average_kal_g01[17]], 
                # "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8], average_kal_g02[9], average_kal_g02[10], average_kal_g02[11], average_kal_g02[12], average_kal_g02[13], average_kal_g02[14], average_kal_g02[15], average_kal_g02[16], average_kal_g02[17]], 
                # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8], average_kal_g03[9], average_kal_g03[10], average_kal_g03[11], average_kal_g03[12], average_kal_g03[13], average_kal_g03[14], average_kal_g03[15], average_kal_g03[16], average_kal_g03[17]],
                # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8], average_kal_g04[9], average_kal_g04[10], average_kal_g04[11], average_kal_g04[12], average_kal_g04[13], average_kal_g04[14], average_kal_g04[15], average_kal_g04[16], average_kal_g04[17]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8], average_leyte_a[9], average_leyte_a[10], average_leyte_a[11], average_leyte_a[12], average_leyte_a[13], average_leyte_a[14], average_leyte_a[15], average_leyte_a[16], average_leyte_a[17]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8], average_kspc_g01[9], average_kspc_g01[10], average_kspc_g01[11], average_kspc_g01[12], average_kspc_g01[13], average_kspc_g01[14], average_kspc_g01[15], average_kspc_g01[16], average_kspc_g01[17]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8], average_kspc_g02[9], average_kspc_g02[10], average_kspc_g02[11], average_kspc_g02[12], average_kspc_g02[13], average_kspc_g02[14], average_kspc_g02[15], average_kspc_g02[16], average_kspc_g02[17]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8], average_bantap_l01[9], average_bantap_l01[10], average_bantap_l01[11], average_bantap_l01[12], average_bantap_l01[13], average_bantap_l01[14], average_bantap_l01[15], average_bantap_l01[16], average_bantap_l01[17]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8], average_pedc_t1l1[9], average_pedc_t1l1[10], average_pedc_t1l1[11], average_pedc_t1l1[12], average_pedc_t1l1[13], average_pedc_t1l1[14], average_pedc_t1l1[15], average_pedc_t1l1[16], average_pedc_t1l1[17]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8], average_pedc_t1l2[9], average_pedc_t1l2[10], average_pedc_t1l2[11], average_pedc_t1l2[12], average_pedc_t1l2[13], average_pedc_t1l2[14], average_pedc_t1l2[15], average_pedc_t1l2[16], average_pedc_t1l2[17]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8], average_stbar_t1l1[9], average_stbar_t1l1[10], average_stbar_t1l1[11], average_stbar_t1l1[12], average_stbar_t1l1[13], average_stbar_t1l1[14], average_stbar_t1l1[15], average_stbar_t1l1[16], average_stbar_t1l1[17]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9], average_pedc_u01[10], average_pedc_u01[11], average_pedc_u01[12], average_pedc_u01[13], average_pedc_u01[14], average_pedc_u01[15], average_pedc_u01[16], average_pedc_u01[17]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9], average_pedc_u02[10], average_pedc_u02[11], average_pedc_u02[12], average_pedc_u02[13], average_pedc_u02[14], average_pedc_u02[15], average_pedc_u02[16], average_pedc_u02[17]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9], average_pedc_u03[10], average_pedc_u03[11], average_pedc_u03[12], average_pedc_u03[13], average_pedc_u03[14], average_pedc_u03[15], average_pedc_u03[16], average_pedc_u03[17]]
            }
        elif hour_value == "19":
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19"],
                # "03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8], average_botoca_g01[9], average_botoca_g01[10], average_botoca_g01[11], average_botoca_g01[12], average_botoca_g01[13], average_botoca_g01[14], average_botoca_g01[15], average_botoca_g01[16], average_botoca_g01[17], average_botoca_g01[18]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8], average_calaca_g01[9], average_calaca_g01[10], average_calaca_g01[11], average_calaca_g01[12], average_calaca_g01[13], average_calaca_g01[14], average_calaca_g01[15], average_calaca_g01[16], average_calaca_g01[17], average_calaca_g01[18]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8], average_calaca_g02[9], average_calaca_g02[10], average_calaca_g02[11], average_calaca_g02[12], average_calaca_g02[13], average_calaca_g02[14], average_calaca_g02[15], average_calaca_g02[16], average_calaca_g02[17], average_calaca_g02[18]],
                # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8], average_kal_g01[9], average_kal_g01[10], average_kal_g01[11], average_kal_g01[12], average_kal_g01[13], average_kal_g01[14], average_kal_g01[15], average_kal_g01[16], average_kal_g01[17], average_kal_g01[18]], 
                # "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8], average_kal_g02[9], average_kal_g02[10], average_kal_g02[11], average_kal_g02[12], average_kal_g02[13], average_kal_g02[14], average_kal_g02[15], average_kal_g02[16], average_kal_g02[17], average_kal_g02[18]], 
                # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8], average_kal_g03[9], average_kal_g03[10], average_kal_g03[11], average_kal_g03[12], average_kal_g03[13], average_kal_g03[14], average_kal_g03[15], average_kal_g03[16], average_kal_g03[17], average_kal_g03[18]],
                # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8], average_kal_g04[9], average_kal_g04[10], average_kal_g04[11], average_kal_g04[12], average_kal_g04[13], average_kal_g04[14], average_kal_g04[15], average_kal_g04[16], average_kal_g04[17], average_kal_g04[18]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8], average_leyte_a[9], average_leyte_a[10], average_leyte_a[11], average_leyte_a[12], average_leyte_a[13], average_leyte_a[14], average_leyte_a[15], average_leyte_a[16], average_leyte_a[17], average_leyte_a[18]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8], average_kspc_g01[9], average_kspc_g01[10], average_kspc_g01[11], average_kspc_g01[12], average_kspc_g01[13], average_kspc_g01[14], average_kspc_g01[15], average_kspc_g01[16], average_kspc_g01[17], average_kspc_g01[18]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8], average_kspc_g02[9], average_kspc_g02[10], average_kspc_g02[11], average_kspc_g02[12], average_kspc_g02[13], average_kspc_g02[14], average_kspc_g02[15], average_kspc_g02[16], average_kspc_g02[17], average_kspc_g02[18]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8], average_bantap_l01[9], average_bantap_l01[10], average_bantap_l01[11], average_bantap_l01[12], average_bantap_l01[13], average_bantap_l01[14], average_bantap_l01[15], average_bantap_l01[16], average_bantap_l01[17], average_bantap_l01[18]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8], average_pedc_t1l1[9], average_pedc_t1l1[10], average_pedc_t1l1[11], average_pedc_t1l1[12], average_pedc_t1l1[13], average_pedc_t1l1[14], average_pedc_t1l1[15], average_pedc_t1l1[16], average_pedc_t1l1[17], average_pedc_t1l1[18]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8], average_pedc_t1l2[9], average_pedc_t1l2[10], average_pedc_t1l2[11], average_pedc_t1l2[12], average_pedc_t1l2[13], average_pedc_t1l2[14], average_pedc_t1l2[15], average_pedc_t1l2[16], average_pedc_t1l2[17], average_pedc_t1l2[18]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8], average_stbar_t1l1[9], average_stbar_t1l1[10], average_stbar_t1l1[11], average_stbar_t1l1[12], average_stbar_t1l1[13], average_stbar_t1l1[14], average_stbar_t1l1[15], average_stbar_t1l1[16], average_stbar_t1l1[17], average_stbar_t1l1[18]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9], average_pedc_u01[10], average_pedc_u01[11], average_pedc_u01[12], average_pedc_u01[13], average_pedc_u01[14], average_pedc_u01[15], average_pedc_u01[16], average_pedc_u01[17], average_pedc_u01[18]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9], average_pedc_u02[10], average_pedc_u02[11], average_pedc_u02[12], average_pedc_u02[13], average_pedc_u02[14], average_pedc_u02[15], average_pedc_u02[16], average_pedc_u02[17], average_pedc_u02[18]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9], average_pedc_u03[10], average_pedc_u03[11], average_pedc_u03[12], average_pedc_u03[13], average_pedc_u03[14], average_pedc_u03[15], average_pedc_u03[16], average_pedc_u03[17], average_pedc_u03[18]]
            }
        elif hour_value == "20":
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"],
                # "03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8], average_botoca_g01[9], average_botoca_g01[10], average_botoca_g01[11], average_botoca_g01[12], average_botoca_g01[13], average_botoca_g01[14], average_botoca_g01[15], average_botoca_g01[16], average_botoca_g01[17], average_botoca_g01[18], average_botoca_g01[19]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8], average_calaca_g01[9], average_calaca_g01[10], average_calaca_g01[11], average_calaca_g01[12], average_calaca_g01[13], average_calaca_g01[14], average_calaca_g01[15], average_calaca_g01[16], average_calaca_g01[17], average_calaca_g01[18], average_calaca_g01[19]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8], average_calaca_g02[9], average_calaca_g02[10], average_calaca_g02[11], average_calaca_g02[12], average_calaca_g02[13], average_calaca_g02[14], average_calaca_g02[15], average_calaca_g02[16], average_calaca_g02[17], average_calaca_g02[18], average_calaca_g02[19]],
                # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8], average_kal_g01[9], average_kal_g01[10], average_kal_g01[11], average_kal_g01[12], average_kal_g01[13], average_kal_g01[14], average_kal_g01[15], average_kal_g01[16], average_kal_g01[17], average_kal_g01[18], average_kal_g01[19]], 
                # "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8], average_kal_g02[9], average_kal_g02[10], average_kal_g02[11], average_kal_g02[12], average_kal_g02[13], average_kal_g02[14], average_kal_g02[15], average_kal_g02[16], average_kal_g02[17], average_kal_g02[18], average_kal_g02[19]], 
                # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8], average_kal_g03[9], average_kal_g03[10], average_kal_g03[11], average_kal_g03[12], average_kal_g03[13], average_kal_g03[14], average_kal_g03[15], average_kal_g03[16], average_kal_g03[17], average_kal_g03[18], average_kal_g03[19]],
                # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8], average_kal_g04[9], average_kal_g04[10], average_kal_g04[11], average_kal_g04[12], average_kal_g04[13], average_kal_g04[14], average_kal_g04[15], average_kal_g04[16], average_kal_g04[17], average_kal_g04[18], average_kal_g04[19]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8], average_leyte_a[9], average_leyte_a[10], average_leyte_a[11], average_leyte_a[12], average_leyte_a[13], average_leyte_a[14], average_leyte_a[15], average_leyte_a[16], average_leyte_a[17], average_leyte_a[18], average_leyte_a[19]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8], average_kspc_g01[9], average_kspc_g01[10], average_kspc_g01[11], average_kspc_g01[12], average_kspc_g01[13], average_kspc_g01[14], average_kspc_g01[15], average_kspc_g01[16], average_kspc_g01[17], average_kspc_g01[18], average_kspc_g01[19]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8], average_kspc_g02[9], average_kspc_g02[10], average_kspc_g02[11], average_kspc_g02[12], average_kspc_g02[13], average_kspc_g02[14], average_kspc_g02[15], average_kspc_g02[16], average_kspc_g02[17], average_kspc_g02[18], average_kspc_g02[19]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8], average_bantap_l01[9], average_bantap_l01[10], average_bantap_l01[11], average_bantap_l01[12], average_bantap_l01[13], average_bantap_l01[14], average_bantap_l01[15], average_bantap_l01[16], average_bantap_l01[17], average_bantap_l01[18], average_bantap_l01[19]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8], average_pedc_t1l1[9], average_pedc_t1l1[10], average_pedc_t1l1[11], average_pedc_t1l1[12], average_pedc_t1l1[13], average_pedc_t1l1[14], average_pedc_t1l1[15], average_pedc_t1l1[16], average_pedc_t1l1[17], average_pedc_t1l1[18], average_pedc_t1l1[19]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8], average_pedc_t1l2[9], average_pedc_t1l2[10], average_pedc_t1l2[11], average_pedc_t1l2[12], average_pedc_t1l2[13], average_pedc_t1l2[14], average_pedc_t1l2[15], average_pedc_t1l2[16], average_pedc_t1l2[17], average_pedc_t1l2[18], average_pedc_t1l2[19]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8], average_stbar_t1l1[9], average_stbar_t1l1[10], average_stbar_t1l1[11], average_stbar_t1l1[12], average_stbar_t1l1[13], average_stbar_t1l1[14], average_stbar_t1l1[15], average_stbar_t1l1[16], average_stbar_t1l1[17], average_stbar_t1l1[18], average_stbar_t1l1[19]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9], average_pedc_u01[10], average_pedc_u01[11], average_pedc_u01[12], average_pedc_u01[13], average_pedc_u01[14], average_pedc_u01[15], average_pedc_u01[16], average_pedc_u01[17], average_pedc_u01[18], average_pedc_u01[19]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9], average_pedc_u02[10], average_pedc_u02[11], average_pedc_u02[12], average_pedc_u02[13], average_pedc_u02[14], average_pedc_u02[15], average_pedc_u02[16], average_pedc_u02[17], average_pedc_u02[18], average_pedc_u02[19]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9], average_pedc_u03[10], average_pedc_u03[11], average_pedc_u03[12], average_pedc_u03[13], average_pedc_u03[14], average_pedc_u03[15], average_pedc_u03[16], average_pedc_u03[17], average_pedc_u03[18], average_pedc_u03[19]]
            }
        elif hour_value == "21":
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21"],
                # "03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8], average_botoca_g01[9], average_botoca_g01[10], average_botoca_g01[11], average_botoca_g01[12], average_botoca_g01[13], average_botoca_g01[14], average_botoca_g01[15], average_botoca_g01[16], average_botoca_g01[17], average_botoca_g01[18], average_botoca_g01[19], average_botoca_g01[20]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8], average_calaca_g01[9], average_calaca_g01[10], average_calaca_g01[11], average_calaca_g01[12], average_calaca_g01[13], average_calaca_g01[14], average_calaca_g01[15], average_calaca_g01[16], average_calaca_g01[17], average_calaca_g01[18], average_calaca_g01[19], average_calaca_g01[20]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8], average_calaca_g02[9], average_calaca_g02[10], average_calaca_g02[11], average_calaca_g02[12], average_calaca_g02[13], average_calaca_g02[14], average_calaca_g02[15], average_calaca_g02[16], average_calaca_g02[17], average_calaca_g02[18], average_calaca_g02[19], average_calaca_g02[20]],
                # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8], average_kal_g01[9], average_kal_g01[10], average_kal_g01[11], average_kal_g01[12], average_kal_g01[13], average_kal_g01[14], average_kal_g01[15], average_kal_g01[16], average_kal_g01[17], average_kal_g01[18], average_kal_g01[19], average_kal_g01[20]], 
                # "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8], average_kal_g02[9], average_kal_g02[10], average_kal_g02[11], average_kal_g02[12], average_kal_g02[13], average_kal_g02[14], average_kal_g02[15], average_kal_g02[16], average_kal_g02[17], average_kal_g02[18], average_kal_g02[19], average_kal_g02[20]], 
                # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8], average_kal_g03[9], average_kal_g03[10], average_kal_g03[11], average_kal_g03[12], average_kal_g03[13], average_kal_g03[14], average_kal_g03[15], average_kal_g03[16], average_kal_g03[17], average_kal_g03[18], average_kal_g03[19], average_kal_g03[20]],
                # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8], average_kal_g04[9], average_kal_g04[10], average_kal_g04[11], average_kal_g04[12], average_kal_g04[13], average_kal_g04[14], average_kal_g04[15], average_kal_g04[16], average_kal_g04[17], average_kal_g04[18], average_kal_g04[19], average_kal_g04[20]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8], average_leyte_a[9], average_leyte_a[10], average_leyte_a[11], average_leyte_a[12], average_leyte_a[13], average_leyte_a[14], average_leyte_a[15], average_leyte_a[16], average_leyte_a[17], average_leyte_a[18], average_leyte_a[19], average_leyte_a[20]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8], average_kspc_g01[9], average_kspc_g01[10], average_kspc_g01[11], average_kspc_g01[12], average_kspc_g01[13], average_kspc_g01[14], average_kspc_g01[15], average_kspc_g01[16], average_kspc_g01[17], average_kspc_g01[18], average_kspc_g01[19], average_kspc_g01[20]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8], average_kspc_g02[9], average_kspc_g02[10], average_kspc_g02[11], average_kspc_g02[12], average_kspc_g02[13], average_kspc_g02[14], average_kspc_g02[15], average_kspc_g02[16], average_kspc_g02[17], average_kspc_g02[18], average_kspc_g02[19], average_kspc_g02[20]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8], average_bantap_l01[9], average_bantap_l01[10], average_bantap_l01[11], average_bantap_l01[12], average_bantap_l01[13], average_bantap_l01[14], average_bantap_l01[15], average_bantap_l01[16], average_bantap_l01[17], average_bantap_l01[18], average_bantap_l01[19], average_bantap_l01[20]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8], average_pedc_t1l1[9], average_pedc_t1l1[10], average_pedc_t1l1[11], average_pedc_t1l1[12], average_pedc_t1l1[13], average_pedc_t1l1[14], average_pedc_t1l1[15], average_pedc_t1l1[16], average_pedc_t1l1[17], average_pedc_t1l1[18], average_pedc_t1l1[19], average_pedc_t1l1[20]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8], average_pedc_t1l2[9], average_pedc_t1l2[10], average_pedc_t1l2[11], average_pedc_t1l2[12], average_pedc_t1l2[13], average_pedc_t1l2[14], average_pedc_t1l2[15], average_pedc_t1l2[16], average_pedc_t1l2[17], average_pedc_t1l2[18], average_pedc_t1l2[19], average_pedc_t1l2[20]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8], average_stbar_t1l1[9], average_stbar_t1l1[10], average_stbar_t1l1[11], average_stbar_t1l1[12], average_stbar_t1l1[13], average_stbar_t1l1[14], average_stbar_t1l1[15], average_stbar_t1l1[16], average_stbar_t1l1[17], average_stbar_t1l1[18], average_stbar_t1l1[19], average_stbar_t1l1[20]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9], average_pedc_u01[10], average_pedc_u01[11], average_pedc_u01[12], average_pedc_u01[13], average_pedc_u01[14], average_pedc_u01[15], average_pedc_u01[16], average_pedc_u01[17], average_pedc_u01[18], average_pedc_u01[19], average_pedc_u01[20]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9], average_pedc_u02[10], average_pedc_u02[11], average_pedc_u02[12], average_pedc_u02[13], average_pedc_u02[14], average_pedc_u02[15], average_pedc_u02[16], average_pedc_u02[17], average_pedc_u02[18], average_pedc_u02[19], average_pedc_u02[20]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9], average_pedc_u03[10], average_pedc_u03[11], average_pedc_u03[12], average_pedc_u03[13], average_pedc_u03[14], average_pedc_u03[15], average_pedc_u03[16], average_pedc_u03[17], average_pedc_u03[18], average_pedc_u03[19], average_pedc_u03[20]]
            }
        elif hour_value == "22":
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22"],
                # "03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8], average_botoca_g01[9], average_botoca_g01[10], average_botoca_g01[11], average_botoca_g01[12], average_botoca_g01[13], average_botoca_g01[14], average_botoca_g01[15], average_botoca_g01[16], average_botoca_g01[17], average_botoca_g01[18], average_botoca_g01[19], average_botoca_g01[20], average_botoca_g01[21]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8], average_calaca_g01[9], average_calaca_g01[10], average_calaca_g01[11], average_calaca_g01[12], average_calaca_g01[13], average_calaca_g01[14], average_calaca_g01[15], average_calaca_g01[16], average_calaca_g01[17], average_calaca_g01[18], average_calaca_g01[19], average_calaca_g01[20], average_calaca_g01[21]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8], average_calaca_g02[9], average_calaca_g02[10], average_calaca_g02[11], average_calaca_g02[12], average_calaca_g02[13], average_calaca_g02[14], average_calaca_g02[15], average_calaca_g02[16], average_calaca_g02[17], average_calaca_g02[18], average_calaca_g02[19], average_calaca_g02[20], average_calaca_g02[21]],
                # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8], average_kal_g01[9], average_kal_g01[10], average_kal_g01[11], average_kal_g01[12], average_kal_g01[13], average_kal_g01[14], average_kal_g01[15], average_kal_g01[16], average_kal_g01[17], average_kal_g01[18], average_kal_g01[19], average_kal_g01[20], average_kal_g01[21]], 
                # "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8], average_kal_g02[9], average_kal_g02[10], average_kal_g02[11], average_kal_g02[12], average_kal_g02[13], average_kal_g02[14], average_kal_g02[15], average_kal_g02[16], average_kal_g02[17], average_kal_g02[18], average_kal_g02[19], average_kal_g02[20], average_kal_g02[21]], 
                # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8], average_kal_g03[9], average_kal_g03[10], average_kal_g03[11], average_kal_g03[12], average_kal_g03[13], average_kal_g03[14], average_kal_g03[15], average_kal_g03[16], average_kal_g03[17], average_kal_g03[18], average_kal_g03[19], average_kal_g03[20], average_kal_g03[21]],
                # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8], average_kal_g04[9], average_kal_g04[10], average_kal_g04[11], average_kal_g04[12], average_kal_g04[13], average_kal_g04[14], average_kal_g04[15], average_kal_g04[16], average_kal_g04[17], average_kal_g04[18], average_kal_g04[19], average_kal_g04[20], average_kal_g04[21]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8], average_leyte_a[9], average_leyte_a[10], average_leyte_a[11], average_leyte_a[12], average_leyte_a[13], average_leyte_a[14], average_leyte_a[15], average_leyte_a[16], average_leyte_a[17], average_leyte_a[18], average_leyte_a[19], average_leyte_a[20], average_leyte_a[21]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8], average_kspc_g01[9], average_kspc_g01[10], average_kspc_g01[11], average_kspc_g01[12], average_kspc_g01[13], average_kspc_g01[14], average_kspc_g01[15], average_kspc_g01[16], average_kspc_g01[17], average_kspc_g01[18], average_kspc_g01[19], average_kspc_g01[20], average_kspc_g01[21]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8], average_kspc_g02[9], average_kspc_g02[10], average_kspc_g02[11], average_kspc_g02[12], average_kspc_g02[13], average_kspc_g02[14], average_kspc_g02[15], average_kspc_g02[16], average_kspc_g02[17], average_kspc_g02[18], average_kspc_g02[19], average_kspc_g02[20], average_kspc_g02[21]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8], average_bantap_l01[9], average_bantap_l01[10], average_bantap_l01[11], average_bantap_l01[12], average_bantap_l01[13], average_bantap_l01[14], average_bantap_l01[15], average_bantap_l01[16], average_bantap_l01[17], average_bantap_l01[18], average_bantap_l01[19], average_bantap_l01[20], average_bantap_l01[21]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8], average_pedc_t1l1[9], average_pedc_t1l1[10], average_pedc_t1l1[11], average_pedc_t1l1[12], average_pedc_t1l1[13], average_pedc_t1l1[14], average_pedc_t1l1[15], average_pedc_t1l1[16], average_pedc_t1l1[17], average_pedc_t1l1[18], average_pedc_t1l1[19], average_pedc_t1l1[20], average_pedc_t1l1[21]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8], average_pedc_t1l2[9], average_pedc_t1l2[10], average_pedc_t1l2[11], average_pedc_t1l2[12], average_pedc_t1l2[13], average_pedc_t1l2[14], average_pedc_t1l2[15], average_pedc_t1l2[16], average_pedc_t1l2[17], average_pedc_t1l2[18], average_pedc_t1l2[19], average_pedc_t1l2[20], average_pedc_t1l2[21]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8], average_stbar_t1l1[9], average_stbar_t1l1[10], average_stbar_t1l1[11], average_stbar_t1l1[12], average_stbar_t1l1[13], average_stbar_t1l1[14], average_stbar_t1l1[15], average_stbar_t1l1[16], average_stbar_t1l1[17], average_stbar_t1l1[18], average_stbar_t1l1[19], average_stbar_t1l1[20], average_stbar_t1l1[21]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9], average_pedc_u01[10], average_pedc_u01[11], average_pedc_u01[12], average_pedc_u01[13], average_pedc_u01[14], average_pedc_u01[15], average_pedc_u01[16], average_pedc_u01[17], average_pedc_u01[18], average_pedc_u01[19], average_pedc_u01[20], average_pedc_u01[21]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9], average_pedc_u02[10], average_pedc_u02[11], average_pedc_u02[12], average_pedc_u02[13], average_pedc_u02[14], average_pedc_u02[15], average_pedc_u02[16], average_pedc_u02[17], average_pedc_u02[18], average_pedc_u02[19], average_pedc_u02[20], average_pedc_u02[21]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9], average_pedc_u03[10], average_pedc_u03[11], average_pedc_u03[12], average_pedc_u03[13], average_pedc_u03[14], average_pedc_u03[15], average_pedc_u03[16], average_pedc_u03[17], average_pedc_u03[18], average_pedc_u03[19], average_pedc_u03[20], average_pedc_u03[21]]
            }
        elif hour_value == "23":
            data = {
                "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23"],
                # "03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8], average_botoca_g01[9], average_botoca_g01[10], average_botoca_g01[11], average_botoca_g01[12], average_botoca_g01[13], average_botoca_g01[14], average_botoca_g01[15], average_botoca_g01[16], average_botoca_g01[17], average_botoca_g01[18], average_botoca_g01[19], average_botoca_g01[20], average_botoca_g01[21], average_botoca_g01[22]],
                "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8], average_calaca_g01[9], average_calaca_g01[10], average_calaca_g01[11], average_calaca_g01[12], average_calaca_g01[13], average_calaca_g01[14], average_calaca_g01[15], average_calaca_g01[16], average_calaca_g01[17], average_calaca_g01[18], average_calaca_g01[19], average_calaca_g01[20], average_calaca_g01[21], average_calaca_g01[22]],
                "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8], average_calaca_g02[9], average_calaca_g02[10], average_calaca_g02[11], average_calaca_g02[12], average_calaca_g02[13], average_calaca_g02[14], average_calaca_g02[15], average_calaca_g02[16], average_calaca_g02[17], average_calaca_g02[18], average_calaca_g02[19], average_calaca_g02[20], average_calaca_g02[21], average_calaca_g02[22]],
                # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8], average_kal_g01[9], average_kal_g01[10], average_kal_g01[11], average_kal_g01[12], average_kal_g01[13], average_kal_g01[14], average_kal_g01[15], average_kal_g01[16], average_kal_g01[17], average_kal_g01[18], average_kal_g01[19], average_kal_g01[20], average_kal_g01[21], average_kal_g01[22]], 
                # "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8], average_kal_g02[9], average_kal_g02[10], average_kal_g02[11], average_kal_g02[12], average_kal_g02[13], average_kal_g02[14], average_kal_g02[15], average_kal_g02[16], average_kal_g02[17], average_kal_g02[18], average_kal_g02[19], average_kal_g02[20], average_kal_g02[21], average_kal_g02[22]], 
                # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8], average_kal_g03[9], average_kal_g03[10], average_kal_g03[11], average_kal_g03[12], average_kal_g03[13], average_kal_g03[14], average_kal_g03[15], average_kal_g03[16], average_kal_g03[17], average_kal_g03[18], average_kal_g03[19], average_kal_g03[20], average_kal_g03[21], average_kal_g03[22]],
                # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8], average_kal_g04[9], average_kal_g04[10], average_kal_g04[11], average_kal_g04[12], average_kal_g04[13], average_kal_g04[14], average_kal_g04[15], average_kal_g04[16], average_kal_g04[17], average_kal_g04[18], average_kal_g04[19], average_kal_g04[20], average_kal_g04[21], average_kal_g04[22]],
                "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8], average_leyte_a[9], average_leyte_a[10], average_leyte_a[11], average_leyte_a[12], average_leyte_a[13], average_leyte_a[14], average_leyte_a[15], average_leyte_a[16], average_leyte_a[17], average_leyte_a[18], average_leyte_a[19], average_leyte_a[20], average_leyte_a[21], average_leyte_a[22]],
                "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8], average_kspc_g01[9], average_kspc_g01[10], average_kspc_g01[11], average_kspc_g01[12], average_kspc_g01[13], average_kspc_g01[14], average_kspc_g01[15], average_kspc_g01[16], average_kspc_g01[17], average_kspc_g01[18], average_kspc_g01[19], average_kspc_g01[20], average_kspc_g01[21], average_kspc_g01[22]],
                "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8], average_kspc_g02[9], average_kspc_g02[10], average_kspc_g02[11], average_kspc_g02[12], average_kspc_g02[13], average_kspc_g02[14], average_kspc_g02[15], average_kspc_g02[16], average_kspc_g02[17], average_kspc_g02[18], average_kspc_g02[19], average_kspc_g02[20], average_kspc_g02[21], average_kspc_g02[22]], 
                "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8], average_bantap_l01[9], average_bantap_l01[10], average_bantap_l01[11], average_bantap_l01[12], average_bantap_l01[13], average_bantap_l01[14], average_bantap_l01[15], average_bantap_l01[16], average_bantap_l01[17], average_bantap_l01[18], average_bantap_l01[19], average_bantap_l01[20], average_bantap_l01[21], average_bantap_l01[22]],
                "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8], average_pedc_t1l1[9], average_pedc_t1l1[10], average_pedc_t1l1[11], average_pedc_t1l1[12], average_pedc_t1l1[13], average_pedc_t1l1[14], average_pedc_t1l1[15], average_pedc_t1l1[16], average_pedc_t1l1[17], average_pedc_t1l1[18], average_pedc_t1l1[19], average_pedc_t1l1[20], average_pedc_t1l1[21], average_pedc_t1l1[22]],
                "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8], average_pedc_t1l2[9], average_pedc_t1l2[10], average_pedc_t1l2[11], average_pedc_t1l2[12], average_pedc_t1l2[13], average_pedc_t1l2[14], average_pedc_t1l2[15], average_pedc_t1l2[16], average_pedc_t1l2[17], average_pedc_t1l2[18], average_pedc_t1l2[19], average_pedc_t1l2[20], average_pedc_t1l2[21], average_pedc_t1l2[22]],
                "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8], average_stbar_t1l1[9], average_stbar_t1l1[10], average_stbar_t1l1[11], average_stbar_t1l1[12], average_stbar_t1l1[13], average_stbar_t1l1[14], average_stbar_t1l1[15], average_stbar_t1l1[16], average_stbar_t1l1[17], average_stbar_t1l1[18], average_stbar_t1l1[19], average_stbar_t1l1[20], average_stbar_t1l1[21], average_stbar_t1l1[22]],
                "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9], average_pedc_u01[10], average_pedc_u01[11], average_pedc_u01[12], average_pedc_u01[13], average_pedc_u01[14], average_pedc_u01[15], average_pedc_u01[16], average_pedc_u01[17], average_pedc_u01[18], average_pedc_u01[19], average_pedc_u01[20], average_pedc_u01[21], average_pedc_u01[22]],
                "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9], average_pedc_u02[10], average_pedc_u02[11], average_pedc_u02[12], average_pedc_u02[13], average_pedc_u02[14], average_pedc_u02[15], average_pedc_u02[16], average_pedc_u02[17], average_pedc_u02[18], average_pedc_u02[19], average_pedc_u02[20], average_pedc_u02[21], average_pedc_u02[22]],
                "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9], average_pedc_u03[10], average_pedc_u03[11], average_pedc_u03[12], average_pedc_u03[13], average_pedc_u03[14], average_pedc_u03[15], average_pedc_u03[16], average_pedc_u03[17], average_pedc_u03[18], average_pedc_u03[19], average_pedc_u03[20], average_pedc_u03[21], average_pedc_u03[22]]
            }

        else:
            # data = {
            #     "HOUR": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24"],
            #     # "03BOTOCA_G01": [average_botoca_g01[0], average_botoca_g01[1], average_botoca_g01[2], average_botoca_g01[3], average_botoca_g01[4], average_botoca_g01[5], average_botoca_g01[6], average_botoca_g01[7], average_botoca_g01[8], average_botoca_g01[9], average_botoca_g01[10], average_botoca_g01[11], average_botoca_g01[12], average_botoca_g01[13], average_botoca_g01[14], average_botoca_g01[15], average_botoca_g01[16], average_botoca_g01[17], average_botoca_g01[18], average_botoca_g01[19], average_botoca_g01[20], average_botoca_g01[21], average_botoca_g01[22], average_botoca_g01[23]],
            #     "03CALACA_G01": [average_calaca_g01[0], average_calaca_g01[1], average_calaca_g01[2], average_calaca_g01[3], average_calaca_g01[4], average_calaca_g01[5], average_calaca_g01[6], average_calaca_g01[7], average_calaca_g01[8], average_calaca_g01[9], average_calaca_g01[10], average_calaca_g01[11], average_calaca_g01[12], average_calaca_g01[13], average_calaca_g01[14], average_calaca_g01[15], average_calaca_g01[16], average_calaca_g01[17], average_calaca_g01[18], average_calaca_g01[19], average_calaca_g01[20], average_calaca_g01[21], average_calaca_g01[22], average_calaca_g01[23]],
            #     "03CALACA_G02": [average_calaca_g02[0], average_calaca_g02[1], average_calaca_g02[2], average_calaca_g02[3], average_calaca_g02[4], average_calaca_g02[5], average_calaca_g02[6], average_calaca_g02[7], average_calaca_g02[8], average_calaca_g02[9], average_calaca_g02[10], average_calaca_g02[11], average_calaca_g02[12], average_calaca_g02[13], average_calaca_g02[14], average_calaca_g02[15], average_calaca_g02[16], average_calaca_g02[17], average_calaca_g02[18], average_calaca_g02[19], average_calaca_g02[20], average_calaca_g02[21], average_calaca_g02[22], average_calaca_g02[23]],
            #     # "03KAL_G01": [average_kal_g01[0], average_kal_g01[1], average_kal_g01[2], average_kal_g01[3], average_kal_g01[4], average_kal_g01[5], average_kal_g01[6], average_kal_g01[7], average_kal_g01[8], average_kal_g01[9], average_kal_g01[10], average_kal_g01[11], average_kal_g01[12], average_kal_g01[13], average_kal_g01[14], average_kal_g01[15], average_kal_g01[16], average_kal_g01[17], average_kal_g01[18], average_kal_g01[19], average_kal_g01[20], average_kal_g01[21], average_kal_g01[22], average_kal_g01[23]], 
            #     # "03KAL_G02": [average_kal_g02[0], average_kal_g02[1], average_kal_g02[2], average_kal_g02[3], average_kal_g02[4], average_kal_g02[5], average_kal_g02[6], average_kal_g02[7], average_kal_g02[8], average_kal_g02[9], average_kal_g02[10], average_kal_g02[11], average_kal_g02[12], average_kal_g02[13], average_kal_g02[14], average_kal_g02[15], average_kal_g02[16], average_kal_g02[17], average_kal_g02[18], average_kal_g02[19], average_kal_g02[20], average_kal_g02[21], average_kal_g02[22], average_kal_g02[23]], 
            #     # "03KAL_G03": [average_kal_g03[0], average_kal_g03[1], average_kal_g03[2], average_kal_g03[3], average_kal_g03[4], average_kal_g03[5], average_kal_g03[6], average_kal_g03[7], average_kal_g03[8], average_kal_g03[9], average_kal_g03[10], average_kal_g03[11], average_kal_g03[12], average_kal_g03[13], average_kal_g03[14], average_kal_g03[15], average_kal_g03[16], average_kal_g03[17], average_kal_g03[18], average_kal_g03[19], average_kal_g03[20], average_kal_g03[21], average_kal_g03[22], average_kal_g03[23]],
            #     # "03KAL_G04": [average_kal_g04[0], average_kal_g04[1], average_kal_g04[2], average_kal_g04[3], average_kal_g04[4], average_kal_g04[5], average_kal_g04[6], average_kal_g04[7], average_kal_g04[8], average_kal_g04[9], average_kal_g04[10], average_kal_g04[11], average_kal_g04[12], average_kal_g04[13], average_kal_g04[14], average_kal_g04[15], average_kal_g04[16], average_kal_g04[17], average_kal_g04[18], average_kal_g04[19], average_kal_g04[20], average_kal_g04[21], average_kal_g04[22], average_kal_g04[23]],
            #     "04LEYTE_A": [average_leyte_a[0], average_leyte_a[1], average_leyte_a[2], average_leyte_a[3], average_leyte_a[4], average_leyte_a[5], average_leyte_a[6], average_leyte_a[7], average_leyte_a[8], average_leyte_a[9], average_leyte_a[10], average_leyte_a[11], average_leyte_a[12], average_leyte_a[13], average_leyte_a[14], average_leyte_a[15], average_leyte_a[16], average_leyte_a[17], average_leyte_a[18], average_leyte_a[19], average_leyte_a[20], average_leyte_a[21], average_leyte_a[22], average_leyte_a[23]],
            #     "05KSPC_G01": [average_kspc_g01[0], average_kspc_g01[1], average_kspc_g01[2], average_kspc_g01[3], average_kspc_g01[4], average_kspc_g01[5], average_kspc_g01[6], average_kspc_g01[7], average_kspc_g01[8], average_kspc_g01[9], average_kspc_g01[10], average_kspc_g01[11], average_kspc_g01[12], average_kspc_g01[13], average_kspc_g01[14], average_kspc_g01[15], average_kspc_g01[16], average_kspc_g01[17], average_kspc_g01[18], average_kspc_g01[19], average_kspc_g01[20], average_kspc_g01[21], average_kspc_g01[22], average_kspc_g01[23]],
            #     "05KSPC_G02": [average_kspc_g02[0], average_kspc_g02[1], average_kspc_g02[2], average_kspc_g02[3], average_kspc_g02[4], average_kspc_g02[5], average_kspc_g02[6], average_kspc_g02[7], average_kspc_g02[8], average_kspc_g02[9], average_kspc_g02[10], average_kspc_g02[11], average_kspc_g02[12], average_kspc_g02[13], average_kspc_g02[14], average_kspc_g02[15], average_kspc_g02[16], average_kspc_g02[17], average_kspc_g02[18], average_kspc_g02[19], average_kspc_g02[20], average_kspc_g02[21], average_kspc_g02[22], average_kspc_g02[23]], 
            #     "08BANTAP_L01": [average_bantap_l01[0], average_bantap_l01[1], average_bantap_l01[2], average_bantap_l01[3], average_bantap_l01[4], average_bantap_l01[5], average_bantap_l01[6], average_bantap_l01[7], average_bantap_l01[8], average_bantap_l01[9], average_bantap_l01[10], average_bantap_l01[11], average_bantap_l01[12], average_bantap_l01[13], average_bantap_l01[14], average_bantap_l01[15], average_bantap_l01[16], average_bantap_l01[17], average_bantap_l01[18], average_bantap_l01[19], average_bantap_l01[20], average_bantap_l01[21], average_bantap_l01[22], average_bantap_l01[23]],
            #     "08PEDC_T1L1": [average_pedc_t1l1[0], average_pedc_t1l1[1], average_pedc_t1l1[2], average_pedc_t1l1[3], average_pedc_t1l1[4], average_pedc_t1l1[5], average_pedc_t1l1[6], average_pedc_t1l1[7], average_pedc_t1l1[8], average_pedc_t1l1[9], average_pedc_t1l1[10], average_pedc_t1l1[11], average_pedc_t1l1[12], average_pedc_t1l1[13], average_pedc_t1l1[14], average_pedc_t1l1[15], average_pedc_t1l1[16], average_pedc_t1l1[17], average_pedc_t1l1[18], average_pedc_t1l1[19], average_pedc_t1l1[20], average_pedc_t1l1[21], average_pedc_t1l1[22], average_pedc_t1l1[23]],
            #     "08PEDC_T1L2": [average_pedc_t1l2[0], average_pedc_t1l2[1], average_pedc_t1l2[2], average_pedc_t1l2[3], average_pedc_t1l2[4], average_pedc_t1l2[5], average_pedc_t1l2[6], average_pedc_t1l2[7], average_pedc_t1l2[8], average_pedc_t1l2[9], average_pedc_t1l2[10], average_pedc_t1l2[11], average_pedc_t1l2[12], average_pedc_t1l2[13], average_pedc_t1l2[14], average_pedc_t1l2[15], average_pedc_t1l2[16], average_pedc_t1l2[17], average_pedc_t1l2[18], average_pedc_t1l2[19], average_pedc_t1l2[20], average_pedc_t1l2[21], average_pedc_t1l2[22], average_pedc_t1l2[23]],
            #     "08STBAR_T1L1": [average_stbar_t1l1[0], average_stbar_t1l1[1], average_stbar_t1l1[2], average_stbar_t1l1[3], average_stbar_t1l1[4], average_stbar_t1l1[5], average_stbar_t1l1[6], average_stbar_t1l1[7], average_stbar_t1l1[8], average_stbar_t1l1[9], average_stbar_t1l1[10], average_stbar_t1l1[11], average_stbar_t1l1[12], average_stbar_t1l1[13], average_stbar_t1l1[14], average_stbar_t1l1[15], average_stbar_t1l1[16], average_stbar_t1l1[17], average_stbar_t1l1[18], average_stbar_t1l1[19], average_stbar_t1l1[20], average_stbar_t1l1[21], average_stbar_t1l1[22], average_stbar_t1l1[23]],
            #     "08PEDC_U01": [average_pedc_u01[0], average_pedc_u01[1], average_pedc_u01[2], average_pedc_u01[3], average_pedc_u01[4], average_pedc_u01[5], average_pedc_u01[6], average_pedc_u01[7], average_pedc_u01[8], average_pedc_u01[9], average_pedc_u01[10], average_pedc_u01[11], average_pedc_u01[12], average_pedc_u01[13], average_pedc_u01[14], average_pedc_u01[15], average_pedc_u01[16], average_pedc_u01[17], average_pedc_u01[18], average_pedc_u01[19], average_pedc_u01[20], average_pedc_u01[21], average_pedc_u01[22], average_pedc_u01[23]],
            #     "08PEDC_U02": [average_pedc_u02[0], average_pedc_u02[1], average_pedc_u02[2], average_pedc_u02[3], average_pedc_u02[4], average_pedc_u02[5], average_pedc_u02[6], average_pedc_u02[7], average_pedc_u02[8], average_pedc_u02[9], average_pedc_u02[10], average_pedc_u02[11], average_pedc_u02[12], average_pedc_u02[13], average_pedc_u02[14], average_pedc_u02[15], average_pedc_u02[16], average_pedc_u02[17], average_pedc_u02[18], average_pedc_u02[19], average_pedc_u02[20], average_pedc_u02[21], average_pedc_u02[22], average_pedc_u02[23]],
            #     "08PEDC_U03": [average_pedc_u03[0], average_pedc_u03[1], average_pedc_u03[2], average_pedc_u03[3], average_pedc_u03[4], average_pedc_u03[5], average_pedc_u03[6], average_pedc_u03[7], average_pedc_u03[8], average_pedc_u03[9], average_pedc_u03[10], average_pedc_u03[11], average_pedc_u03[12], average_pedc_u03[13], average_pedc_u03[14], average_pedc_u03[15], average_pedc_u03[16], average_pedc_u03[17], average_pedc_u03[18], average_pedc_u03[19], average_pedc_u03[20], average_pedc_u03[21], average_pedc_u03[22], average_pedc_u03[23]]
            # }

            data = {
                "HOUR": ["24"],
               # "03BOTOCA_G01": [average_botoca_g01[0]],
                "03CALACA_G01": [average_calaca_g01[0]],
                "03CALACA_G02": [average_calaca_g02[0]],
               # "03KAL_G01": [average_kal_g01[0]], 
               # "03KAL_G02": [average_kal_g02[0]], 
               # "03KAL_G03": [average_kal_g03[0]],
               # "03KAL_G04": [average_kal_g04[0]],
                "04LEYTE_A": [average_leyte_a[0]],
                "05KSPC_G01": [average_kspc_g01[0]],
                "05KSPC_G02": [average_kspc_g02[0]], 
                "08BANTAP_L01": [average_bantap_l01[0]],
                "08PEDC_T1L1": [average_pedc_t1l1[0]],
                "08PEDC_T1L2": [average_pedc_t1l2[0]],
                "08STBAR_T1L1": [average_stbar_t1l1[0]],
                "08PEDC_U01": [average_pedc_u01[0]],
                "08PEDC_U02": [average_pedc_u02[0]],
                "08PEDC_U03": [average_pedc_u03[0]]
            }
            
        # Create a DataFrame
        df_tipc = pd.DataFrame(data)

        # Melt the DataFrame to a long format
        df_long = df_tipc.melt(id_vars=['HOUR'], var_name='Resource', value_name='Value')

        # Pivot the DataFrame to prepare for hover information
        df_pivot = df_long.pivot(index='HOUR', columns='Resource', values='Value').fillna(0)
        df_pivot.reset_index(inplace=True)

        # Generate hover information
        # #hover_info = df_pivot.set_index('HOUR').apply(lambda x: '<br>'.join([f'{col}: {x[col]}' for col in x.index]), axis=1).to_dict()
        # hover_info = df_pivot.set_index('HOUR').apply(lambda x: '<br>'.join([f'{col}: {x[col]:.4f}' for col in x.index]), axis=1).to_dict()
        hover_info = df_pivot.set_index('HOUR').apply(lambda x: '<br>'.join([f'{col}: {x[col]:.4f}' for col in x.index]), axis=1).to_dict()

        # Merge hover information into long DataFrame
        df_long['Hover'] = df_long['HOUR'].map(hover_info)

        # Create the interactive line chart with Plotly
        fig_tipc = px.line(df_long, x='HOUR', y='Value', color='Resource', height=210)

        # # Customize hover information
        # fig_tipc.update_traces(hovertemplate='%{customdata[0]}', customdata=df_long[['Hover']].values)

        fig_tipc.update_traces(
            hovertemplate='HOUR: %{x}<br>%{customdata[0]}',
            customdata=df_long[['Hover']].values
        )
        
        fig_tipc.update_layout(
            title={
                'text':'Trading Interval Price Calculation',
                'font':{
                    'color': 'white' 
                }
            },
            margin=dict(r=30, t=30, b=30),
            plot_bgcolor='black',
            paper_bgcolor='black',
            xaxis=dict(
                tickmode='array',
                tickvals=list(range(1, 25)),
                ticktext=[str(i) for i in range(1, 25)],
                title={
                    'text':'Interval', 
                    'font':{
                        'color':'white'
                    }
                }
            ),
            yaxis=dict(
                title={
                    'text': 'PRICE, P/MWh',
                    'font':{
                        'color':'white'
                    }
                }
            )
        )
        return fig_tipc

        # -- END OF TRADING INTERVAL PRICE CALCULATION LINE CHART --

def bcq_func():
    # Load the workbook and select the active sheet
    # filepath_bcq = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\total_bcq_nomination.xlsx"
    filepath_bcq = 'total_bcq_nomination.xlsx'
    # filepath_bcq = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\total_bcq_nomination.xlsx"
    wb_bcq = openpyxl.load_workbook(filepath_bcq)
    sheet_bcq = wb_bcq.active

    # Create lists to store the data
    hours = []
    scpc_values = []
    kspc1_values = []
    kspc2_values = []
    edc_values = []
    pedc_values = []

    # Loop through column 'A' to get values for each hour, skip the header
    for row in sheet_bcq.iter_rows(min_row=2, max_row=25, min_col=1, max_col=5):
        hour = int(row[0].value)
        scpc = int(row[1].value)
        kspc = int(row[2].value)
        kspc1 = int(kspc/2)
        kspc2 = int(kspc/2)
        edc = int(row[3].value)
        pedc = int(row[4].value)

        # Store the values in the lists
        hours.append(hour)
        scpc_values.append(scpc)
        kspc1_values.append(kspc1)
        kspc2_values.append(kspc2)
        edc_values.append(edc)
        pedc_values.append(pedc)

    # Create a DataFrame with proper structure
    data_bcq = {
        'Hour': hours,
        'SEMCAL': scpc_values,
        'KSPC1': kspc1_values,
        'KSPC2': kspc2_values,
        'EDC': edc_values,
        'PEDC': pedc_values
    }

    df_bcq = pd.DataFrame(data_bcq)

    # Melt the DataFrame for Plotly
    df_bcq_melted = df_bcq.melt('Hour', var_name='Contracted Supplier', value_name='BCQ')

  # # Orange, Green, Light Blue, Dark Blue, Yellow, Pink, Purple, Brown
        # colors = ['#E3963E', '#228B22', '#ADD8E6', '#4682B4', '#FFDB58', '#FFC0CB', '#C3B1E1', '#C19A6B']
        #  # Red, Green, Light Blue, Dark Blue, Yellow, Pink, Purple, Brown
        # colors = ['#cc3333', '#228B22', '#ADD8E6', '#4682B4', '#FFDB58', '#FFC0CB', '#C3B1E1', '#C19A6B']
    # Define the color map
    color_map = {
        'SEMCAL': '#cc3333', 
        'KSPC1': '#FFC0CB', 
        'KSPC2': '#4682B4', 
        'EDC': '#228B22',
        'PEDC': '#FFA500'
    }

    # Create a Plotly area chart
    fig_bcq = px.area(df_bcq_melted, x='Hour', y='BCQ', color='Contracted Supplier', 
                labels={'Hour': 'Hour', 'BCQ': 'BCQ'}, color_discrete_map=color_map, # Apply the color map
                height=210)

    # Update layout to match the Altair configuration
    fig_bcq.update_layout(
        title={
                'text':'BCQ Nominations per Supplier',
                'font': {
                    'color': 'white' # Set title color to white
                }
            },
        margin=dict(r=30, t=30, b=30),
        plot_bgcolor='black',  # Set background color to black
        paper_bgcolor='black',  # Set paper background color to black
        xaxis_title='Interval',
        yaxis_title='kW',
        legend_title='Contracted Supplier'
    )

    # Update y-axis to show full number format
    fig_bcq.update_yaxes(tickformat=',')  # Use ',' to show numbers without abbreviating

    return fig_bcq 

        # -- END OF DISPLAYING THE BCQ NOMINATIONS PER SUPPLIER AREA CHART --

def genmix_func():
    # -- START OF DISPLAYING THE GENERATION MIX DONUT CHART --
        
        # actual_energy_excel = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\actual_energy.xlsx"
        actual_energy_excel = 'actual_energy.xlsx'
        # actual_energy_excel = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\actual_energy.xlsx"
        # total_bcq_nomination_excel = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\total_bcq_nomination.xlsx"
        total_bcq_nomination_excel = 'total_bcq_nomination.xlsx'
        # total_bcq_nomination_excel = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\total_bcq_nomination.xlsx"
        wesm_exposure_excel = 'wesm_exposure.xlsx'
        # wesm_exposure_excel = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\wesm_exposure.xlsx"
        # wesm_exposure_excel = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\wesm_exposure.xlsx"
        # Generation Mix Excel file
        workbook = openpyxl.Workbook()
        sheet = workbook.active
        sheet['A1'] = 'ACTUAL_ENERGY'
        sheet['B1'] = 'TOTAL_BCQ'
        sheet['C1'] = 'SCPC'
        sheet['D1'] = 'KSPC'
        sheet['E1'] = 'KSPC1'
        sheet['F1'] = 'KSPC2'
        sheet['G1'] = 'EDC'
        sheet['H1'] = 'WESM'
        sheet['I1'] = 'HOUR'
        sheet['I2'] = 1
        sheet['I3'] = 2
        sheet['I4'] = 3
        sheet['I5'] = 4
        sheet['I6'] = 5
        sheet['I7'] = 6
        sheet['I8'] = 7
        sheet['I9'] = 8
        sheet['I10'] = 9
        sheet['I11'] = 10
        sheet['I12'] = 11
        sheet['I13'] = 12
        sheet['I14'] = 13
        sheet['I15'] = 14
        sheet['I16'] = 15
        sheet['I17'] = 16
        sheet['I18'] = 17
        sheet['I19'] = 18
        sheet['I20'] = 19
        sheet['I21'] = 20
        sheet['I22'] = 21
        sheet['I23'] = 22
        sheet['I24'] = 23
        sheet['I25'] = 24
        sheet['J1'] = 'PEDC'
        workbook.save('generation_mix.xlsx')
        workbook.close()
        print("Excel file 'generation_mix.xlsx' created successfully.")

        source_wb_genmix_1 = load_workbook(actual_energy_excel) 
        source_sheet_genmix_1 = source_wb_genmix_1['Sheet']
        
        # genmix_filepath = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\generation_mix.xlsx"
        genmix_filepath = 'generation_mix.xlsx'
        # genmix_filepath = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\generation_mix.xlsx"
        dest_wb_genmix = load_workbook(genmix_filepath)

        dest_sheet_genmix = dest_wb_genmix['Sheet']

        source_ranges_genmix_1 = [('D2', 'D25')]
        dest_ranges_genmix_1 = [('A2', 'A25')]

        for i in range(len(source_ranges_genmix_1)):
            copy_values(source_sheet_genmix_1, dest_sheet_genmix, source_ranges_genmix_1[i], dest_ranges_genmix_1[i])

        # Save the destination workbook
        dest_wb_genmix.save(genmix_filepath)

        source_wb_genmix_2 = load_workbook(total_bcq_nomination_excel)
        source_sheet_genmix_2 = source_wb_genmix_2['Sheet']

        source_ranges_genmix_2 = [('E2', 'E25'), ('B2', 'B25'), ('C2', 'C25'), ('D2', 'D25'), ('E2', 'E25')]
        dest_ranges_genmix_2 = [('B2', 'B25'), ('C2', 'C25'), ('D2', 'D25'), ('G2', 'G25'), ('J2', 'J25')]

        for i in range(len(source_ranges_genmix_2)):
            copy_values(source_sheet_genmix_2, dest_sheet_genmix, source_ranges_genmix_2[i], dest_ranges_genmix_2[i])

        # Save the destination workbook
        dest_wb_genmix.save(genmix_filepath)

        kspc_value_1 = source_sheet_genmix_2['C2'].value
        half_value_1 = int(kspc_value_1 / 2)
        dest_sheet_genmix['E2'] = half_value_1
        dest_sheet_genmix['F2'] = half_value_1

        kspc_value_2 = source_sheet_genmix_2['C3'].value
        half_value_2 = int(kspc_value_2 / 2)
        dest_sheet_genmix['E3'] = half_value_2
        dest_sheet_genmix['F3'] = half_value_2

        kspc_value_3 = source_sheet_genmix_2['C4'].value
        half_value_3 = int(kspc_value_3 / 2)
        dest_sheet_genmix['E4'] = half_value_3
        dest_sheet_genmix['F4'] = half_value_3

        kspc_value_4 = source_sheet_genmix_2['C5'].value
        half_value_4 = int(kspc_value_4 / 2)
        dest_sheet_genmix['E5'] = half_value_4
        dest_sheet_genmix['F5'] = half_value_4

        kspc_value_5 = source_sheet_genmix_2['C6'].value
        half_value_5 = int(kspc_value_5 / 2)
        dest_sheet_genmix['E6'] = half_value_5
        dest_sheet_genmix['F6'] = half_value_5

        kspc_value_6 = source_sheet_genmix_2['C7'].value
        half_value_6 = int(kspc_value_6 / 2)
        dest_sheet_genmix['E7'] = half_value_6
        dest_sheet_genmix['F7'] = half_value_6

        kspc_value_7 = source_sheet_genmix_2['C8'].value
        half_value_7 = int(kspc_value_7 / 2)
        dest_sheet_genmix['E8'] = half_value_7
        dest_sheet_genmix['F8'] = half_value_7

        kspc_value_8 = source_sheet_genmix_2['C9'].value
        half_value_8 = int(kspc_value_8 / 2)
        dest_sheet_genmix['E9'] = half_value_8
        dest_sheet_genmix['F9'] = half_value_8

        kspc_value_9 = source_sheet_genmix_2['C10'].value
        half_value_9 = int(kspc_value_9 / 2)
        dest_sheet_genmix['E10'] = half_value_9
        dest_sheet_genmix['F10'] = half_value_9

        kspc_value_10 = source_sheet_genmix_2['C11'].value
        half_value_10 = int(kspc_value_10 / 2)
        dest_sheet_genmix['E11'] = half_value_10
        dest_sheet_genmix['F11'] = half_value_10

        kspc_value_11 = source_sheet_genmix_2['C12'].value
        half_value_11 = int(kspc_value_11 / 2)
        dest_sheet_genmix['E12'] = half_value_11
        dest_sheet_genmix['F12'] = half_value_11

        kspc_value_12 = source_sheet_genmix_2['C13'].value
        half_value_12 = int(kspc_value_12 / 2)
        dest_sheet_genmix['E13'] = half_value_12
        dest_sheet_genmix['F13'] = half_value_12

        kspc_value_13 = source_sheet_genmix_2['C14'].value
        half_value_13 = int(kspc_value_13 / 2)
        dest_sheet_genmix['E14'] = half_value_13
        dest_sheet_genmix['F14'] = half_value_13

        kspc_value_14 = source_sheet_genmix_2['C15'].value
        half_value_14 = int(kspc_value_14 / 2)
        dest_sheet_genmix['E15'] = half_value_14
        dest_sheet_genmix['F15'] = half_value_14

        kspc_value_15 = source_sheet_genmix_2['C16'].value
        half_value_15 = int(kspc_value_15 / 2)
        dest_sheet_genmix['E16'] = half_value_15
        dest_sheet_genmix['F16'] = half_value_15

        kspc_value_16 = source_sheet_genmix_2['C17'].value
        half_value_16 = int(kspc_value_16 / 2)
        dest_sheet_genmix['E17'] = half_value_16
        dest_sheet_genmix['F17'] = half_value_16

        kspc_value_17 = source_sheet_genmix_2['C18'].value
        half_value_17 = int(kspc_value_17 / 2)
        dest_sheet_genmix['E18'] = half_value_17
        dest_sheet_genmix['F18'] = half_value_17

        kspc_value_18 = source_sheet_genmix_2['C19'].value
        half_value_18 = int(kspc_value_18 / 2)
        dest_sheet_genmix['E19'] = half_value_18
        dest_sheet_genmix['F19'] = half_value_18

        kspc_value_19 = source_sheet_genmix_2['C20'].value
        half_value_19 = int(kspc_value_19 / 2)
        dest_sheet_genmix['E20'] = half_value_19
        dest_sheet_genmix['F20'] = half_value_19

        kspc_value_20 = source_sheet_genmix_2['C21'].value
        half_value_20 = int(kspc_value_20 / 2)
        dest_sheet_genmix['E21'] = half_value_20
        dest_sheet_genmix['F21'] = half_value_20

        kspc_value_21 = source_sheet_genmix_2['C22'].value
        half_value_21 = int(kspc_value_21 / 2)
        dest_sheet_genmix['E22'] = half_value_21
        dest_sheet_genmix['F22'] = half_value_21

        kspc_value_22 = source_sheet_genmix_2['C23'].value
        half_value_22 = int(kspc_value_22 / 2)
        dest_sheet_genmix['E23'] = half_value_22
        dest_sheet_genmix['F23'] = half_value_22

        kspc_value_23 = source_sheet_genmix_2['C24'].value
        half_value_23 = int(kspc_value_23 / 2)
        dest_sheet_genmix['E24'] = half_value_23
        dest_sheet_genmix['F24'] = half_value_23

        kspc_value_24 = source_sheet_genmix_2['C25'].value
        half_value_24 = int(kspc_value_24 / 2)
        dest_sheet_genmix['E25'] = half_value_24
        dest_sheet_genmix['F25'] = half_value_24

        # Save the destination workbook
        dest_wb_genmix.save(genmix_filepath)

        source_wb_genmix_3 = load_workbook(wesm_exposure_excel)
        source_sheet_genmix_3 = source_wb_genmix_3['Sheet']
        
        source_ranges_genmix_3 = [('E2', 'E25')]
        dest_ranges_genmix_3 = [('H2', 'H25')]

        for i in range(len(source_ranges_genmix_3)):
            copy_values(source_sheet_genmix_3, dest_sheet_genmix, source_ranges_genmix_3[i], dest_ranges_genmix_3[i])

        # Save the destination workbook
        dest_wb_genmix.save(genmix_filepath)

        # CASE A. ACTUAL ENERGY <= BCQ
        # SCPC, KSPC1, KSPC2, EDC

        # CASE B. ACTUAL ENERGY > BCQ
        # SCPC, KSPC1, KSPC2, EDC, WESM

        now = datetime.now()
        current_hour = now.hour
        if current_hour == 0:
            current_hour = 24

        # Initialize empty list containing Generation Mix values
        generation_mix_list = []

        # HOUR 1
        if current_hour == dest_sheet_genmix['I2'].value:
            if dest_sheet_genmix['A2'].value <= dest_sheet_genmix['B2'].value:
                generation_mix_list.append(dest_sheet_genmix['C2'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E2'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F2'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G2'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J2'].value) #PEDC

            elif dest_sheet_genmix['A2'].value > dest_sheet_genmix['B2'].value:
                generation_mix_list.append(dest_sheet_genmix['C2'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E2'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F2'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G2'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J2'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H2'].value) #WESM

        # HOUR 2
        elif current_hour == dest_sheet_genmix['I3'].value:
            if dest_sheet_genmix['A3'].value <= dest_sheet_genmix['B3'].value:
                generation_mix_list.append(dest_sheet_genmix['C3'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E3'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F3'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G3'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J3'].value) #PEDC

            elif dest_sheet_genmix['A3'].value > dest_sheet_genmix['B3'].value:
                generation_mix_list.append(dest_sheet_genmix['C3'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E3'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F3'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G3'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J3'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H3'].value) #WESM

        # HOUR 3
        elif current_hour == dest_sheet_genmix['I4'].value:
            if dest_sheet_genmix['A4'].value <= dest_sheet_genmix['B4'].value:
                generation_mix_list.append(dest_sheet_genmix['C4'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E4'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F4'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G4'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J4'].value) #PEDC

            elif dest_sheet_genmix['A4'].value > dest_sheet_genmix['B4'].value:
                generation_mix_list.append(dest_sheet_genmix['C4'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E4'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F4'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G4'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J4'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H4'].value) #WESM

        # HOUR 4
        elif current_hour == dest_sheet_genmix['I5'].value:
            if dest_sheet_genmix['A5'].value <= dest_sheet_genmix['B5'].value:
                generation_mix_list.append(dest_sheet_genmix['C5'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E5'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F5'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G5'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J5'].value) #PEDC

            elif dest_sheet_genmix['A5'].value > dest_sheet_genmix['B5'].value:
                generation_mix_list.append(dest_sheet_genmix['C5'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E5'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F5'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G5'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J5'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H5'].value) #WESM
        
        # HOUR 5
        elif current_hour == dest_sheet_genmix['I6'].value:
            if dest_sheet_genmix['A6'].value <= dest_sheet_genmix['B6'].value:
                generation_mix_list.append(dest_sheet_genmix['C6'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E6'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F6'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G6'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J6'].value) #PEDC

            elif dest_sheet_genmix['A6'].value > dest_sheet_genmix['B6'].value:
                generation_mix_list.append(dest_sheet_genmix['C6'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E6'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F6'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G6'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J6'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H6'].value) #WESM

        # HOUR 6  
        elif current_hour == dest_sheet_genmix['I7'].value:
            if dest_sheet_genmix['A7'].value <= dest_sheet_genmix['B7'].value:
                generation_mix_list.append(dest_sheet_genmix['C7'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E7'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F7'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G7'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J7'].value) #PEDC

            elif dest_sheet_genmix['A7'].value > dest_sheet_genmix['B7'].value:
                generation_mix_list.append(dest_sheet_genmix['C7'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E7'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F7'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G7'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J7'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H7'].value) #WESM
        
        # HOUR 7
        elif current_hour == dest_sheet_genmix['I8'].value:
            if dest_sheet_genmix['A8'].value <= dest_sheet_genmix['B8'].value:
                generation_mix_list.append(dest_sheet_genmix['C8'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E8'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F8'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G8'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J8'].value) #PEDC

            elif dest_sheet_genmix['A8'].value > dest_sheet_genmix['B8'].value:
                generation_mix_list.append(dest_sheet_genmix['C8'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E8'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F8'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G8'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J8'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H8'].value) #WESM
        
        # HOUR 8
        elif current_hour == dest_sheet_genmix['I9'].value:
            if dest_sheet_genmix['A9'].value <= dest_sheet_genmix['B9'].value:
                generation_mix_list.append(dest_sheet_genmix['C9'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E9'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F9'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G9'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J9'].value) #PEDC

            elif dest_sheet_genmix['A9'].value > dest_sheet_genmix['B9'].value:
                generation_mix_list.append(dest_sheet_genmix['C9'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E9'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F9'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G9'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J9'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H9'].value) #WESM

        # HOUR 9
        elif current_hour == dest_sheet_genmix['I10'].value:
            if dest_sheet_genmix['A10'].value <= dest_sheet_genmix['B10'].value:
                generation_mix_list.append(dest_sheet_genmix['C10'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E10'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F10'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G10'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J10'].value) #PEDC

            elif dest_sheet_genmix['A10'].value > dest_sheet_genmix['B10'].value:
                generation_mix_list.append(dest_sheet_genmix['C10'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E10'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F10'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G10'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J10'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H10'].value) #WESM
        
        # HOUR 10
        elif current_hour == dest_sheet_genmix['I11'].value:
            if dest_sheet_genmix['A11'].value <= dest_sheet_genmix['B11'].value:
                generation_mix_list.append(dest_sheet_genmix['C11'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E11'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F11'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G11'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J11'].value) #PEDC

            elif dest_sheet_genmix['A11'].value > dest_sheet_genmix['B11'].value:
                generation_mix_list.append(dest_sheet_genmix['C11'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E11'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F11'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G11'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J11'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H11'].value) #WESM

        # HOUR 11
        elif current_hour == dest_sheet_genmix['I12'].value:
            if dest_sheet_genmix['A12'].value <= dest_sheet_genmix['B12'].value:
                generation_mix_list.append(dest_sheet_genmix['C12'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E12'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F12'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G12'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J12'].value) #PEDC

            elif dest_sheet_genmix['A12'].value > dest_sheet_genmix['B12'].value:
                generation_mix_list.append(dest_sheet_genmix['C12'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E12'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F12'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G12'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J12'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H12'].value) #WESM

        # HOUR 12
        elif current_hour == dest_sheet_genmix['I13'].value:
            if dest_sheet_genmix['A13'].value <= dest_sheet_genmix['B13'].value:
                generation_mix_list.append(dest_sheet_genmix['C13'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E13'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F13'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G13'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J13'].value) #PEDC

            elif dest_sheet_genmix['A13'].value > dest_sheet_genmix['B13'].value:
                generation_mix_list.append(dest_sheet_genmix['C13'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E13'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F13'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G13'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J13'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H13'].value) #WESM
        
        # HOUR 13
        elif current_hour == dest_sheet_genmix['I14'].value:
            if dest_sheet_genmix['A14'].value <= dest_sheet_genmix['B14'].value:
                generation_mix_list.append(dest_sheet_genmix['C14'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E14'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F14'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G14'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J14'].value) #PEDC

            elif dest_sheet_genmix['A14'].value > dest_sheet_genmix['B14'].value:
                generation_mix_list.append(dest_sheet_genmix['C14'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E14'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F14'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G14'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J14'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H14'].value) #WESM
        
        # HOUR 14
        elif current_hour == dest_sheet_genmix['I15'].value:
            if dest_sheet_genmix['A15'].value <= dest_sheet_genmix['B15'].value:
                generation_mix_list.append(dest_sheet_genmix['C15'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E15'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F15'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G15'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J15'].value) #PEDC

            elif dest_sheet_genmix['A15'].value > dest_sheet_genmix['B15'].value:
                generation_mix_list.append(dest_sheet_genmix['C15'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E15'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F15'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G15'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J15'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H15'].value) #WESM
        
        # HOUR 15
        elif current_hour == dest_sheet_genmix['I16'].value:
            if dest_sheet_genmix['A16'].value <= dest_sheet_genmix['B16'].value:
                generation_mix_list.append(dest_sheet_genmix['C16'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E16'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F16'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G16'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J16'].value) #PEDC

            elif dest_sheet_genmix['A16'].value > dest_sheet_genmix['B16'].value:
                generation_mix_list.append(dest_sheet_genmix['C16'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E16'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F16'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G16'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J16'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H16'].value) #WESM
        
        # HOUR 16
        elif current_hour == dest_sheet_genmix['I17'].value:
            if dest_sheet_genmix['A17'].value <= dest_sheet_genmix['B17'].value:
                generation_mix_list.append(dest_sheet_genmix['C17'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E17'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F17'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G17'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J17'].value) #PEDC

            elif dest_sheet_genmix['A17'].value > dest_sheet_genmix['B17'].value:
                generation_mix_list.append(dest_sheet_genmix['C17'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E17'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F17'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G17'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J17'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H17'].value) #WESM
        
        # HOUR 17
        elif current_hour == dest_sheet_genmix['I18'].value:
            if dest_sheet_genmix['A18'].value <= dest_sheet_genmix['B18'].value:
                generation_mix_list.append(dest_sheet_genmix['C18'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E18'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F18'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G18'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J18'].value) #PEDC

            elif dest_sheet_genmix['A18'].value > dest_sheet_genmix['B18'].value:
                generation_mix_list.append(dest_sheet_genmix['C18'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E18'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F18'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G18'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J18'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H18'].value) #WESM
        
        # HOUR 18
        elif current_hour == dest_sheet_genmix['I19'].value:
            if dest_sheet_genmix['A19'].value <= dest_sheet_genmix['B19'].value:
                generation_mix_list.append(dest_sheet_genmix['C19'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E19'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F19'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G19'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J19'].value) #PEDC

            elif dest_sheet_genmix['A19'].value > dest_sheet_genmix['B19'].value:
                generation_mix_list.append(dest_sheet_genmix['C19'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E19'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F19'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G19'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J19'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H19'].value) #WESM
        
        # HOUR 19
        elif current_hour == dest_sheet_genmix['I20'].value:
            if dest_sheet_genmix['A20'].value <= dest_sheet_genmix['B20'].value:
                generation_mix_list.append(dest_sheet_genmix['C20'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E20'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F20'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G20'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J20'].value) #PEDC

            elif dest_sheet_genmix['A20'].value > dest_sheet_genmix['B20'].value:
                generation_mix_list.append(dest_sheet_genmix['C20'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E20'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F20'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G20'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J20'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H20'].value) #WESM

        # HOUR 20
        elif current_hour == dest_sheet_genmix['I21'].value:
            if dest_sheet_genmix['A21'].value <= dest_sheet_genmix['B21'].value:
                generation_mix_list.append(dest_sheet_genmix['C21'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E21'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F21'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G21'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J21'].value) #PEDC

            elif dest_sheet_genmix['A21'].value > dest_sheet_genmix['B21'].value:
                generation_mix_list.append(dest_sheet_genmix['C21'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E21'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F21'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G21'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J21'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H21'].value) #WESM
        
        # HOUR 21
        elif current_hour == dest_sheet_genmix['I22'].value:
            if dest_sheet_genmix['A22'].value <= dest_sheet_genmix['B22'].value:
                generation_mix_list.append(dest_sheet_genmix['C22'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E22'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F22'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G22'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J22'].value) #PEDC

            elif dest_sheet_genmix['A22'].value > dest_sheet_genmix['B22'].value:
                generation_mix_list.append(dest_sheet_genmix['C22'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E22'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F22'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G22'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J22'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H22'].value) #WESM
        
        # HOUR 22
        elif current_hour == dest_sheet_genmix['I23'].value:
            if dest_sheet_genmix['A23'].value <= dest_sheet_genmix['B23'].value:
                generation_mix_list.append(dest_sheet_genmix['C23'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E23'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F23'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G23'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J23'].value) #PEDC

            elif dest_sheet_genmix['A23'].value > dest_sheet_genmix['B23'].value:
                generation_mix_list.append(dest_sheet_genmix['C23'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E23'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F23'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G23'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J23'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H23'].value) #WESM
        
        # HOUR 23
        elif current_hour == dest_sheet_genmix['I24'].value:
            if dest_sheet_genmix['A24'].value <= dest_sheet_genmix['B24'].value:
                generation_mix_list.append(dest_sheet_genmix['C24'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E24'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F24'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G24'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J24'].value) #PEDC

            elif dest_sheet_genmix['A24'].value > dest_sheet_genmix['B24'].value:
                generation_mix_list.append(dest_sheet_genmix['C24'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E24'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F24'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G24'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J24'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H24'].value) #WESM

        # HOUR 24
        elif current_hour == dest_sheet_genmix['I25'].value:
            if dest_sheet_genmix['A25'].value <= dest_sheet_genmix['B25'].value:
                generation_mix_list.append(dest_sheet_genmix['C25'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E25'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F25'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G25'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J25'].value) #PEDC

            elif dest_sheet_genmix['A25'].value > dest_sheet_genmix['B25'].value:
                generation_mix_list.append(dest_sheet_genmix['C25'].value) #SCPC
                generation_mix_list.append(dest_sheet_genmix['E25'].value) #KSPC1
                generation_mix_list.append(dest_sheet_genmix['F25'].value) #KSPC2
                generation_mix_list.append(dest_sheet_genmix['G25'].value) #EDC
                generation_mix_list.append(dest_sheet_genmix['J25'].value) #PEDC
                generation_mix_list.append(dest_sheet_genmix['H25'].value) #WESM
        
        if len(generation_mix_list) == 5:
            genmix_data = {
            'Names': ['SEMCAL', 'KSPC1', 'KSPC2', 'EDC', 'PEDC'],
            'Values': generation_mix_list
            }

        elif len(generation_mix_list) == 6:
            genmix_data = {
            'Names': ['SEMCAL', 'KSPC1', 'KSPC2', 'EDC', 'PEDC', 'WESM'],
            'Values': generation_mix_list
            }

        genmix_df = pd.DataFrame(genmix_data)

        # Creating the donut chart
        fig_genmix = px.pie(genmix_df, values='Values', names='Names', hole=0.5)

        # Customizing the labels to appear on the slices
        fig_genmix.update_traces(
            textposition='outside',    # Places the text inside the slices
            textinfo='label+percent', # Shows both the label and percentage inside the slices
            insidetextorientation='horizontal',  # Keeps text horizontal inside the slices
            marker=dict(
                colors=['#cc3333', '#FFC0CB', '#4682B4', '#228B22', '#FFA500', '#FFDB58']
            )
        )

        fig_genmix.update_layout(
            height=210
        )

        fig_genmix.update_layout(
            title={
                'text':'Generation Mix',
                'font':{
                    'color': 'white' # Set title color to white
                }
            },
            margin=dict(r=40, t=40, b=60),
            plot_bgcolor='black',
            paper_bgcolor='black'
        )

        return fig_genmix

        # -- END OF DISPLAYING THE GENERATION MIX DONUT CHART --

# Set the page layout to wide
st.set_page_config(
    page_title="MORE Energy Trading Dashboard",
    page_icon="data/logo_only.png",
    layout="wide"
)

# -- USER AUTHENTICATION --
names = ["MORE Electric and Power Corporation", "Niel Parcon", "Roel Castro"]
usernames = ["more", "nparcon", "rcastro"]

file_path = Path(__file__).parent / "hashed_pw_new.pkl"
if file_path.exists():
    with file_path.open("rb") as file:
        hashed_passwords = pickle.load(file)
else:
    st.error("Hashed passwords file not found.")
    st.stop()

credentials = {
    "usernames": {
        usernames[i]: {"name": names[i], "password": hashed_passwords[i]}
        for i in range(len(usernames))
    }
}

authenticator = stauth.Authenticate(
    credentials,
    "mepc_energy_trading_dashboard",
    "morepower",
    cookie_expiry_days=365 # Ask for username and password again after 1 year
)

# Apply custom CSS
st.markdown("""
    <style>
    /* Target the Streamlit main container */
    .st-emotion-cache-1fmfajh {
        width: 40%;
        margin: 0 auto;
        padding: 1rem;
        background-color: #90EE90;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        text-align: center; /* Center content inside the div */
    }
    .stButton button {
        width: 100%;
        padding: 0.75rem;
        font-size: 1rem;
        color: white;
        background-color: #007BFF; /* Button background color */
        border: none; /* Remove button border */
        border-radius: 0.5rem; /* Add button border-radius */
    }
    </style>
    """, unsafe_allow_html=True)

user_pass_css = """
<style>
input[aria-label="Username"] { 
    color: white; 
}
input[aria-label="Password"] { 
    color: white; 
}
</style>
"""

st.markdown(user_pass_css, unsafe_allow_html=True)

# # Create a placeholder for the image
# image_placeholder = st.empty()

name, authentication_status, username = authenticator.login("main")

# if authentication_status is None or authentication_status == False:
#     image_placeholder.image(resized_image, use_column_width=True)

if authentication_status==False:
    st.markdown(
        """
        <style>
        .custom-warning {
            color: #8B0000; /* Custom warning color (orange) */
            background-color: #FFF3CD; /* Background color */
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 16px;
            border: 1px solid #FFCC00;
            width: 40%;
            margin: auto;
        }
        </style>
        <div class="custom-warning">
            ❌ Wrong username/password!
        </div>
        """,
        unsafe_allow_html=True
    )

if authentication_status is None:
    st.markdown(
        """
        <style>
        .custom-warning {
            color: #8B4000; /* Custom warning color (orange) */
            background-color: #FFF3CD; /* Background color */
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 16px;
            border: 1px solid #FFCC00;
            width: 40%;
            margin: auto;
        }
        </style>
        <div class="custom-warning">
            💡 Please enter your username and password.
        </div>
        """,
        unsafe_allow_html=True
    )

if authentication_status == True:
    # # Clear the image after successful login
    # image_placeholder.empty()

    # Initialize session state variables
    if 'rerun_called' not in st.session_state:
        st.session_state['rerun_called'] = False

    # Check if rerun has been called
    if not st.session_state['rerun_called']:
        # Set the flag and trigger rerun
        st.session_state['rerun_called'] = True
        st.rerun()

    while True: 
        # current_interval_file()
        # forecasted_energy_file()
        # total_bcq_nomination_file()
        # contestable_energy_file()
        # more_trading_node_file()
        # more_trading_node_2nd_part_file()
        # total_substation_load_final_file()
        # actual_energy_file()
        # wesm_exposure_file()
        # current_rate_file()
        # get_temp_weather_data_file()
        # store_temp_weather_db_file()
        # so_advisories_file()
        # mo_advisories_file()
        # advisories_file()

        # Add custom CSS
        st.markdown(
            """
            <style>
            /* This targets the main block content within a container */
            .main .block-container {
                padding-left: 13px;    /* Adjust left padding */
                padding-right: 13px;   /* Adjust right padding */
                padding-top: 0px;
                padding-bottom: 13px;
            }
            /* Additional styles to target specific elements within the container if needed */
            .stContainer {
                padding-left: 13px;    /* Adjust left padding */
                padding-right: 13px;   /* Adjust right padding */
                padding-top: 0rem;
                padding-bottom: 0rem;
            }
            </style>
            """,
            unsafe_allow_html=True
        )

        margins_css = """
        <style>
            .main > div {
                padding-left: 0rem;
                padding-right: 0rem;
            }
        </style>
    """

        st.markdown(margins_css, unsafe_allow_html=True)

        # Path to your image
        image_path = 'data/MORE_Power_Logo.png'

        # Hide the Streamlit header and footer
        st.markdown("""
            <style>
            /* Hide Streamlit header */
            header {visibility: hidden;}
            /* Hide Streamlit footer */
            footer {visibility: hidden;}
            </style>
            """, unsafe_allow_html=True)

        # Connection
        conn=mysql.connector.connect(
            host = "cesra-db.cxkuksua06qz.ap-southeast-1.rds.amazonaws.com",
            port = 3309,
            user = "cesra_dbm",
            passwd = "ibIDN0NcnGYo71qDZuHw",
            db = "myDb"
        )

        c=conn.cursor()

        # # -- START OF SO ADVISORIES HEADER --
        # # Prepare the initial data for scrolling
        # scrollable_content = []
        # # Load your Excel file
        # #excel_file_so = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\SO_ADVISORIES.xlsx"
        # excel_file_so = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\SO_ADVISORIES.xlsx"
        # df_so_advisories = pd.read_excel(excel_file_so)
        # # Sort dataframe by TIME_MESSAGE in descending order
        # df_so_advisories = df_so_advisories.sort_values(by='TIME_MESSAGE', ascending=False)

        # # Convert TIME_MESSAGE to datetime format (if it's not already)
        # df_so_advisories['TIME_MESSAGE'] = pd.to_datetime(df_so_advisories['TIME_MESSAGE'], errors='coerce')

        # # Drop rows where TIME_MESSAGE couldn't be converted to datetime (if needed)
        # df_so_advisories = df_so_advisories.dropna(subset=['TIME_MESSAGE'])

        # # Sort dataframe by TIME_MESSAGE in descending order
        # df_so_advisories = df_so_advisories.sort_values(by='TIME_MESSAGE', ascending=False)

        # # Function to fetch latest 10 entries
        # latest_10_entries = fetch_latest_10_entries(df_so_advisories)
        # for index, row in latest_10_entries.iterrows():
        #     time_message = row['TIME_MESSAGE'].strftime('%Y/%m/%d %H:%M:%S')
        #     message = row['MESSAGE']
        #     entry_text = f"{time_message}: {message}"
        #     scrollable_content.append(entry_text)  
                
        # # -- END OF SO ADVISORIES HEADER --

        # # -- START OF MO ADVISORIES HEADER --
        # # Prepare the initial data for scrolling
        # scrollable_content_2 = []
        # # Load your Excel file
        # #excel_file_mo = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\MO_ADVISORIES.xlsx"
        # excel_file_mo = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\MO_ADVISORIES.xlsx"
        # df_mo_advisories = pd.read_excel(excel_file_mo)
        
        # # Sort dataframe by TIMESTAMP in descending order
        # df_mo_advisories = df_mo_advisories.sort_values(by='TIMESTAMP', ascending=False)

        # latest_entry = fetch_latest_entry(df_mo_advisories)
        # for index, row in latest_entry.iterrows():
        #     time_message_2 = row['TIMESTAMP']
        #     message_2 = row['ADVISORY']
        #     entry_text_2 = f"{time_message_2} - {message_2}"
        #     scrollable_content_2.append(entry_text_2)

        # # -- END OF MO ADVISORIES HEADER --

        # # HTML and CSS for the tickers
        # html_code = f"""
        # <style>
        # * {{
        #     box-sizing: border-box;
        # }}
        # @-webkit-keyframes ticker {{
        #     0% {{
        #         -webkit-transform: translate3d(0, 0, 0);
        #         transform: translate3d(0, 0, 0);
        #         visibility: visible;
        #     }}
        #     100% {{
        #         -webkit-transform: translate3d(-100%, 0, 0);
        #         transform: translate3d(-100%, 0, 0);
        #     }}
        # }}
        # @keyframes ticker {{
        #     0% {{
        #         -webkit-transform: translate3d(0, 0, 0);
        #         transform: translate3d(0, 0, 0);
        #         visibility: visible;
        #     }}
        #     100% {{
        #         -webkit-transform: translate3d(-100%, 0, 0);
        #         transform: translate3d(-100%, 0, 0);
        #     }}
        # }}
        # .ticker-wrap {{
        #     position: fixed;
        #     width: calc(100% - 2px);
        #     overflow: hidden;
        #     height: 2rem;
        #     background-color: #000000;
        #     box-sizing: border-box;
        #     /* border: 2px solid white; White border around the entire box */
        #     border-radius: 5px;  /* Optional: Add rounded corners */
        # }}
        # .ticker1 {{
        #     display: inline-block;
        #     height: 1.8rem;
        #     line-height: 1.8rem;
        #     white-space: nowrap;
        #     padding-left: 100%;
        #     box-sizing: content-box;
        #     -webkit-animation-iteration-count: infinite;
        #     animation-iteration-count: infinite;
        #     -webkit-animation-timing-function: linear;
        #     animation-timing-function: linear;
        #     -webkit-animation-name: ticker;
        #     animation-name: ticker;
        #     -webkit-animation-duration: 300s;
        #     animation-duration: 300s;
        # }}
        # .ticker2 {{
        #     display: inline-block;
        #     height: 1.8rem;
        #     line-height: 1.8rem;
        #     white-space: nowrap;
        #     padding-left: 100%;
        #     box-sizing: content-box;
        #     -webkit-animation-iteration-count: infinite;
        #     animation-iteration-count: infinite;
        #     -webkit-animation-timing-function: linear;
        #     animation-timing-function: linear;
        #     -webkit-animation-name: ticker;
        #     animation-name: ticker;
        #     -webkit-animation-duration: 40s;
        #     animation-duration: 40s;
        # }}
        # .ticker_item {{
        #     display: inline-block;
        #     padding: 0 2rem; /* Increased padding for more space between entries */
        #     font-size: 0.8rem;
        #     font-family: Helvetica;
        #     font-weight: bold;
        #     color: #FFFFFF;
        # }}
        # .ticker_item:first-child {{
        #     margin-top: 0;
        # }}
        # body {{ margin: 0; padding-bottom: 0; }}
        # h1, h2, p {{ padding: 0 5%; }}
        # </style>

        # <div class="ticker-wrap" style="bottom: 2.5rem;">  <!-- Bottom ticker -->
        #     <div class="ticker ticker1">
        # """

        # for entry in scrollable_content:
        #     html_code += f'<div class="ticker_item">{entry}</div>'

        # html_code += """
        #     </div>
        # </div>

        # <div class="ticker-wrap" style="bottom: 0;">  <!-- Top ticker -->
        #     <div class="ticker ticker2">
        # """

        # for entry in scrollable_content_2:
        #     html_code += f'<div class="ticker_item">{entry}</div>'

        # html_code += """
        #     </div>
        # </div>
        # """

        # -- START OF CURRENT INTERVAL SUMMARY --
        current_interval_file()
        forecasted_energy_file()
        total_bcq_nomination_file()
        contestable_energy_file()
        more_trading_node_file()
        more_trading_node_2nd_part_file()
        total_substation_load_final_file()
        actual_energy_file()
        wesm_exposure_file()
        current_rate_file()

        # Fetch Data
        result = view_all_data()
        result2 = view_all_data2()
        result3 = view_all_data3()
        result4 = view_all_data4()
        result5 = view_all_data5()
        result6 = view_all_data6()
        result7 = view_all_data7()
        result8 = view_all_data8()
        result9 = view_all_data9()
        result10 = view_all_data10()

        df = pd.DataFrame(result,columns=["id", "time_interval", "timestamp"])
        df2 = pd.DataFrame(result2, columns=["id", "net", "insert_time"])
        df3 = pd.DataFrame(result3, columns=["id", "total_bcq", "insert_time"])
        df4 = pd.DataFrame(result4, columns=["id", "substation_load", "insert_time"])
        df5 = pd.DataFrame(result5, columns=["id", "cc", "insert_time"])
        df6 = pd.DataFrame(result6, columns=["id", "actual_energy", "insert_time"])
        df7 = pd.DataFrame(result7, columns=["id", "wesm_exposure", "insert_time"])
        df8 = pd.DataFrame(result8, columns=["id", "final_total", "insert_time"])
        df9 = pd.DataFrame(result9, columns=["id", "rate", "insert_time"])
        df10 = pd.DataFrame(result10, columns=["id", "temp", "weather", "insert_time"])

        last_interval= df['time_interval'].iloc[-1]
        forecasted_energy = df2['net'].iloc[-1]
        total_bcq = df3['total_bcq'].iloc[-1]
        total_substation_load = df4['substation_load'].iloc[-1]
        contestable_energy = df5['cc'].iloc[-1]
        actual_energy= df6['actual_energy'].iloc[-1]
        wesm_exposure = df7['wesm_exposure'].iloc[-1]
        final_total = df8['final_total'].iloc[-1]
        current_rate = df9['rate'].iloc[-1]
        temperature = df10['temp'].iloc[-1]
        weather_condition = df10['weather'].iloc[-1]

        # Define the current date
        c = datetime.now()
        formatted_date = c.strftime("%Y-%m-%d")

        # Current Interval Aesthetics
        st.markdown("""
        <style>
        /* Styling for equal-sized boxes with minimal padding */
        .custom-box {
            /* border: 1px solid #ddd; */
            border-radius: 5px; 
            padding: 0;  
            margin: 0;
            background-color: #000000;
            height: 16vh;  
            max-width: 100%;  
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center; 
        }
                    
        .custom-box-2 {
            /* border: 1px solid #ddd; */
            border-radius: 5px; 
            padding: 0;  
            margin: 0;
            background-color: #000000;
            height: 16vh;  
            max-width: 100%;  
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center; 
        }
        
        @media (max-width: 768px) {
            .custom-box {
                justify-content: center;
                align-items: center;
                text-align: center; 
                height: 20.33vh;  
            }
        }

        @media (max-width: 480px) {
            .custom-box {
                justify-content: center;
                align-items: center;
                text-align: center; 
                height: 24.67vh;  
            }
        }

        /* Smaller font sizes with minimal padding and overflow control */
        .custom-box h4, .custom-box p {
            margin: 0;
            padding: 0;
            font-size: 0.85rem;
            font-family: Helvetica;
            font-weight: normal;
            color: #FFFFFF;
            max-height: 100%;  
            max-width: 100%;
            overflow: hidden;  
            text-overflow: ellipsis;  
            justify-content: center;
            align-items: center;
            text-align: center; 
        }
                    
        .custom-box-2 h4, .custom-box-2 p {
            margin: 0;
            padding: 0;
            font-size: 0.75rem;
            font-family: Helvetica;
            font-weight: normal;
            color: #FFFFFF;
            max-height: 100%;  
            max-width: 100%;
            overflow: hidden;  
            text-overflow: ellipsis;  
            justify-content: left;
            align-items: left;
            text-align: left; 
        }
                
        .custom-box p {
            font-size: 1.25rem;
            font-family: Helvetica;
            font-weight: bold;
            color: #FFFFFF;
            max-height: 100%;  
            max-width: 100%;
            overflow: hidden;  
            text-overflow: ellipsis;  
            justify-content: center;
            align-items: center;
            text-align: center; 
        }
        
        .custom-box-2 p {
            font-size: 0.9rem;
            font-family: Helvetica;
            font-weight: bold;
            color: #FFFFFF;
            max-height: 100%;  
            max-width: 100%;
            overflow: hidden;  
            text-overflow: ellipsis;  
            justify-content: center;
            align-items: center;
            text-align: center; 
        }
        </style>
        """, unsafe_allow_html=True)


        # Define your custom CSS
        custom_css = """
        <style>
        .container-class {
            min-height: 100%;
        }
        </style>
        """

        # Apply the custom CSS
        st.markdown(custom_css, unsafe_allow_html=True)

        with st.container():

            # Set the image's width to the column width
            st.image(image_path, use_column_width=True)

            # # Display the HTML and CSS in Streamlit
            # st.components.v1.html(html_code, height=80)

            # Create columns with small gap
            card1, card2, card3, card4, card5, card6, card7, card8, card9 = st.columns(9, gap='small')

            with card1:
                st.markdown('<div class="custom-box"><h4>Current Date</h4><p>{}</p></div>'.format(formatted_date), unsafe_allow_html=True)

            with card2:
                st.markdown('<div class="custom-box"><h4>Current Interval</h4><p>{}</p></div>'.format(last_interval), unsafe_allow_html=True)
            
            with card3:
                st.markdown('<div class="custom-box-2"><h4>Temperature</h4><p>{}°C</p><h4>Weather Condition</h4><p>{}</p></div>'.format(temperature, weather_condition), unsafe_allow_html=True)
        
            with card4:
                st.markdown('<div class="custom-box"><h4>Total Substation Load (kW)</h4><p>{}</p></div>'.format(total_substation_load), unsafe_allow_html=True)

            with card5:           
                st.markdown('<div class="custom-box-2"><h4>Actual Energy (kWh)</h4><p>{}</p><h4>Forecasted Energy (kWh)</h4><p>{}</p></div>'.format(actual_energy, forecasted_energy), unsafe_allow_html=True)
            
            with card6:
                st.markdown('<div class="custom-box-2"><h4>WESM Exposure (kWh)</h4><p>{}</p><h4>Contestable Energy (kWh)</h4><p>{}</p></div>'.format(wesm_exposure, contestable_energy), unsafe_allow_html=True)
            
            with card7:
                st.markdown('<div class="custom-box"><h4>Total BCQ Nomination (kW)</h4><p>{}</p></div>'.format(total_bcq), unsafe_allow_html=True)

            with card8:
                st.markdown('<div class="custom-box"><h4>MORE Trading Node (PhP/MWh)</h4><p>{}</p></div>'.format(final_total), unsafe_allow_html=True)

            with card9:
                st.markdown('<div class="custom-box"><h4>Current Rate (PhP/kWh)</h4><p>{}</p></div>'.format(current_rate), unsafe_allow_html=True)

        st.markdown("""
        <style>
        .small-space {
            margin-bottom: 0.1px;
        }
        </style>
        """, unsafe_allow_html=True)

        # Layout with smaller padding
        col1, col2 = st.columns([1, 1.75])   
        with col1:
            # file_path_subload_chart = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\latest_subload_chart.json"
            file_path_subload_chart = 'latest_subload_chart.json'
            # file_path_subload_chart = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\latest_subload_chart.json"
            try:
                # latest_chart_total_sub_load = sub_load_func()
                # st.plotly_chart(latest_chart_total_sub_load)
                latest_chart_total_sub_load = sub_load_func()
                st.plotly_chart(latest_chart_total_sub_load)
                save_chart(latest_chart_total_sub_load, file_path_subload_chart)
            except:
                # if latest_chart_total_sub_load:
                #     st.plotly_chart(latest_chart_total_sub_load) 
                chart_json_subload = load_chart(file_path_subload_chart)
                latest_chart_total_sub_load = pio.from_json(chart_json_subload)
                st.plotly_chart(latest_chart_total_sub_load)
        with col2:
            # file_path_avf_chart = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\latest_avf_chart.json"
            file_path_avf_chart = 'latest_avf_chart.json'
            # file_path_avf_chart = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\latest_avf_chart.json"
            try:
                # latest_chart_actual_vs_forecasted = actual_vs_forecasted()
                # st.plotly_chart(latest_chart_actual_vs_forecasted)
                latest_chart_actual_vs_forecasted = actual_vs_forecasted()
                st.plotly_chart(latest_chart_actual_vs_forecasted)
                save_chart(latest_chart_actual_vs_forecasted, file_path_avf_chart)
            except:
                # if latest_chart_actual_vs_forecasted:
                #     st.plotly_chart(latest_chart_actual_vs_forecasted)
                chart_json_avf = load_chart(file_path_avf_chart)
                latest_chart_actual_vs_forecasted = pio.from_json(chart_json_avf)
                st.plotly_chart(latest_chart_actual_vs_forecasted)

        col3, col4, col5 = st.columns([1, 1, 0.75])
        with col3:
            # file_path_bcq_chart = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\latest_bcq_chart.json"
            file_path_bcq_chart = 'latest_bcq_chart.json'
            # file_path_bcq_chart = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\latest_bcq_chart.json"
            try:
                # latest_chart_bcq = bcq_func()
                # st.plotly_chart(latest_chart_bcq)
                latest_chart_bcq = bcq_func()
                st.plotly_chart(latest_chart_bcq)
                save_chart(latest_chart_bcq, file_path_bcq_chart)
            except:
                # if latest_chart_bcq:
                #     st.plotly_chart(latest_chart_bcq)
                chart_json_bcq = load_chart(file_path_bcq_chart)
                latest_chart_bcq = pio.from_json(chart_json_bcq)
                st.plotly_chart(latest_chart_bcq)
        with col4:
            # file_path_tipc_chart = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\latest_tipc_chart.json"
            file_path_tipc_chart = 'latest_tipc_chart.json'
            # file_path_tipc_chart = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\latest_tipc_chart.json"

            # try:
            latest_chart_tipc = tipc_func()
            st.plotly_chart(latest_chart_tipc)
            save_chart(latest_chart_tipc, file_path_tipc_chart)
            # except:
            #     chart_json_tipc = load_chart(file_path_tipc_chart)
            #     latest_chart_tipc = pio.from_json(chart_json_tipc)
            #     st.plotly_chart(latest_chart_tipc)
        with col5:
            # file_path_genmix_chart = r"C:\Users\aslee\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\latest_genmix_chart.json"
            file_path_genmix_chart = 'latest_genmix_chart.json'
            # file_path_genmix_chart = r"E:\OneDrive - MORE ELECTRIC AND POWER CORPORATION\Desktop\DASHBOARD_FINAL\latest_genmix_chart.json"
            try:
                latest_chart_genmix = genmix_func()
                st.plotly_chart(latest_chart_genmix)
                save_chart(latest_chart_genmix, file_path_genmix_chart)
            except:
                chart_json_genmix = load_chart(file_path_genmix_chart)
                latest_chart_genmix = pio.from_json(chart_json_genmix)
                st.plotly_chart(latest_chart_genmix)
        
        st.markdown("""
        <style>
        .small-space {
            margin-bottom: 0.1px;
        }
        </style>
        """, unsafe_allow_html=True)
        
        authenticator.logout("Logout", "main") # Logout button

        # For rerunning the script every 900 seconds (15 minutes)
        time.sleep(REFRESH_INTERVAL)
        st.rerun()